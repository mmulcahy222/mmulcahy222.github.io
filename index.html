<!DOCTYPE html>
<!-- saved from url=(0035)http://localhost/portfolio/code.php -->
<html lang="en" foxified=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="keywords" content="Win32, C++, Rust, kernel32.dll, user32.dll, VirtualAllocEx, WriteProcessMemory">
      <meta name="author" content="Mark Mulcahy">
      <meta name="publisher" content="Mark Mulcahy">
      <meta name="copyright" content="Mark Mulcahy">
      <meta name="description" content="Mark Mulcahy&#39;s code">
      <meta name="page-topic" content="Coding">
      <meta name="page-type" content="Blogging">
      <meta name="audience" content="Everyone">
      <meta name="robots" content="index, follow">
    <title>Code (Win32, C++, Rust, kernel32.dll, user32.dll, VirtualAllocEx, WriteProcessMemory)</title>
    <style>
      
    </style>
    <link href="assets/css/prism.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/portfolio_code.css?t=22">

</head>
<body>

        <section>
            <div class="project_header">
                
                <div class="project_name">Search Windows Tree View Items</div>
                <div class="description">Search online for tree-item values in desktop windows applications, via memory chip injection using kernel32.dll &amp; VirtualAllocEx (hardest one &amp; capstone)</div>
                <div class="languages">C++</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-cpp" tabindex="0">                <code class="language-cpp"><span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Windows.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Commctrl.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;shellapi.h&gt;</span></span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"windows_gui.hpp"</span></span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">///////////////////////////</span></span>
<span class="line"><span class="token comment">//</span></span>
<span class="line"><span class="token comment">// NOTES:</span></span>
<span class="line"><span class="token comment">//</span></span>
<span class="line"><span class="token comment">//		- The following .hpp files are included in this file:</span></span>
<span class="line"><span class="token comment">//			- windows_gui.hpp</span></span>
<span class="line"><span class="token comment">//			     - windows_gui.hpp in turn calls the following .hpp file:</span></span>
<span class="line"><span class="token comment">//					- search_strategy_factory.hpp</span></span>
<span class="line"><span class="token comment">//</span></span>
<span class="line"><span class="token comment">///////////////////////////</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-using">using</span> <span class="token keyword keyword-namespace">namespace</span> std<span class="token punctuation">;</span></span>
<span class="line">HWND <span class="token function">get_hwnd_by_title_part</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> <span class="token keyword keyword-char">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">HHOOK _hook<span class="token punctuation">;</span></span>
<span class="line">HMENU menu<span class="token punctuation">;</span></span>
<span class="line">HWND hwnd_main_window<span class="token punctuation">;</span></span>
<span class="line">LRESULT __stdcall <span class="token function">MouseCallback</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> nCode<span class="token punctuation">,</span> WPARAM wParam<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span>   </span>
<span class="line">    <span class="token keyword keyword-switch">switch</span><span class="token punctuation">(</span>wParam<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-case">case</span> WM_LBUTTONUP<span class="token operator">:</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">// get the text of the tree item</span></span>
<span class="line">            DWORD pid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">            DWORD bytes_read <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">            DWORD bytes_written <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">            BOOL debug <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-int">int</span> text_buffer_size <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-char">char</span> text<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">            <span class="token comment">//get the point &amp; get the hwnd from that point</span></span>
<span class="line">            POINT pt<span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">GetCursorPos</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pt<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            HWND hwnd_clicked <span class="token operator">=</span> <span class="token function">WindowFromPoint</span><span class="token punctuation">(</span>pt<span class="token punctuation">)</span><span class="token punctuation">;</span>            </span>
<span class="line">            <span class="token keyword keyword-char">char</span> class_name<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">GetClassName</span><span class="token punctuation">(</span>hwnd_clicked<span class="token punctuation">,</span> class_name<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">//do not go any further if it's not a TreeViewList item</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>class_name<span class="token punctuation">,</span> <span class="token string">"SysTreeView32"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">            <span class="token comment">//get HTREEITEM from hwnd</span></span>
<span class="line">            <span class="token function">TreeView_GetSelection</span><span class="token punctuation">(</span>hwnd_clicked<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            HTREEITEM htreeitem_selected <span class="token operator">=</span> <span class="token punctuation">(</span>HTREEITEM<span class="token punctuation">)</span><span class="token function">SendMessage</span><span class="token punctuation">(</span>hwnd_clicked<span class="token punctuation">,</span> TVM_GETNEXTITEM<span class="token punctuation">,</span> TVGN_DROPHILITE<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">            </span>
<span class="line">            <span class="token comment">//new TVITEM to place in the remote prcess</span></span>
<span class="line">            TVITEM item<span class="token punctuation">;</span></span>
<span class="line">            item<span class="token punctuation">.</span>hItem <span class="token operator">=</span> htreeitem_selected<span class="token punctuation">;</span></span>
<span class="line">            item<span class="token punctuation">.</span>mask <span class="token operator">=</span> TVIF_TEXT <span class="token operator">|</span> TVIF_HANDLE<span class="token punctuation">;</span></span>
<span class="line">            item<span class="token punctuation">.</span>pszText <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> TCHAR<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">            item<span class="token punctuation">.</span>cchTextMax <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">//open process</span></span>
<span class="line">            <span class="token function">GetWindowThreadProcessId</span><span class="token punctuation">(</span>hwnd_main_window<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pid<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            HANDLE hProcess <span class="token operator">=</span> <span class="token function">OpenProcess</span><span class="token punctuation">(</span>PROCESS_ALL_ACCESS<span class="token punctuation">,</span> FALSE<span class="token punctuation">,</span> pid<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">            <span class="token comment">//VirtualAllocEx (treeview)</span></span>
<span class="line">            <span class="token comment">//VirtualAllocEx (text)</span></span>
<span class="line">            <span class="token comment">//</span></span>
<span class="line">            <span class="token comment">// Both functions return a pointer to the allocated memory. Since it has EX at the end, it goes to another process.</span></span>
<span class="line">            LPVOID remote_item_address <span class="token operator">=</span> <span class="token function">VirtualAllocEx</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation">(</span>TVITEM<span class="token punctuation">)</span><span class="token punctuation">,</span> MEM_COMMIT<span class="token punctuation">,</span> PAGE_READWRITE<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            LPVOID remote_text_address <span class="token operator">=</span> <span class="token function">VirtualAllocEx</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> text_buffer_size<span class="token punctuation">,</span> MEM_COMMIT<span class="token punctuation">,</span> PAGE_READWRITE<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">//</span></span>
<span class="line">            <span class="token comment">//</span></span>
<span class="line">            <span class="token comment">//This following line is very important. The whole TVITEM  structure will be sent to the process. The TVITEM.psText will have the results of the the second call we made to VirtualAllocEx, which is for text. It's like a double pointer.</span></span>
<span class="line">            <span class="token comment">//</span></span>
<span class="line">            <span class="token comment">// According to https://docs.microsoft.com/en-us/windows/win32/controls/tvm-getitem</span></span>
<span class="line">            <span class="token comment">// "If the TVIF_TEXT flag is set in the mask member of the TVITEM or TVITEMEX structure, the pszText member must point to a valid buffer and the cchTextMax member must be set to the number of characters in that buffer"</span></span>
<span class="line">            item<span class="token punctuation">.</span>pszText <span class="token operator">=</span> <span class="token punctuation">(</span>LPTSTR<span class="token punctuation">)</span>remote_text_address<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">            <span class="token comment">//WriteProcessMemory    (Puts OUR local TVITEM object into the remote process)</span></span>
<span class="line">            <span class="token comment">//SendMessageA          (message is TVM_GETITEM, and fills out the TVItem structure we put in)</span></span>
<span class="line">            <span class="token comment">//GetLastError          (error checking)</span></span>
<span class="line">            <span class="token comment">//ReadProcessMemory     (gets the remote TVITEM object at remote_item_address, and puts it in local &amp;item)</span></span>
<span class="line">            <span class="token comment">//ReadProcessMemory     (gets the remote text object at remote_text_address, and puts it in local &amp;buffer)</span></span>
<span class="line">            BOOL write_process <span class="token operator">=</span> <span class="token function">WriteProcessMemory</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">,</span> remote_item_address<span class="token punctuation">,</span> <span class="token operator">&amp;</span>item<span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation">(</span>TVITEM<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>bytes_written<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            BOOL sent_message <span class="token operator">=</span> <span class="token function">SendMessageA</span><span class="token punctuation">(</span>hwnd_clicked<span class="token punctuation">,</span> TVM_GETITEM<span class="token punctuation">,</span> TVGN_CARET<span class="token punctuation">,</span> <span class="token punctuation">(</span>LPARAM<span class="token punctuation">)</span>remote_item_address<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">// get last error</span></span>
<span class="line">            DWORD last_error <span class="token operator">=</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">ReadProcessMemory</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">,</span> remote_item_address<span class="token punctuation">,</span> <span class="token operator">&amp;</span>item<span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation">(</span>TVITEM<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>bytes_read<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            CHAR buffer<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">ReadProcessMemory</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">,</span> remote_text_address<span class="token punctuation">,</span> <span class="token operator">&amp;</span>buffer<span class="token punctuation">,</span> text_buffer_size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>bytes_read<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            </span>
<span class="line">&nbsp;</span>
<span class="line">            <span class="token comment">//print out </span></span>
<span class="line">            <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>debug<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"write process: "</span> <span class="token operator">&lt;&lt;</span> write_process <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"sent message: "</span> <span class="token operator">&lt;&lt;</span> sent_message <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"last error: "</span> <span class="token operator">&lt;&lt;</span> last_error <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"bytes_written: "</span> <span class="token operator">&lt;&lt;</span> bytes_written <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"bytes_read: "</span> <span class="token operator">&lt;&lt;</span> bytes_read <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Text: "</span> <span class="token operator">&lt;&lt;</span> text <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Buffer: "</span> <span class="token operator">&lt;&lt;</span> buffer <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">                cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">           </span>
<span class="line">            <span class="token comment">//free memory </span></span>
<span class="line">            <span class="token function">VirtualFreeEx</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">,</span> remote_item_address<span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation">(</span>TVITEM<span class="token punctuation">)</span><span class="token punctuation">,</span> MEM_RELEASE<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">VirtualFreeEx</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">,</span> remote_text_address<span class="token punctuation">,</span> text_buffer_size<span class="token punctuation">,</span> MEM_RELEASE<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">            <span class="token comment">//search</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">            <span class="token comment">//search instance is defined in </span></span>
<span class="line">            search_instance<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            </span>
<span class="line">&nbsp;</span>
<span class="line">            <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-case">case</span> WM_COMMAND<span class="token operator">:</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Command"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-case">case</span> WM_INITMENUPOPUP<span class="token operator">:</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Goon"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token function">CallNextHookEx</span><span class="token punctuation">(</span>_hook<span class="token punctuation">,</span> nCode<span class="token punctuation">,</span> wParam<span class="token punctuation">,</span> lParam<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">HWND <span class="token function">get_hwnd_by_title_part</span><span class="token punctuation">(</span><span class="token keyword keyword-const">const</span> <span class="token keyword keyword-char">char</span><span class="token operator">*</span> title_part<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    HWND hwnd <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span>hwnd <span class="token operator">=</span> <span class="token function">FindWindowEx</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> hwnd<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-char">char</span> title<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">GetWindowText</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> title<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> title_part<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> hwnd<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword keyword-int">int</span> WINAPI <span class="token function">WinMain</span><span class="token punctuation">(</span> HINSTANCE hInstance<span class="token punctuation">,</span> HINSTANCE hPrevInstance<span class="token punctuation">,</span> LPSTR lpCmdLine<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> nCmdShow <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// get the hwnd of the main_window window</span></span>
<span class="line">    hwnd_main_window <span class="token operator">=</span> <span class="token function">get_hwnd_by_title_part</span><span class="token punctuation">(</span><span class="token string">"Explorer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"hwnd_main_window: "</span> <span class="token operator">&lt;&lt;</span> hwnd_main_window <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// set the hook for left mouse clicks</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>_hook <span class="token operator">=</span> <span class="token function">SetWindowsHookEx</span><span class="token punctuation">(</span>WH_MOUSE_LL<span class="token punctuation">,</span> MouseCallback<span class="token punctuation">,</span> hInstance<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"Failed to install hook!"</span><span class="token punctuation">,</span> <span class="token string">"Error"</span><span class="token punctuation">,</span> MB_ICONERROR<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token comment">// create the window to search in different pages (windows_gui.hpp)</span></span>
<span class="line">    HWND hwnd_search_window <span class="token operator">=</span> <span class="token function">create_basic_window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token comment">// getdlgitem at 5 (the text box that is not the buttons). The reason it is 5 is because it corresponds to the index of the text box in the windows_gui.hpp file when it is created by the CreateWindow function.</span></span>
<span class="line">    HWND hwnd_search_text <span class="token operator">=</span> <span class="token function">GetDlgItem</span><span class="token punctuation">(</span>hwnd_search_window<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-char">char</span> hwnd_main_window_hex<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">sprintf</span><span class="token punctuation">(</span>hwnd_main_window_hex<span class="token punctuation">,</span> <span class="token string">"Window found in: 0x%x"</span><span class="token punctuation">,</span> hwnd_main_window<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">SetWindowText</span><span class="token punctuation">(</span>hwnd_search_text<span class="token punctuation">,</span> hwnd_main_window_hex<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token function">ShowWindow</span><span class="token punctuation">(</span>hwnd_search_window<span class="token punctuation">,</span> SW_SHOW<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">UpdateWindow</span><span class="token punctuation">(</span>hwnd_search_window<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    MSG msg<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token function">GetMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>msg<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">TranslateMessage</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>msg <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">DispatchMessage</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>msg <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Search Windows Tree View Items</div>
                <div class="description">Strategy Design Pattern to search different sites based on the user choice with BS_PUSHLIKE on CreateWindow function in user32.dll &amp; gdi32.dll (Raw MSDN, no framework)</div>
                <div class="languages">C++</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-cpp" tabindex="0">                <code class="language-cpp"><span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Windows.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Commctrl.h&gt;</span></span></span>
<span class="line"><span class="token keyword keyword-using">using</span> <span class="token keyword keyword-namespace">namespace</span> std<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"search_strategy_factory.hpp"</span></span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">//search instance to be used for the radio push buttons in the window</span></span>
<span class="line">Search search_instance <span class="token operator">=</span> <span class="token function">Search</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">LRESULT APIENTRY <span class="token function">WindowProcedure</span><span class="token punctuation">(</span>HWND <span class="token punctuation">,</span> UINT <span class="token punctuation">,</span> WPARAM <span class="token punctuation">,</span> LPARAM <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">HWND <span class="token function">create_basic_window</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> window_width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> window_height <span class="token operator">=</span> <span class="token number">250</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    WNDCLASSEX wc<span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>cbSize <span class="token operator">=</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation">(</span>WNDCLASSEX<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>lpfnWndProc <span class="token operator">=</span> WindowProcedure<span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>cbClsExtra <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>cbWndExtra <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hInstance <span class="token operator">=</span> <span class="token function">GetModuleHandle</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hIcon <span class="token operator">=</span> <span class="token function">LoadIcon</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> IDI_APPLICATION<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hCursor <span class="token operator">=</span> <span class="token function">LoadCursor</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> IDC_ARROW<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hbrBackground <span class="token operator">=</span> <span class="token punctuation">(</span>HBRUSH<span class="token punctuation">)</span><span class="token function">CreateSolidBrush</span><span class="token punctuation">(</span><span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">191</span><span class="token punctuation">,</span><span class="token number">184</span><span class="token punctuation">,</span><span class="token number">191</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>lpszMenuName <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>lpszClassName <span class="token operator">=</span> <span class="token string">"WindowClass"</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hIconSm <span class="token operator">=</span> <span class="token function">LoadIcon</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> IDI_APPLICATION<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">RegisterClassEx</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>wc<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"Window Registration Failed!"</span><span class="token punctuation">,</span> <span class="token string">"Error!"</span><span class="token punctuation">,</span></span>
<span class="line">                   MB_ICONEXCLAMATION <span class="token operator">|</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    HWND hwnd <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span>WS_EX_CLIENTEDGE<span class="token punctuation">,</span> <span class="token string">"WindowClass"</span><span class="token punctuation">,</span> <span class="token string">"Search Tree View"</span><span class="token punctuation">,</span></span>
<span class="line">                               WS_OVERLAPPEDWINDOW<span class="token punctuation">,</span> CW_USEDEFAULT<span class="token punctuation">,</span> CW_USEDEFAULT<span class="token punctuation">,</span> window_width<span class="token punctuation">,</span> window_height<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token function">GetModuleHandle</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>hwnd <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"Window Creation Failed!"</span><span class="token punctuation">,</span> <span class="token string">"Error!"</span><span class="token punctuation">,</span></span>
<span class="line">                   MB_ICONEXCLAMATION <span class="token operator">|</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> hwnd<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">LRESULT APIENTRY <span class="token function">WindowProcedure</span><span class="token punctuation">(</span>HWND hwnd<span class="token punctuation">,</span> UINT message<span class="token punctuation">,</span> WPARAM wParam<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-switch">switch</span> <span class="token punctuation">(</span>message<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-case">case</span> WM_COMMAND<span class="token operator">:</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">LOWORD</span><span class="token punctuation">(</span>wParam<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                search_instance<span class="token punctuation">.</span><span class="token function">setStrategy</span><span class="token punctuation">(</span><span class="token string">"youtube"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">LOWORD</span><span class="token punctuation">(</span>wParam<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                search_instance<span class="token punctuation">.</span><span class="token function">setStrategy</span><span class="token punctuation">(</span><span class="token string">"spotify"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">LOWORD</span><span class="token punctuation">(</span>wParam<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                search_instance<span class="token punctuation">.</span><span class="token function">setStrategy</span><span class="token punctuation">(</span><span class="token string">"discogs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">LOWORD</span><span class="token punctuation">(</span>wParam<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                search_instance<span class="token punctuation">.</span><span class="token function">setStrategy</span><span class="token punctuation">(</span><span class="token string">"google"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-case">case</span> WM_CREATE<span class="token operator">:</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-int">int</span> window_width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-int">int</span> window_height <span class="token operator">=</span> <span class="token number">250</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">            <span class="token comment">//create two buttons in this window with padding of 10 pixels on every side</span></span>
<span class="line">            <span class="token keyword keyword-short">short</span> <span class="token keyword keyword-int">int</span> top_padding <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-short">short</span> <span class="token keyword keyword-int">int</span> left_padding <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-short">short</span> <span class="token keyword keyword-int">int</span> right_padding <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-short">short</span> <span class="token keyword keyword-int">int</span> bottom_padding <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-short">short</span> <span class="token keyword keyword-int">int</span> button_bottom_margin <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">// I don't know why I needed to put -20 for the width, because it should have worked without it. </span></span>
<span class="line">            <span class="token keyword keyword-short">short</span> <span class="token keyword keyword-int">int</span> button_width <span class="token operator">=</span> <span class="token punctuation">(</span>window_width <span class="token operator">-</span> <span class="token punctuation">(</span>left_padding <span class="token operator">+</span> right_padding<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-short">short</span> <span class="token keyword keyword-int">int</span> button_height <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">            <span class="token comment">//Create three buttons and attach them to the window. They will show up as RADIO BUTTONS in the menu. The BS_PUSHLIKE style is used to make the radio buttons look like push buttons.</span></span>
<span class="line">            HWND button1 <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"BUTTON"</span><span class="token punctuation">,</span> <span class="token string">"YouTube"</span><span class="token punctuation">,</span> WS_VISIBLE <span class="token operator">|</span> WS_CHILD <span class="token operator">|</span> BS_AUTORADIOBUTTON <span class="token operator">|</span> BS_PUSHLIKE<span class="token punctuation">,</span> left_padding<span class="token punctuation">,</span> top_padding<span class="token punctuation">,</span> button_width<span class="token punctuation">,</span> button_height<span class="token punctuation">,</span> hwnd<span class="token punctuation">,</span> <span class="token punctuation">(</span>HMENU<span class="token punctuation">)</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            HWND button2 <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"BUTTON"</span><span class="token punctuation">,</span> <span class="token string">"Spotify"</span><span class="token punctuation">,</span> WS_VISIBLE <span class="token operator">|</span> WS_CHILD <span class="token operator">|</span> BS_AUTORADIOBUTTON <span class="token operator">|</span> BS_PUSHLIKE<span class="token punctuation">,</span> left_padding<span class="token punctuation">,</span> top_padding <span class="token operator">+</span> button_height <span class="token operator">+</span> button_bottom_margin<span class="token punctuation">,</span> button_width<span class="token punctuation">,</span> button_height<span class="token punctuation">,</span> hwnd<span class="token punctuation">,</span> <span class="token punctuation">(</span>HMENU<span class="token punctuation">)</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            HWND button3 <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"BUTTON"</span><span class="token punctuation">,</span> <span class="token string">"Discogs"</span><span class="token punctuation">,</span> WS_VISIBLE <span class="token operator">|</span> WS_CHILD <span class="token operator">|</span> BS_AUTORADIOBUTTON <span class="token operator">|</span> BS_PUSHLIKE<span class="token punctuation">,</span> left_padding<span class="token punctuation">,</span> top_padding <span class="token operator">+</span> <span class="token punctuation">(</span>button_height <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>button_bottom_margin <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> button_width<span class="token punctuation">,</span> button_height<span class="token punctuation">,</span> hwnd<span class="token punctuation">,</span> <span class="token punctuation">(</span>HMENU<span class="token punctuation">)</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            HWND button4 <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"BUTTON"</span><span class="token punctuation">,</span> <span class="token string">"Google"</span><span class="token punctuation">,</span> WS_VISIBLE <span class="token operator">|</span> WS_CHILD <span class="token operator">|</span> BS_AUTORADIOBUTTON <span class="token operator">|</span> BS_PUSHLIKE<span class="token punctuation">,</span> left_padding<span class="token punctuation">,</span> top_padding <span class="token operator">+</span> <span class="token punctuation">(</span>button_height <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>button_bottom_margin <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> button_width<span class="token punctuation">,</span> button_height<span class="token punctuation">,</span> hwnd<span class="token punctuation">,</span> <span class="token punctuation">(</span>HMENU<span class="token punctuation">)</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">            <span class="token comment">//Run the code that would usually happen when clicking the button. The 1 corresponds to the first button when the radio buttons are created.</span></span>
<span class="line">            <span class="token function">SendMessage</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> WM_COMMAND<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">//Make button 1 the default selection (pushed down)</span></span>
<span class="line">            <span class="token function">SendMessage</span><span class="token punctuation">(</span>button1<span class="token punctuation">,</span> BM_SETCHECK<span class="token punctuation">,</span> BST_CHECKED<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">            <span class="token comment">//put some text 25 pixels below button4 with background color of RGB(191,184,191)</span></span>
<span class="line">            <span class="token comment">//background color is determined by the case in the switch statement in the WindowProcedure function below for the case called WM_CTLCOLORSTATIC</span></span>
<span class="line">            <span class="token comment">//the (+5) is to make the text appear below the button</span></span>
<span class="line">            HWND text_box <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"STATIC"</span><span class="token punctuation">,</span> <span class="token string">"Goon"</span><span class="token punctuation">,</span> WS_VISIBLE <span class="token operator">|</span> WS_CHILD <span class="token operator">|</span> SS_LEFT <span class="token operator">|</span> SS_CENTER<span class="token punctuation">,</span> left_padding<span class="token punctuation">,</span> top_padding <span class="token operator">+</span> <span class="token punctuation">(</span>button_height <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>button_bottom_margin <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">,</span> button_width<span class="token punctuation">,</span> button_height<span class="token punctuation">,</span> hwnd<span class="token punctuation">,</span> <span class="token punctuation">(</span>HMENU<span class="token punctuation">)</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">            <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token comment">//Sole reason is to make the background color of Text Label with the same background as the rest of the window</span></span>
<span class="line">        <span class="token keyword keyword-case">case</span> WM_CTLCOLORSTATIC<span class="token operator">:</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            HDC hdcStatic <span class="token operator">=</span> <span class="token punctuation">(</span>HDC<span class="token punctuation">)</span>wParam<span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">SetTextColor</span><span class="token punctuation">(</span>hdcStatic<span class="token punctuation">,</span> <span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">SetBkColor</span><span class="token punctuation">(</span>hdcStatic<span class="token punctuation">,</span> <span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">184</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">//create brush</span></span>
<span class="line">            HBRUSH hBrush <span class="token operator">=</span> <span class="token function">CreateSolidBrush</span><span class="token punctuation">(</span><span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">184</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span>LRESULT<span class="token punctuation">)</span>hBrush<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span>         </span>
<span class="line">        <span class="token keyword keyword-case">case</span> WM_DESTROY<span class="token operator">:</span></span>
<span class="line">            <span class="token function">PostQuitMessage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-default">default</span><span class="token operator">:</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token function">DefWindowProc</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> message<span class="token punctuation">,</span> wParam<span class="token punctuation">,</span> lParam<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Search Windows Tree View Items</div>
                <div class="description">Generate the GUI for the user to choose the site, without any high-level easy abstracted framework (done in RAW C++ Win32 MSDN)</div>
                <div class="languages">C++</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-cpp" tabindex="0">                <code class="language-cpp"><span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Windows.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Commctrl.h&gt;</span></span></span>
<span class="line"><span class="token keyword keyword-using">using</span> <span class="token keyword keyword-namespace">namespace</span> std<span class="token punctuation">;</span></span>
<span class="line">HHOOK _hook<span class="token punctuation">;</span></span>
<span class="line">HMENU menu<span class="token punctuation">;</span></span>
<span class="line">LRESULT APIENTRY <span class="token function">WindowProcedure</span><span class="token punctuation">(</span>HWND <span class="token punctuation">,</span> UINT <span class="token punctuation">,</span> WPARAM <span class="token punctuation">,</span> LPARAM <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">HWND <span class="token function">create_basic_window</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    WNDCLASSEX wc<span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>cbSize <span class="token operator">=</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation">(</span>WNDCLASSEX<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>lpfnWndProc <span class="token operator">=</span> WindowProcedure<span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>cbClsExtra <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>cbWndExtra <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hInstance <span class="token operator">=</span> <span class="token function">GetModuleHandle</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hIcon <span class="token operator">=</span> <span class="token function">LoadIcon</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> IDI_APPLICATION<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hCursor <span class="token operator">=</span> <span class="token function">LoadCursor</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> IDC_ARROW<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hbrBackground <span class="token operator">=</span> <span class="token punctuation">(</span>HBRUSH<span class="token punctuation">)</span><span class="token function">CreateSolidBrush</span><span class="token punctuation">(</span><span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">191</span><span class="token punctuation">,</span><span class="token number">184</span><span class="token punctuation">,</span><span class="token number">191</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>lpszMenuName <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>lpszClassName <span class="token operator">=</span> <span class="token string">"WindowClass"</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hIconSm <span class="token operator">=</span> <span class="token function">LoadIcon</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> IDI_APPLICATION<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">RegisterClassEx</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>wc<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"Window Registration Failed!"</span><span class="token punctuation">,</span> <span class="token string">"Error!"</span><span class="token punctuation">,</span></span>
<span class="line">                   MB_ICONEXCLAMATION <span class="token operator">|</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    HWND hwnd <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span>WS_EX_CLIENTEDGE<span class="token punctuation">,</span> <span class="token string">"WindowClass"</span><span class="token punctuation">,</span> <span class="token string">"Search Tree View"</span><span class="token punctuation">,</span></span>
<span class="line">                               WS_OVERLAPPEDWINDOW<span class="token punctuation">,</span> CW_USEDEFAULT<span class="token punctuation">,</span> CW_USEDEFAULT<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token function">GetModuleHandle</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>hwnd <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"Window Creation Failed!"</span><span class="token punctuation">,</span> <span class="token string">"Error!"</span><span class="token punctuation">,</span></span>
<span class="line">                   MB_ICONEXCLAMATION <span class="token operator">|</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> hwnd<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">LRESULT APIENTRY <span class="token function">WindowProcedure</span><span class="token punctuation">(</span>HWND hwnd<span class="token punctuation">,</span> UINT message<span class="token punctuation">,</span> WPARAM wParam<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-switch">switch</span> <span class="token punctuation">(</span>message<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">//add clickable buttons to this hwnd</span></span>
<span class="line">        <span class="token keyword keyword-case">case</span> WM_CREATE<span class="token operator">:</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-case">case</span> WM_COMMAND<span class="token operator">:</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">LOWORD</span><span class="token punctuation">(</span>wParam<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                <span class="token comment">// MessageBox(hwnd, "Open", "Menu", MB_OK);</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-case">case</span> WM_DESTROY<span class="token operator">:</span></span>
<span class="line">            <span class="token function">PostQuitMessage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-default">default</span><span class="token operator">:</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token function">DefWindowProc</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> message<span class="token punctuation">,</span> wParam<span class="token punctuation">,</span> lParam<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-int">int</span> WINAPI <span class="token function">WinMain</span><span class="token punctuation">(</span>HINSTANCE hInstance<span class="token punctuation">,</span> HINSTANCE hPrevInstance<span class="token punctuation">,</span> LPSTR lpCmdLine<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> nCmdShow<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    HWND hwnd <span class="token operator">=</span> <span class="token function">create_basic_window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">//create two buttons in this window with padding of 10 pixels on every side</span></span>
<span class="line">    RECT rect<span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">GetClientRect</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rect<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> window_length <span class="token operator">=</span> rect<span class="token punctuation">.</span>right<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> window_height <span class="token operator">=</span> rect<span class="token punctuation">.</span>bottom<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-short">short</span> <span class="token keyword keyword-int">int</span> top_padding <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-short">short</span> <span class="token keyword keyword-int">int</span> left_padding <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-short">short</span> <span class="token keyword keyword-int">int</span> right_padding <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-short">short</span> <span class="token keyword keyword-int">int</span> bottom_padding <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-short">short</span> <span class="token keyword keyword-int">int</span> button_bottom_margin <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-short">short</span> <span class="token keyword keyword-int">int</span> button_width <span class="token operator">=</span> <span class="token punctuation">(</span>window_length <span class="token operator">-</span> <span class="token punctuation">(</span>left_padding <span class="token operator">+</span> right_padding<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-short">short</span> <span class="token keyword keyword-int">int</span> button_height <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token comment">//Create three buttons and attach them to the window. They will show up as RADIO BUTTONS in the menu. The BS_PUSHLIKE style is used to make the radio buttons look like push buttons.</span></span>
<span class="line">    HWND button1 <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"BUTTON"</span><span class="token punctuation">,</span> <span class="token string">"Button 1"</span><span class="token punctuation">,</span> WS_VISIBLE <span class="token operator">|</span> WS_CHILD <span class="token operator">|</span> BS_AUTORADIOBUTTON <span class="token operator">|</span> BS_PUSHLIKE <span class="token punctuation">,</span> left_padding<span class="token punctuation">,</span> top_padding<span class="token punctuation">,</span> button_width<span class="token punctuation">,</span> button_height<span class="token punctuation">,</span> hwnd<span class="token punctuation">,</span> <span class="token punctuation">(</span>HMENU<span class="token punctuation">)</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    HWND button2 <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"BUTTON"</span><span class="token punctuation">,</span> <span class="token string">"Button 2"</span><span class="token punctuation">,</span> WS_VISIBLE <span class="token operator">|</span> WS_CHILD <span class="token operator">|</span> BS_AUTORADIOBUTTON <span class="token operator">|</span> BS_PUSHLIKE <span class="token punctuation">,</span> left_padding<span class="token punctuation">,</span> top_padding <span class="token operator">+</span> button_height <span class="token operator">+</span> button_bottom_margin<span class="token punctuation">,</span> button_width<span class="token punctuation">,</span> button_height<span class="token punctuation">,</span> hwnd<span class="token punctuation">,</span> <span class="token punctuation">(</span>HMENU<span class="token punctuation">)</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    HWND button3 <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"BUTTON"</span><span class="token punctuation">,</span> <span class="token string">"Button 3"</span><span class="token punctuation">,</span> WS_VISIBLE <span class="token operator">|</span> WS_CHILD <span class="token operator">|</span> BS_AUTORADIOBUTTON <span class="token operator">|</span> BS_PUSHLIKE<span class="token punctuation">,</span> left_padding<span class="token punctuation">,</span> top_padding <span class="token operator">+</span> <span class="token punctuation">(</span>button_height <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>button_bottom_margin <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> button_width<span class="token punctuation">,</span> button_height<span class="token punctuation">,</span> hwnd<span class="token punctuation">,</span> <span class="token punctuation">(</span>HMENU<span class="token punctuation">)</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//Make button 2 the default selection   </span></span>
<span class="line">    HWND button4 <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"BUTTON"</span><span class="token punctuation">,</span> <span class="token string">"Button 4"</span><span class="token punctuation">,</span> WS_VISIBLE <span class="token operator">|</span> WS_CHILD <span class="token operator">|</span> BS_AUTORADIOBUTTON <span class="token operator">|</span> BS_PUSHLIKE<span class="token punctuation">,</span> left_padding<span class="token punctuation">,</span> top_padding <span class="token operator">+</span> <span class="token punctuation">(</span>button_height <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>button_bottom_margin <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> button_width<span class="token punctuation">,</span> button_height<span class="token punctuation">,</span> hwnd<span class="token punctuation">,</span> <span class="token punctuation">(</span>HMENU<span class="token punctuation">)</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">SendMessage</span><span class="token punctuation">(</span>button2<span class="token punctuation">,</span> BM_SETCHECK<span class="token punctuation">,</span> BST_CHECKED<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token function">ShowWindow</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> SW_SHOW<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">UpdateWindow</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    MSG msg<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token function">GetMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>msg<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">TranslateMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">DispatchMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Linux Mouse Button Remapping (near kernel evdev event driver)</div>
                <div class="description">Linux remapping of mouse buttons right above Linux Kernel level directly altering "evdev kernel event driver" before user-level linux "libinput"</div>
                <div class="languages">Python</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-python" tabindex="0">                <code class="language-python"><span class="line"><span class="token comment">###########################</span></span>
<span class="line"><span class="token comment">##</span></span>
<span class="line"><span class="token comment">##    Imports</span></span>
<span class="line"><span class="token comment">##</span></span>
<span class="line"><span class="token comment">###########################</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-from">from</span> Xlib <span class="token keyword keyword-import">import</span> X<span class="token punctuation">,</span> display</span>
<span class="line"><span class="token keyword keyword-import">import</span> time<span class="token punctuation">,</span> evdev</span>
<span class="line"><span class="token keyword keyword-from">from</span> evdev <span class="token keyword keyword-import">import</span> UInput<span class="token punctuation">,</span> ecodes</span>
<span class="line"><span class="token keyword keyword-import">import</span> os</span>
<span class="line"><span class="token keyword keyword-import">import</span> ctypes</span>
<span class="line"><span class="token keyword keyword-import">import</span> ctypes<span class="token punctuation">.</span>util</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">###########################</span></span>
<span class="line"><span class="token comment">##</span></span>
<span class="line"><span class="token comment">##    Get Kernel Device Representation and Simulate Clicks</span></span>
<span class="line"><span class="token comment">##</span></span>
<span class="line"><span class="token comment">###########################</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">mouse_name <span class="token operator">=</span> <span class="token string">"USB OPTICAL MOUSE "</span></span>
<span class="line">device <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line"><span class="token keyword keyword-for">for</span> input_device <span class="token keyword keyword-in">in</span> <span class="token punctuation">[</span>evdev<span class="token punctuation">.</span>InputDevice<span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token keyword keyword-for">for</span> path <span class="token keyword keyword-in">in</span> evdev<span class="token punctuation">.</span>list_devices<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="line">	<span class="token comment"># print(input_device.name, mouse_name)</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span> input_device<span class="token punctuation">.</span>name <span class="token operator">==</span> mouse_name<span class="token punctuation">:</span></span>
<span class="line">		device <span class="token operator">=</span> input_device</span>
<span class="line">		<span class="token keyword keyword-break">break</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-if">if</span> device <span class="token keyword keyword-is">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">	<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Device with name </span><span class="token interpolation"><span class="token punctuation">{</span>mouse_name<span class="token punctuation">}</span></span><span class="token string"> not found."</span></span><span class="token punctuation">)</span></span>
<span class="line">	exit<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># Create a virtual input device</span></span>
<span class="line">ui <span class="token operator">=</span> UInput<span class="token punctuation">.</span>from_device<span class="token punctuation">(</span>device<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">click</span></span><span class="token punctuation">(</span>button<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">	ui<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ecodes<span class="token punctuation">.</span>EV_KEY<span class="token punctuation">,</span> button<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">	ui<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ecodes<span class="token punctuation">.</span>EV_SYN<span class="token punctuation">,</span> ecodes<span class="token punctuation">.</span>SYN_REPORT<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">	ui<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ecodes<span class="token punctuation">.</span>EV_KEY<span class="token punctuation">,</span> button<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> </span>
<span class="line">	ui<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ecodes<span class="token punctuation">.</span>EV_SYN<span class="token punctuation">,</span> ecodes<span class="token punctuation">.</span>SYN_REPORT<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">press</span></span><span class="token punctuation">(</span>button<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">	ui<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ecodes<span class="token punctuation">.</span>EV_KEY<span class="token punctuation">,</span> button<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">	ui<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ecodes<span class="token punctuation">.</span>EV_SYN<span class="token punctuation">,</span> ecodes<span class="token punctuation">.</span>SYN_REPORT<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">	</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">left_click</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">	<span class="token comment"># print("Simulated Left Click")</span></span>
<span class="line">	click<span class="token punctuation">(</span>ecodes<span class="token punctuation">.</span>BTN_LEFT<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">middle_click</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">	<span class="token comment"># print("Simulated Middle Click")</span></span>
<span class="line">	click<span class="token punctuation">(</span>ecodes<span class="token punctuation">.</span>BTN_MIDDLE<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">right_click</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">	<span class="token comment"># print("Simulated Right Click")</span></span>
<span class="line">	click<span class="token punctuation">(</span>ecodes<span class="token punctuation">.</span>BTN_RIGHT<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">left_press</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">	<span class="token comment"># print("Simulated Left Press")</span></span>
<span class="line">	press<span class="token punctuation">(</span>ecodes<span class="token punctuation">.</span>BTN_LEFT<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">middle_press</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">	<span class="token comment"># print("Simulated Left Press")</span></span>
<span class="line">	press<span class="token punctuation">(</span>ecodes<span class="token punctuation">.</span>BTN_MIDDLE<span class="token punctuation">)</span></span>
<span class="line">	</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">###########################</span></span>
<span class="line"><span class="token comment">##</span></span>
<span class="line"><span class="token comment">##    disable wheel of mouse</span></span>
<span class="line"><span class="token comment">##</span></span>
<span class="line"><span class="token comment">##########################</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">#########</span></span>
<span class="line"><span class="token comment"># get the device path of the mouse</span></span>
<span class="line"><span class="token comment">#########</span></span>
<span class="line">mouse_name <span class="token operator">=</span> <span class="token string">"USB OPTICAL MOUSE "</span></span>
<span class="line">device <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line"><span class="token keyword keyword-for">for</span> input_device <span class="token keyword keyword-in">in</span> <span class="token punctuation">[</span>evdev<span class="token punctuation">.</span>InputDevice<span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token keyword keyword-for">for</span> path <span class="token keyword keyword-in">in</span> evdev<span class="token punctuation">.</span>list_devices<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span> input_device<span class="token punctuation">.</span>name <span class="token operator">==</span> mouse_name<span class="token punctuation">:</span></span>
<span class="line">		device <span class="token operator">=</span> input_device</span>
<span class="line">		<span class="token keyword keyword-break">break</span></span>
<span class="line"><span class="token keyword keyword-if">if</span> device <span class="token keyword keyword-is">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">	<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Device with name </span><span class="token interpolation"><span class="token punctuation">{</span>mouse_name<span class="token punctuation">}</span></span><span class="token string"> not found."</span></span><span class="token punctuation">)</span></span>
<span class="line">	exit<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># Create a virtual input device</span></span>
<span class="line">ui <span class="token operator">=</span> UInput<span class="token punctuation">.</span>from_device<span class="token punctuation">(</span>device<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">speed_factor <span class="token operator">=</span> <span class="token number">.96</span></span>
<span class="line">&nbsp;</span>
<span class="line">debug <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line"><span class="token keyword keyword-for">for</span> event <span class="token keyword keyword-in">in</span> device<span class="token punctuation">.</span>read_loop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span> event<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> evdev<span class="token punctuation">.</span>ecodes<span class="token punctuation">.</span>EV_REL<span class="token punctuation">:</span></span>
<span class="line">		event_code <span class="token operator">=</span> evdev<span class="token punctuation">.</span>ecodes<span class="token punctuation">.</span>REL<span class="token punctuation">[</span>event<span class="token punctuation">.</span>code<span class="token punctuation">]</span></span>
<span class="line">		event_value <span class="token operator">=</span> event<span class="token punctuation">.</span>value</span>
<span class="line">		</span>
<span class="line">		<span class="token comment"># if event_code in ['REL_X', 'REL_Y']:</span></span>
<span class="line">		<span class="token comment"># 	event.value = int(event_value * speed_factor)</span></span>
<span class="line">		<span class="token comment"># el</span></span>
<span class="line">&nbsp;</span>
<span class="line">		<span class="token keyword keyword-if">if</span> event_code <span class="token operator">==</span> <span class="token string">'REL_WHEEL_HI_RES'</span><span class="token punctuation">:</span></span>
<span class="line">			<span class="token keyword keyword-if">if</span> event_value <span class="token operator">==</span> <span class="token number">120</span><span class="token punctuation">:</span> <span class="token comment"># WHEEL UP</span></span>
<span class="line">				left_click<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">				<span class="token keyword keyword-continue">continue</span></span>
<span class="line">			<span class="token keyword keyword-elif">elif</span> event_value <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">120</span><span class="token punctuation">:</span> <span class="token comment"># WHEEL DOWN</span></span>
<span class="line">				left_press<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">				<span class="token keyword keyword-continue">continue</span></span>
<span class="line">&nbsp;</span>
<span class="line">	<span class="token comment"># Write all other events to the virtual device</span></span>
<span class="line">	<span class="token comment">#time.sleep(.01)</span></span>
<span class="line">	ui<span class="token punctuation">.</span>write_event<span class="token punctuation">(</span>event<span class="token punctuation">)</span></span>
<span class="line">	ui<span class="token punctuation">.</span>syn<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">TODO List (C++ Kernel Version)</div>
                <div class="description">TODO List with NO FRAMEWORK except for bare Win32 C++ with NO external wrappers/libraries. Pure raw masochastic C++ Win32 without MFC/QT Framework.</div>
                <div class="languages">C++</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-cpp" tabindex="0">                <code class="language-cpp"><span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Windows.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Commctrl.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream&gt;</span></span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-using">using</span> <span class="token keyword keyword-namespace">namespace</span> std<span class="token punctuation">;</span></span>
<span class="line">HHOOK _hook<span class="token punctuation">;</span></span>
<span class="line">HMENU menu<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">AgendaList</span><span class="token punctuation">;</span> <span class="token comment">// let the compiler know such a class will be defined, namely inside of AgendaItem which contains a pointer to an AgendaList</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-using">using</span> <span class="token keyword keyword-namespace">namespace</span> std<span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//AgendaList prototypeg</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-int">int</span> window_width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-int">int</span> window_height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-int">int</span> global_index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">string agenda_items_filename <span class="token operator">=</span> <span class="token string">"agenda_items.txt"</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-const">const</span> HFONT levi_windows_font <span class="token operator">=</span> <span class="token function">CreateFont</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> FW_DONTCARE<span class="token punctuation">,</span> FALSE<span class="token punctuation">,</span> FALSE<span class="token punctuation">,</span> FALSE<span class="token punctuation">,</span> DEFAULT_CHARSET<span class="token punctuation">,</span> OUT_OUTLINE_PRECIS<span class="token punctuation">,</span> CLIP_DEFAULT_PRECIS<span class="token punctuation">,</span> CLEARTYPE_QUALITY<span class="token punctuation">,</span> VARIABLE_PITCH<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"Levi Windows"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">LRESULT CALLBACK <span class="token function">WndProc</span><span class="token punctuation">(</span>HWND<span class="token punctuation">,</span> UINT<span class="token punctuation">,</span> WPARAM<span class="token punctuation">,</span> LPARAM<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">BOOL CALLBACK <span class="token function">DestroyChildCallback</span><span class="token punctuation">(</span> HWND <span class="token punctuation">,</span> LPARAM<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">//resets every single control, for the add &amp; delete operations</span></span>
<span class="line">BOOL CALLBACK <span class="token function">DestroyChildCallback</span><span class="token punctuation">(</span> HWND   hwnd<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>hwnd <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">DestroyWindow</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword keyword-return">return</span> TRUE<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">AgendaItem</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">//get a static class variable to keep track of the number of agenda items</span></span>
<span class="line"><span class="token keyword keyword-private">private</span><span class="token operator">:</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> id<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-static">static</span> <span class="token keyword keyword-int">int</span> last_id<span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    string text<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    AgendaList <span class="token operator">*</span>parent_list<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> agenda_item_margin <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> agenda_item_padding <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> agenda_item_height <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> agenda_item_x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-double">double</span> agenda_item_y <span class="token operator">=</span> id <span class="token operator">*</span> agenda_item_height<span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//I don't know why i had to do the (2 * agenda_item_padding) twice</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> agenda_item_width <span class="token operator">=</span> window_width <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> agenda_item_margin<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> agenda_item_margin<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> groupbox_x<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> groupbox_y<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> groupbox_height<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> groupbox_width<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> text_box_x<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> text_box_y<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> text_box_height<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> text_box_width<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> add_button_x<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> add_button_y<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> add_button_height<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> add_button_width<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> close_button_x<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> close_button_y<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> close_button_height<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> close_button_width<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    HWND groupbox<span class="token punctuation">;</span></span>
<span class="line">    HWND textbox<span class="token punctuation">;</span></span>
<span class="line">    HWND button_add<span class="token punctuation">;</span></span>
<span class="line">    HWND button_delete<span class="token punctuation">;</span></span>
<span class="line">    vector<span class="token operator">&lt;</span>HWND<span class="token operator">&gt;</span> agenda_item_controls<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-public">public</span><span class="token operator">:</span></span>
<span class="line">    <span class="token function">AgendaItem</span><span class="token punctuation">(</span>HWND<span class="token operator">&amp;</span> parent_hwnd<span class="token punctuation">,</span> string text_in<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-this">this</span><span class="token operator">-&gt;</span>text <span class="token operator">=</span> text_in<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-this">this</span><span class="token operator">-&gt;</span>id <span class="token operator">=</span> last_id<span class="token punctuation">;</span></span>
<span class="line">        last_id<span class="token operator">++</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">calculate_positions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">draw</span><span class="token punctuation">(</span>parent_hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">///get the userdata from a previous call of SetWindowLongPtr(parent_hwnd, GWLP_USERDATA, (LONG_PTR)this);</span></span>
<span class="line">        <span class="token comment">///that will represent the Parent Agenda List</span></span>
<span class="line">        <span class="token keyword keyword-this">this</span><span class="token operator">-&gt;</span>parent_list <span class="token operator">=</span> <span class="token punctuation">(</span>AgendaList<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">GetWindowLongPtr</span><span class="token punctuation">(</span>parent_hwnd<span class="token punctuation">,</span> GWLP_USERDATA<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-void">void</span> <span class="token function">calculate_positions</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        agenda_item_y <span class="token operator">=</span> id <span class="token operator">*</span> agenda_item_height<span class="token punctuation">;</span></span>
<span class="line">        groupbox_x <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>agenda_item_x <span class="token operator">+</span> agenda_item_margin<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        groupbox_y <span class="token operator">=</span> agenda_item_y <span class="token operator">+</span> agenda_item_margin<span class="token punctuation">;</span></span>
<span class="line">        groupbox_height <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>agenda_item_height<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        groupbox_width <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>agenda_item_width<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        text_box_x <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>agenda_item_x <span class="token operator">+</span> agenda_item_padding<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        text_box_y <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>agenda_item_y <span class="token operator">+</span> agenda_item_margin <span class="token operator">+</span> agenda_item_padding<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        text_box_height <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>agenda_item_height <span class="token operator">*</span> <span class="token number">0.33</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        text_box_width <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>agenda_item_width <span class="token operator">*</span> <span class="token number">0.6</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        add_button_x <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>agenda_item_width <span class="token operator">*</span> <span class="token number">0.75</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        add_button_y <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>agenda_item_y <span class="token operator">+</span> agenda_item_margin <span class="token operator">+</span> agenda_item_padding<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        add_button_height <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>agenda_item_height <span class="token operator">*</span> <span class="token number">0.33</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        add_button_width <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>agenda_item_width <span class="token operator">*</span> <span class="token number">0.07</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        close_button_x <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>agenda_item_width <span class="token operator">*</span> <span class="token number">0.85</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        close_button_y <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>agenda_item_y <span class="token operator">+</span> agenda_item_margin <span class="token operator">+</span> agenda_item_padding<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        close_button_height <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>agenda_item_height <span class="token operator">*</span> <span class="token number">0.33</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        close_button_width <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>agenda_item_width <span class="token operator">*</span> <span class="token number">0.07</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-void">void</span> <span class="token function">print_all_values_in_calculate_positions</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"agenda_item_x: "</span> <span class="token operator">&lt;&lt;</span> agenda_item_x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"agenda_item_y: "</span> <span class="token operator">&lt;&lt;</span> agenda_item_y <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"agenda_item_height: "</span> <span class="token operator">&lt;&lt;</span> agenda_item_height <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"agenda_item_width: "</span> <span class="token operator">&lt;&lt;</span> agenda_item_width <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"groupbox_x: "</span> <span class="token operator">&lt;&lt;</span> groupbox_x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"groupbox_y: "</span> <span class="token operator">&lt;&lt;</span> groupbox_y <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"groupbox_height: "</span> <span class="token operator">&lt;&lt;</span> groupbox_height <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"groupbox_width: "</span> <span class="token operator">&lt;&lt;</span> groupbox_width <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"text_box_x: "</span> <span class="token operator">&lt;&lt;</span> text_box_x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"text_box_y: "</span> <span class="token operator">&lt;&lt;</span> text_box_y <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"text_box_height: "</span> <span class="token operator">&lt;&lt;</span> text_box_height <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"text_box_width: "</span> <span class="token operator">&lt;&lt;</span> text_box_width <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"add_button_x: "</span> <span class="token operator">&lt;&lt;</span> add_button_x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"add_button_y: "</span> <span class="token operator">&lt;&lt;</span> add_button_y <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"add_button_height: "</span> <span class="token operator">&lt;&lt;</span> add_button_height <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"add_button_width: "</span> <span class="token operator">&lt;&lt;</span> add_button_width <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"close_button_x: "</span> <span class="token operator">&lt;&lt;</span> close_button_x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"close_button_y: "</span> <span class="token operator">&lt;&lt;</span> close_button_y <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"close_button_height: "</span> <span class="token operator">&lt;&lt;</span> close_button_height <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"close_button_width: "</span> <span class="token operator">&lt;&lt;</span> close_button_width <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"------------------------------------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-void">void</span> <span class="token function">draw</span><span class="token punctuation">(</span>HWND<span class="token operator">&amp;</span> parent_hwnd<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        </span>
<span class="line">        <span class="token function">calculate_positions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//** NOTE. For some reason, I had to have the buttons in the groupbox have a parent that is not the groupbox, but the parent of the groupbox. The buttons weren't showing up. **//</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">//define the text string to display for the groupbox</span></span>
<span class="line">        string groupbox_text <span class="token operator">=</span> <span class="token string">"Agenda Item #"</span> <span class="token operator">+</span> <span class="token function">to_string</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">//define group box with different id's so that we can identify them later</span></span>
<span class="line">        groupbox <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"BUTTON"</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token function">TEXT</span><span class="token punctuation">(</span>groupbox_text<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            WS_CHILD <span class="token operator">|</span> WS_VISIBLE <span class="token operator">|</span> BS_GROUPBOX<span class="token punctuation">,</span></span>
<span class="line">            groupbox_x<span class="token punctuation">,</span></span>
<span class="line">            groupbox_y<span class="token punctuation">,</span></span>
<span class="line">            groupbox_width<span class="token punctuation">,</span></span>
<span class="line">            groupbox_height<span class="token punctuation">,</span></span>
<span class="line">            parent_hwnd<span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">(</span>HMENU<span class="token punctuation">)</span>id<span class="token punctuation">,</span></span>
<span class="line">            <span class="token function">GetModuleHandle</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        textbox <span class="token operator">=</span> <span class="token function">CreateWindow</span><span class="token punctuation">(</span><span class="token string">"EDIT"</span><span class="token punctuation">,</span>                                                       <span class="token comment">//</span></span>
<span class="line">            text<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                                 <span class="token comment">// text</span></span>
<span class="line">            WS_CHILD <span class="token operator">|</span> WS_VISIBLE <span class="token operator">|</span> WS_BORDER <span class="token operator">|</span> ES_LEFT <span class="token operator">|</span> ES_AUTOHSCROLL <span class="token operator">|</span> WS_GROUP<span class="token punctuation">,</span> <span class="token comment">// styles</span></span>
<span class="line">            text_box_x<span class="token punctuation">,</span>                                                   <span class="token comment">// x</span></span>
<span class="line">            text_box_y<span class="token punctuation">,</span>                                                   <span class="token comment">// y</span></span>
<span class="line">            text_box_width<span class="token punctuation">,</span>                                               <span class="token comment">// width</span></span>
<span class="line">            text_box_height<span class="token punctuation">,</span>                                              <span class="token comment">// height</span></span>
<span class="line">            parent_hwnd<span class="token punctuation">,</span>                                                  <span class="token comment">// parent</span></span>
<span class="line">            <span class="token punctuation">(</span>HMENU<span class="token punctuation">)</span><span class="token number">1</span><span class="token punctuation">,</span>                                                     <span class="token comment">// menu</span></span>
<span class="line">            <span class="token constant">NULL</span><span class="token punctuation">,</span>                                                         <span class="token comment">// hInstance</span></span>
<span class="line">            <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                        <span class="token comment">// no extra parameters</span></span>
<span class="line">&nbsp;</span>
<span class="line">        button_add <span class="token operator">=</span> <span class="token function">CreateWindow</span><span class="token punctuation">(</span><span class="token string">"Button"</span><span class="token punctuation">,</span> <span class="token comment">//</span></span>
<span class="line">         <span class="token string">"+"</span><span class="token punctuation">,</span>  <span class="token comment">// text</span></span>
<span class="line">         WS_CHILD <span class="token operator">|</span> WS_VISIBLE <span class="token operator">|</span> BS_PUSHBUTTON<span class="token punctuation">,</span> <span class="token comment">// styles</span></span>
<span class="line">         add_button_x<span class="token punctuation">,</span> <span class="token comment">// x</span></span>
<span class="line">         add_button_y<span class="token punctuation">,</span> <span class="token comment">// y</span></span>
<span class="line">         add_button_width<span class="token punctuation">,</span> <span class="token comment">// width</span></span>
<span class="line">         add_button_height<span class="token punctuation">,</span> <span class="token comment">// height</span></span>
<span class="line">         parent_hwnd<span class="token punctuation">,</span> <span class="token comment">// parent</span></span>
<span class="line">         <span class="token punctuation">(</span>HMENU<span class="token punctuation">)</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// menu</span></span>
<span class="line">         <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token comment">// hInstance </span></span>
<span class="line">         <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// no extra parameters</span></span>
<span class="line">&nbsp;</span>
<span class="line">        button_delete <span class="token operator">=</span> <span class="token function">CreateWindow</span><span class="token punctuation">(</span><span class="token string">"Button"</span><span class="token punctuation">,</span> <span class="token comment">//</span></span>
<span class="line">         <span class="token string">"x"</span><span class="token punctuation">,</span>  <span class="token comment">// text</span></span>
<span class="line">         WS_CHILD <span class="token operator">|</span> WS_VISIBLE <span class="token operator">|</span> BS_PUSHBUTTON<span class="token punctuation">,</span> <span class="token comment">// styles</span></span>
<span class="line">         close_button_x<span class="token punctuation">,</span> <span class="token comment">// x</span></span>
<span class="line">         close_button_y<span class="token punctuation">,</span> <span class="token comment">// y</span></span>
<span class="line">         close_button_width<span class="token punctuation">,</span> <span class="token comment">// width</span></span>
<span class="line">         close_button_height<span class="token punctuation">,</span> <span class="token comment">// height</span></span>
<span class="line">         parent_hwnd<span class="token punctuation">,</span> <span class="token comment">// parent</span></span>
<span class="line">         <span class="token punctuation">(</span>HMENU<span class="token punctuation">)</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">// menu</span></span>
<span class="line">         <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token comment">// hInstance </span></span>
<span class="line">         <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// no extra parameters</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">//Set the UserData for the buttons with the AgendaItem of the AgendaList, via the "this" variable. If I had to do multiple variables, it was possible to put them in a struct. If you know other ways to do this, please let me know.</span></span>
<span class="line">        <span class="token comment">//I researched CreateDialogParam, but I hit an impasse</span></span>
<span class="line">        <span class="token comment">//</span></span>
<span class="line">        <span class="token comment">//in Short, this links the buttons to the AgendaItem</span></span>
<span class="line">        <span class="token function">SetWindowLongPtr</span><span class="token punctuation">(</span>textbox<span class="token punctuation">,</span> GWLP_USERDATA<span class="token punctuation">,</span> <span class="token punctuation">(</span>LONG_PTR<span class="token punctuation">)</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">SetWindowLongPtr</span><span class="token punctuation">(</span>button_add<span class="token punctuation">,</span> GWLP_USERDATA<span class="token punctuation">,</span> <span class="token punctuation">(</span>LONG_PTR<span class="token punctuation">)</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">SetWindowLongPtr</span><span class="token punctuation">(</span>button_delete<span class="token punctuation">,</span> GWLP_USERDATA<span class="token punctuation">,</span> <span class="token punctuation">(</span>LONG_PTR<span class="token punctuation">)</span><span class="token keyword keyword-this">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">//every button uses the font in the variable "font"</span></span>
<span class="line">        <span class="token function">SendMessage</span><span class="token punctuation">(</span>groupbox<span class="token punctuation">,</span> WM_SETFONT<span class="token punctuation">,</span> <span class="token punctuation">(</span>WPARAM<span class="token punctuation">)</span>levi_windows_font<span class="token punctuation">,</span> TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">SendMessage</span><span class="token punctuation">(</span>textbox<span class="token punctuation">,</span> WM_SETFONT<span class="token punctuation">,</span> <span class="token punctuation">(</span>WPARAM<span class="token punctuation">)</span>levi_windows_font<span class="token punctuation">,</span> TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">SendMessage</span><span class="token punctuation">(</span>button_add<span class="token punctuation">,</span> WM_SETFONT<span class="token punctuation">,</span> <span class="token punctuation">(</span>WPARAM<span class="token punctuation">)</span>levi_windows_font<span class="token punctuation">,</span> TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">SendMessage</span><span class="token punctuation">(</span>button_delete<span class="token punctuation">,</span> WM_SETFONT<span class="token punctuation">,</span> <span class="token punctuation">(</span>WPARAM<span class="token punctuation">)</span></span>
<span class="line">        levi_windows_font<span class="token punctuation">,</span> TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">//fill the vector with the buttons</span></span>
<span class="line">        agenda_item_controls<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>groupbox<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        agenda_item_controls<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>textbox<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        agenda_item_controls<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>button_add<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        agenda_item_controls<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>button_delete<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> <span class="token function">get_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> id<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    string <span class="token function">get_text</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> text<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-void">void</span> <span class="token function">set_id</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> new_id<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        id <span class="token operator">=</span> new_id<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    HWND <span class="token function">get_textbox</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> textbox<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-void">void</span> <span class="token function">set_text</span><span class="token punctuation">(</span>string text_in<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        text <span class="token operator">=</span> text_in<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    vector<span class="token operator">&lt;</span>HWND<span class="token operator">&gt;</span> <span class="token function">get_agenda_item_controls</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> agenda_item_controls<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">//get a static class variable to keep track of the number of agenda items</span></span>
<span class="line"><span class="token keyword keyword-int">int</span> AgendaItem<span class="token double-colon punctuation">::</span>last_id <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">AgendaList</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line"><span class="token keyword keyword-private">private</span><span class="token operator">:</span></span>
<span class="line">    HWND parent_hwnd<span class="token punctuation">;</span></span>
<span class="line">    vector<span class="token operator">&lt;</span>AgendaItem<span class="token operator">*</span><span class="token operator">&gt;</span> agenda_items<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-public">public</span><span class="token operator">:</span></span>
<span class="line">    <span class="token function">AgendaList</span><span class="token punctuation">(</span>HWND<span class="token operator">&amp;</span> parent_hwnd<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"AgendaList this: "</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword keyword-this">this</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//set userdata to this window</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"this: "</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword keyword-this">this</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-this">this</span><span class="token operator">-&gt;</span>parent_hwnd <span class="token operator">=</span> parent_hwnd<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">//mainly done in initial creation</span></span>
<span class="line">    AgendaItem<span class="token operator">*</span> <span class="token function">create_agenda_item</span><span class="token punctuation">(</span>HWND <span class="token operator">&amp;</span>parent_hwnd<span class="token punctuation">,</span> string text_in<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        AgendaItem<span class="token operator">*</span> item <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token function">AgendaItem</span><span class="token punctuation">(</span>parent_hwnd<span class="token punctuation">,</span> text_in<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        agenda_items<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> item<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-void">void</span> <span class="token function">delete_agenda_item</span><span class="token punctuation">(</span>AgendaItem<span class="token operator">*</span> agenda_item<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">//error if trying to go out of bounds</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>agenda_items<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">MessageBox</span><span class="token punctuation">(</span>parent_hwnd<span class="token punctuation">,</span> <span class="token string">"You must have at least one agenda list item."</span><span class="token punctuation">,</span> <span class="token string">"Error"</span><span class="token punctuation">,</span> MB_OK <span class="token operator">|</span> MB_ICONEXCLAMATION<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token comment">//find the item in the vector and delete it</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> agenda_items<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>agenda_items<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> agenda_item<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                agenda_items<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>agenda_items<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    AgendaItem<span class="token operator">*</span> <span class="token function">add_new_agenda_item_below</span><span class="token punctuation">(</span>AgendaItem<span class="token operator">*</span> agenda_item<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> id <span class="token operator">=</span> agenda_item<span class="token operator">-&gt;</span><span class="token function">get_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//new AgendaItem</span></span>
<span class="line">        AgendaItem <span class="token operator">*</span>new_agenda_item <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token function">AgendaItem</span><span class="token punctuation">(</span>parent_hwnd<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//set the id of the new AgendaItem to the id of the old one + 1</span></span>
<span class="line">        new_agenda_item<span class="token operator">-&gt;</span><span class="token function">set_id</span><span class="token punctuation">(</span>id <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//insert the new AgendaItem into the vector</span></span>
<span class="line">        agenda_items<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>agenda_items<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> new_agenda_item<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//raise the ID's of all the other AgendaItems after the new one</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> i <span class="token operator">=</span> id <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> agenda_items<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            agenda_items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token function">set_id</span><span class="token punctuation">(</span>agenda_items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token function">get_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> new_agenda_item<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> <span class="token function">get_num_agenda_items</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> agenda_items<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-void">void</span> <span class="token function">redraw</span><span class="token punctuation">(</span>HWND<span class="token operator">&amp;</span> parent_hwnd<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">//clears the window</span></span>
<span class="line">        RECT rect<span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">GetClientRect</span><span class="token punctuation">(</span>parent_hwnd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rect<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">FillRect</span><span class="token punctuation">(</span><span class="token function">GetDC</span><span class="token punctuation">(</span>parent_hwnd<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>rect<span class="token punctuation">,</span> <span class="token punctuation">(</span>HBRUSH<span class="token punctuation">)</span><span class="token function">CreateSolidBrush</span><span class="token punctuation">(</span><span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//Destroy all the child windows in the parent window (Parent HWND Handle)</span></span>
<span class="line">        <span class="token function">EnumChildWindows</span><span class="token punctuation">(</span>parent_hwnd<span class="token punctuation">,</span> DestroyChildCallback<span class="token punctuation">,</span> <span class="token punctuation">(</span>LPARAM<span class="token punctuation">)</span><span class="token operator">&amp;</span>parent_hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//Set the new ids, AND draw the new buttons</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-auto">auto</span> <span class="token operator">&amp;</span>item <span class="token operator">:</span> agenda_items<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            item<span class="token operator">-&gt;</span><span class="token function">set_id</span><span class="token punctuation">(</span>index<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            item<span class="token operator">-&gt;</span><span class="token function">draw</span><span class="token punctuation">(</span>parent_hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span>    </span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    vector<span class="token operator">&lt;</span>AgendaItem<span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token function">get_agenda_items</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> agenda_items<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    BOOL <span class="token function">save_into_text_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">//open the file</span></span>
<span class="line">        ofstream file<span class="token punctuation">;</span></span>
<span class="line">        file<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>agenda_items_filename<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//if the file is not open, return false</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">.</span><span class="token function">is_open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> FALSE<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token comment">//write the text from each AgendaItem into the file</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-auto">auto</span> <span class="token operator">&amp;</span>item <span class="token operator">:</span> agenda_items<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            file <span class="token operator">&lt;&lt;</span> item<span class="token operator">-&gt;</span><span class="token function">get_text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token comment">//close the file</span></span>
<span class="line">        file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> TRUE<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">LRESULT CALLBACK <span class="token function">WndProc</span><span class="token punctuation">(</span>HWND hwnd<span class="token punctuation">,</span> UINT msg<span class="token punctuation">,</span> WPARAM wParam<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-switch">switch</span> <span class="token punctuation">(</span>msg<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-case">case</span> WM_CREATE<span class="token operator">:</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            AgendaList<span class="token operator">*</span> agenda_list <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token function">AgendaList</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span>   </span>
<span class="line">            <span class="token comment">//Initialize via filename</span></span>
<span class="line">            ifstream file<span class="token punctuation">;</span></span>
<span class="line">            file<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>agenda_items_filename<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">//FILE DOES NOT EXIST</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">.</span><span class="token function">is_open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                AgendaItem <span class="token operator">*</span>a1 <span class="token operator">=</span> agenda_list<span class="token operator">-&gt;</span><span class="token function">create_agenda_item</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> <span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                AgendaItem <span class="token operator">*</span>a2 <span class="token operator">=</span> agenda_list<span class="token operator">-&gt;</span><span class="token function">create_agenda_item</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> <span class="token string">"grell"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                AgendaItem <span class="token operator">*</span>a3 <span class="token operator">=</span> agenda_list<span class="token operator">-&gt;</span><span class="token function">create_agenda_item</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> <span class="token string">"grain"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token comment">//FILE DOES EXIST</span></span>
<span class="line">            <span class="token keyword keyword-else">else</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                string line<span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">{</span></span>
<span class="line">                    agenda_list<span class="token operator">-&gt;</span><span class="token function">create_agenda_item</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token comment">//attack agenda_list to the parent main window</span></span>
<span class="line">            <span class="token function">SetWindowLongPtr</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> GWLP_USERDATA<span class="token punctuation">,</span> <span class="token punctuation">(</span>LONG_PTR<span class="token punctuation">)</span>agenda_list<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-case">case</span> WM_COMMAND<span class="token operator">:</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-switch">switch</span> <span class="token punctuation">(</span><span class="token function">LOWORD</span><span class="token punctuation">(</span>wParam<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">//clicking on the text edit box</span></span>
<span class="line">            <span class="token keyword keyword-case">case</span> <span class="token number">1</span><span class="token operator">:</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                <span class="token comment">//HIWORD(wParam) is the control-defined notification code according to the docs at https://docs.microsoft.com/en-us/windows/win32/menurc/wm-command</span></span>
<span class="line">                <span class="token comment">//The notification codes for this edit box is located in https://docs.microsoft.com/en-us/windows/win32/controls/en-killfocus</span></span>
<span class="line">                <span class="token comment">//I was unable to use WM_NOTIFY, it only worked with WM_COMMAND</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token function">HIWORD</span><span class="token punctuation">(</span>wParam<span class="token punctuation">)</span> <span class="token operator">==</span> EN_KILLFOCUS<span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">{</span></span>
<span class="line">                    HWND textbox <span class="token operator">=</span> <span class="token punctuation">(</span>HWND<span class="token punctuation">)</span>lParam<span class="token punctuation">;</span></span>
<span class="line">                    <span class="token comment">//get text</span></span>
<span class="line">                    <span class="token keyword keyword-char">char</span> buffer<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token function">GetWindowText</span><span class="token punctuation">(</span>textbox<span class="token punctuation">,</span> buffer<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token comment">//get the agenda list</span></span>
<span class="line">                    AgendaList<span class="token operator">*</span> agenda_list <span class="token operator">=</span> <span class="token punctuation">(</span>AgendaList<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">GetWindowLongPtr</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> GWLP_USERDATA<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token comment">//get the current agenda item</span></span>
<span class="line">                    AgendaItem<span class="token operator">*</span> agenda_item <span class="token operator">=</span> <span class="token punctuation">(</span>AgendaItem<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">GetWindowLongPtr</span><span class="token punctuation">(</span>textbox<span class="token punctuation">,</span> GWLP_USERDATA<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token comment">//set the text of the current agenda item</span></span>
<span class="line">                    agenda_item<span class="token operator">-&gt;</span><span class="token function">set_text</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    agenda_list<span class="token operator">-&gt;</span><span class="token function">save_into_text_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">                <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token comment">//add agenda item</span></span>
<span class="line">            <span class="token keyword keyword-case">case</span> <span class="token number">2</span><span class="token operator">:</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                <span class="token comment">//get the button</span></span>
<span class="line">                HWND button <span class="token operator">=</span> <span class="token punctuation">(</span>HWND<span class="token punctuation">)</span>lParam<span class="token punctuation">;</span></span>
<span class="line">                <span class="token comment">//get the userdata from the button (agenda item)</span></span>
<span class="line">                AgendaItem<span class="token operator">*</span> agenda_item <span class="token operator">=</span> <span class="token punctuation">(</span>AgendaItem<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">GetWindowLongPtr</span><span class="token punctuation">(</span>button<span class="token punctuation">,</span> GWLP_USERDATA<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token comment">//get agenda list (attached to this HWND durig WM_CREATE)</span></span>
<span class="line">                AgendaList <span class="token operator">*</span>agenda_list <span class="token operator">=</span> <span class="token punctuation">(</span>AgendaList <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">GetWindowLongPtr</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> GWLP_USERDATA<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"size: "</span> <span class="token operator">&lt;&lt;</span> agenda_list<span class="token operator">-&gt;</span><span class="token function">get_num_agenda_items</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">                AgendaItem<span class="token operator">*</span> new_agenda_item <span class="token operator">=</span> agenda_list<span class="token operator">-&gt;</span><span class="token function">add_new_agenda_item_below</span><span class="token punctuation">(</span>agenda_item<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                agenda_list<span class="token operator">-&gt;</span><span class="token function">redraw</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token function">SetFocus</span><span class="token punctuation">(</span>new_agenda_item<span class="token operator">-&gt;</span><span class="token function">get_textbox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"size: "</span> <span class="token operator">&lt;&lt;</span> agenda_list<span class="token operator">-&gt;</span><span class="token function">get_num_agenda_items</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token comment">//deleting in an agenda item</span></span>
<span class="line">            <span class="token keyword keyword-case">case</span> <span class="token number">3</span><span class="token operator">:</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                <span class="token comment">//get the button</span></span>
<span class="line">                HWND button <span class="token operator">=</span> <span class="token punctuation">(</span>HWND<span class="token punctuation">)</span>lParam<span class="token punctuation">;</span></span>
<span class="line">                <span class="token comment">//get the userdata from the button (attached to the agenda item)</span></span>
<span class="line">                AgendaItem<span class="token operator">*</span> agenda_item <span class="token operator">=</span> <span class="token punctuation">(</span>AgendaItem<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">GetWindowLongPtr</span><span class="token punctuation">(</span>button<span class="token punctuation">,</span> GWLP_USERDATA<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token comment">//get agenda list (attached to this HWND durig WM_CREATE)</span></span>
<span class="line">                AgendaList<span class="token operator">*</span> agenda_list <span class="token operator">=</span> <span class="token punctuation">(</span>AgendaList<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">GetWindowLongPtr</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> GWLP_USERDATA<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"size: "</span> <span class="token operator">&lt;&lt;</span> agenda_list<span class="token operator">-&gt;</span><span class="token function">get_num_agenda_items</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">                agenda_list<span class="token operator">-&gt;</span><span class="token function">delete_agenda_item</span><span class="token punctuation">(</span>agenda_item<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                agenda_list<span class="token operator">-&gt;</span><span class="token function">redraw</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"size: "</span> <span class="token operator">&lt;&lt;</span> agenda_list<span class="token operator">-&gt;</span><span class="token function">get_num_agenda_items</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span>      </span>
<span class="line">&nbsp;</span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token comment">//change the colors of buttons</span></span>
<span class="line">        <span class="token keyword keyword-case">case</span> WM_CTLCOLORBTN<span class="token operator">:</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">//get the button</span></span>
<span class="line">            HWND button <span class="token operator">=</span> <span class="token punctuation">(</span>HWND<span class="token punctuation">)</span>lParam<span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">//get the userdata from the button (attached to the agenda item)</span></span>
<span class="line">            AgendaItem<span class="token operator">*</span> agenda_item <span class="token operator">=</span> <span class="token punctuation">(</span>AgendaItem<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">GetWindowLongPtr</span><span class="token punctuation">(</span>button<span class="token punctuation">,</span> GWLP_USERDATA<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">//get the color of the button</span></span>
<span class="line">            COLORREF color <span class="token operator">=</span> <span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">//set the color of the button</span></span>
<span class="line">            <span class="token function">SetBkColor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>HDC<span class="token punctuation">)</span>wParam<span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span>LRESULT<span class="token punctuation">)</span><span class="token function">CreateSolidBrush</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-case">case</span> WM_LBUTTONDOWN<span class="token operator">:</span></span>
<span class="line">            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Left button down"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-case">case</span> WM_DESTROY<span class="token operator">:</span></span>
<span class="line">            <span class="token function">PostQuitMessage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-default">default</span><span class="token operator">:</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token function">DefWindowProc</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> wParam<span class="token punctuation">,</span> lParam<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">HWND <span class="token function">create_window</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> width<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> height<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    HWND hwnd<span class="token punctuation">;</span></span>
<span class="line">    WNDCLASSEX wc<span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>cbSize <span class="token operator">=</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation">(</span>WNDCLASSEX<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>lpfnWndProc <span class="token operator">=</span> WndProc<span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>cbClsExtra <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>cbWndExtra <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hInstance <span class="token operator">=</span> <span class="token function">GetModuleHandle</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hIcon <span class="token operator">=</span> <span class="token function">LoadIcon</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> IDI_APPLICATION<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hCursor <span class="token operator">=</span> <span class="token function">LoadCursor</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> IDC_ARROW<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//the typical gray background color</span></span>
<span class="line">    HBRUSH gray<span class="token punctuation">;</span></span>
<span class="line">    gray <span class="token operator">=</span> <span class="token function">CreateSolidBrush</span><span class="token punctuation">(</span><span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hbrBackground <span class="token operator">=</span> gray<span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>lpszMenuName <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>lpszClassName <span class="token operator">=</span> <span class="token string">"Class"</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hIconSm <span class="token operator">=</span> <span class="token function">LoadIcon</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> IDI_APPLICATION<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">RegisterClassEx</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>wc<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"Window Registration Failed!"</span><span class="token punctuation">,</span> <span class="token string">"Error!"</span><span class="token punctuation">,</span></span>
<span class="line">            MB_ICONEXCLAMATION <span class="token operator">|</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    hwnd <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span></span>
<span class="line">        WS_EX_CLIENTEDGE<span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">"Class"</span><span class="token punctuation">,</span> <span class="token comment">//</span></span>
<span class="line">        <span class="token string">"Agenda"</span><span class="token punctuation">,</span></span>
<span class="line">        WS_OVERLAPPEDWINDOW<span class="token punctuation">,</span></span>
<span class="line">        CW_USEDEFAULT<span class="token punctuation">,</span> </span>
<span class="line">        CW_USEDEFAULT<span class="token punctuation">,</span> </span>
<span class="line">        width<span class="token punctuation">,</span> height<span class="token punctuation">,</span></span>
<span class="line">        <span class="token constant">NULL</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token comment">//</span></span>
<span class="line">        <span class="token function">GetModuleHandle</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>hwnd <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"Window Creation Failed!"</span><span class="token punctuation">,</span> <span class="token string">"Error!"</span><span class="token punctuation">,</span></span>
<span class="line">            MB_ICONEXCLAMATION <span class="token operator">|</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> hwnd<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword keyword-int">int</span> WINAPI <span class="token function">WinMain</span><span class="token punctuation">(</span>HINSTANCE hInstance<span class="token punctuation">,</span> HINSTANCE hPrevInstance<span class="token punctuation">,</span> LPSTR lpCmdLine<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> nCmdShow<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    HWND hwnd<span class="token punctuation">;</span></span>
<span class="line">    hwnd <span class="token operator">=</span> <span class="token function">create_window</span><span class="token punctuation">(</span>window_width<span class="token punctuation">,</span> window_height<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//divide three sections of that window  </span></span>
<span class="line">    <span class="token function">ShowWindow</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> nCmdShow<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">UpdateWindow</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    MSG msg<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token function">GetMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>msg<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">IsDialogMessage</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>msg<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">TranslateMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">DispatchMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Homemade Task Manager (Win32)</div>
                <div class="description">A lightning fast pop-up view of the currently running processes on a computer (Win32 C++ with no external wrappers). There are no magic Win32 kernel functions to get the CPU percentage of a process, unlike other metrics. Manual calculation.</div>
                <div class="languages">C++</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-cpp" tabindex="0">                <code class="language-cpp"><span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Windows.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Commctrl.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;tlhelp32.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;psapi.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ctime&gt;</span></span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-int">int</span> pop_up_width<span class="token punctuation">,</span> pop_up_height<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-using">using</span> <span class="token keyword keyword-namespace">namespace</span> std<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-int">int</span> pop_up_padding <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-int">int</span> size_of_font <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span></span>
<span class="line">HFONT windows_95_font <span class="token operator">=</span> <span class="token function">CreateFont</span><span class="token punctuation">(</span>size_of_font<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> FW_DONTCARE<span class="token punctuation">,</span> FALSE<span class="token punctuation">,</span> FALSE<span class="token punctuation">,</span> FALSE<span class="token punctuation">,</span> DEFAULT_CHARSET<span class="token punctuation">,</span> OUT_OUTLINE_PRECIS<span class="token punctuation">,</span> CLIP_DEFAULT_PRECIS<span class="token punctuation">,</span> CLEARTYPE_QUALITY<span class="token punctuation">,</span> VARIABLE_PITCH<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"System"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-struct">struct</span> <span class="token class-name">ProcessTimes</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    FILETIME fileTimeCreation<span class="token punctuation">;</span></span>
<span class="line">    FILETIME fileTimeExit<span class="token punctuation">;</span></span>
<span class="line">    FILETIME fileTimeKernel<span class="token punctuation">;</span></span>
<span class="line">    FILETIME fileTimeUser<span class="token punctuation">;</span></span>
<span class="line">    FILETIME lastFileTimeCreation<span class="token punctuation">;</span></span>
<span class="line">    FILETIME lastFileTimeExit<span class="token punctuation">;</span></span>
<span class="line">    FILETIME lastFileTimeKernel<span class="token punctuation">;</span></span>
<span class="line">    FILETIME lastFileTimeUser<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">map<span class="token operator">&lt;</span>DWORD<span class="token punctuation">,</span> ProcessTimes <span class="token operator">*</span><span class="token operator">&gt;</span> processTimesMap<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-double">double</span> <span class="token function">get_cpu_percentage</span><span class="token punctuation">(</span>HANDLE hProcess<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    DWORD process_id <span class="token operator">=</span> <span class="token function">GetProcessId</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//if the structure is NOT IN MAP, ADD IT</span></span>
<span class="line">    ProcessTimes <span class="token operator">*</span>processTimes<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>processTimesMap<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>process_id<span class="token punctuation">)</span> <span class="token operator">==</span> processTimesMap<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        processTimes <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token function">ProcessTimes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        FILETIME creationTime<span class="token punctuation">;</span></span>
<span class="line">        FILETIME exitTime<span class="token punctuation">;</span></span>
<span class="line">        FILETIME kernelTime<span class="token punctuation">;</span></span>
<span class="line">        FILETIME userTime<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> unit_of_process_usage<span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">GetProcessTimes</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">,</span> <span class="token operator">&amp;</span>creationTime<span class="token punctuation">,</span> <span class="token operator">&amp;</span>exitTime<span class="token punctuation">,</span> <span class="token operator">&amp;</span>kernelTime<span class="token punctuation">,</span> <span class="token operator">&amp;</span>userTime<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        processTimes<span class="token operator">-&gt;</span>fileTimeCreation <span class="token operator">=</span> creationTime<span class="token punctuation">;</span></span>
<span class="line">        processTimes<span class="token operator">-&gt;</span>fileTimeExit <span class="token operator">=</span> exitTime<span class="token punctuation">;</span></span>
<span class="line">        processTimes<span class="token operator">-&gt;</span>fileTimeKernel <span class="token operator">=</span> kernelTime<span class="token punctuation">;</span></span>
<span class="line">        processTimes<span class="token operator">-&gt;</span>fileTimeUser <span class="token operator">=</span> userTime<span class="token punctuation">;</span></span>
<span class="line">        processTimesMap<span class="token punctuation">[</span>process_id<span class="token punctuation">]</span> <span class="token operator">=</span> processTimes<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">//if the structure IS IN MAP, UPDATE IT</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        processTimes <span class="token operator">=</span> processTimesMap<span class="token punctuation">[</span>process_id<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        FILETIME creationTime<span class="token punctuation">;</span></span>
<span class="line">        FILETIME exitTime<span class="token punctuation">;</span></span>
<span class="line">        FILETIME kernelTime<span class="token punctuation">;</span></span>
<span class="line">        FILETIME userTime<span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">GetProcessTimes</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">,</span> <span class="token operator">&amp;</span>creationTime<span class="token punctuation">,</span> <span class="token operator">&amp;</span>exitTime<span class="token punctuation">,</span> <span class="token operator">&amp;</span>kernelTime<span class="token punctuation">,</span> <span class="token operator">&amp;</span>userTime<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        processTimes<span class="token operator">-&gt;</span>fileTimeCreation <span class="token operator">=</span> creationTime<span class="token punctuation">;</span></span>
<span class="line">        processTimes<span class="token operator">-&gt;</span>fileTimeExit <span class="token operator">=</span> exitTime<span class="token punctuation">;</span></span>
<span class="line">        processTimes<span class="token operator">-&gt;</span>fileTimeKernel <span class="token operator">=</span> kernelTime<span class="token punctuation">;</span></span>
<span class="line">        processTimes<span class="token operator">-&gt;</span>fileTimeUser <span class="token operator">=</span> userTime<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token comment">//get the difference between the last time and the current time</span></span>
<span class="line">    ULARGE_INTEGER kernelTimeDifference<span class="token punctuation">;</span></span>
<span class="line">    kernelTimeDifference<span class="token punctuation">.</span>HighPart <span class="token operator">=</span> processTimes<span class="token operator">-&gt;</span>fileTimeKernel<span class="token punctuation">.</span>dwHighDateTime <span class="token operator">-</span> processTimes<span class="token operator">-&gt;</span>lastFileTimeKernel<span class="token punctuation">.</span>dwHighDateTime<span class="token punctuation">;</span></span>
<span class="line">    kernelTimeDifference<span class="token punctuation">.</span>LowPart <span class="token operator">=</span> processTimes<span class="token operator">-&gt;</span>fileTimeKernel<span class="token punctuation">.</span>dwLowDateTime <span class="token operator">-</span> processTimes<span class="token operator">-&gt;</span>lastFileTimeKernel<span class="token punctuation">.</span>dwLowDateTime<span class="token punctuation">;</span></span>
<span class="line">    ULARGE_INTEGER userTimeDifference<span class="token punctuation">;</span></span>
<span class="line">    userTimeDifference<span class="token punctuation">.</span>HighPart <span class="token operator">=</span> processTimes<span class="token operator">-&gt;</span>fileTimeUser<span class="token punctuation">.</span>dwHighDateTime <span class="token operator">-</span> processTimes<span class="token operator">-&gt;</span>lastFileTimeUser<span class="token punctuation">.</span>dwHighDateTime<span class="token punctuation">;</span></span>
<span class="line">    userTimeDifference<span class="token punctuation">.</span>LowPart <span class="token operator">=</span> processTimes<span class="token operator">-&gt;</span>fileTimeUser<span class="token punctuation">.</span>dwLowDateTime <span class="token operator">-</span> processTimes<span class="token operator">-&gt;</span>lastFileTimeUser<span class="token punctuation">.</span>dwLowDateTime<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-double">double</span> unit_of_process_usage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword keyword-double">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>kernelTimeDifference<span class="token punctuation">.</span>QuadPart <span class="token operator">+</span> userTimeDifference<span class="token punctuation">.</span>QuadPart<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-double">double</span> cpu_percentage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword keyword-double">double</span><span class="token punctuation">)</span>unit_of_process_usage <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword keyword-double">double</span><span class="token punctuation">)</span><span class="token function">GetTickCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token comment">////THE RATIOS OF THE PROCESSES ARE ACCURATE, BUT NOT THE EXACT NUMBER FROM TASK MANAGER, unless I divide by 18. The numbers in the task manager were 18 times less the number calculated above. Sorry if this is not perfect. I don't know the exact way to calculate the cpu usage with the factor below. My interest lies in many other projects.</span></span>
<span class="line">    cpu_percentage <span class="token operator">/=</span> <span class="token number">18</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    processTimes<span class="token operator">-&gt;</span>lastFileTimeCreation <span class="token operator">=</span> processTimes<span class="token operator">-&gt;</span>fileTimeCreation<span class="token punctuation">;</span></span>
<span class="line">    processTimes<span class="token operator">-&gt;</span>lastFileTimeExit <span class="token operator">=</span> processTimes<span class="token operator">-&gt;</span>fileTimeExit<span class="token punctuation">;</span></span>
<span class="line">    processTimes<span class="token operator">-&gt;</span>lastFileTimeKernel <span class="token operator">=</span> processTimes<span class="token operator">-&gt;</span>fileTimeKernel<span class="token punctuation">;</span></span>
<span class="line">    processTimes<span class="token operator">-&gt;</span>lastFileTimeUser <span class="token operator">=</span> processTimes<span class="token operator">-&gt;</span>fileTimeUser<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> cpu_percentage<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">&gt;&gt;</span> <span class="token function">get_processes_information</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// get list of processes</span></span>
<span class="line">    HANDLE hProcessSnap<span class="token punctuation">;</span></span>
<span class="line">    PROCESSENTRY32 pe32<span class="token punctuation">;</span></span>
<span class="line">    vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">&gt;&gt;</span> processes_information<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> total_processes_to_show <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    hProcessSnap <span class="token operator">=</span> <span class="token function">CreateToolhelp32Snapshot</span><span class="token punctuation">(</span>TH32CS_SNAPPROCESS<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>hProcessSnap <span class="token operator">==</span> INVALID_HANDLE_VALUE<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    pe32<span class="token punctuation">.</span>dwSize <span class="token operator">=</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation">(</span>PROCESSENTRY32<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">Process32First</span><span class="token punctuation">(</span>hProcessSnap<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pe32<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hProcessSnap<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-do">do</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        HANDLE hProcess<span class="token punctuation">;</span></span>
<span class="line">        PROCESS_MEMORY_COUNTERS pmc<span class="token punctuation">;</span></span>
<span class="line">        hProcess <span class="token operator">=</span> <span class="token function">OpenProcess</span><span class="token punctuation">(</span>PROCESS_QUERY_INFORMATION <span class="token operator">|</span> PROCESS_VM_READ<span class="token punctuation">,</span> FALSE<span class="token punctuation">,</span> pe32<span class="token punctuation">.</span>th32ProcessID<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>hProcess <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">//do nothing if process is not opened</span></span>
<span class="line">            <span class="token keyword keyword-continue">continue</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">GetProcessMemoryInfo</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pmc<span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation">(</span>pmc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-int">int</span> memory_kbs <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword keyword-int">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pmc<span class="token punctuation">.</span>WorkingSetSize <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            string process_name <span class="token operator">=</span> pe32<span class="token punctuation">.</span>szExeFile<span class="token punctuation">;</span></span>
<span class="line">            DWORD process_id <span class="token operator">=</span> pe32<span class="token punctuation">.</span>th32ProcessID<span class="token punctuation">;</span></span>
<span class="line">            vector<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span> process_info<span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-double">double</span> cpu_percentage <span class="token operator">=</span> <span class="token function">get_cpu_percentage</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            PDWORD handle_count_struct_instance <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> DWORD<span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">GetProcessHandleCount</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">,</span> handle_count_struct_instance<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-int">int</span> handle_count <span class="token operator">=</span> <span class="token operator">*</span>handle_count_struct_instance<span class="token punctuation">;</span></span>
<span class="line">            process_info<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>process_name<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            process_info<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">to_string</span><span class="token punctuation">(</span>memory_kbs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            process_info<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">to_string</span><span class="token punctuation">(</span>process_id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            process_info<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">to_string</span><span class="token punctuation">(</span>handle_count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            process_info<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">to_string</span><span class="token punctuation">(</span>cpu_percentage<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            processes_information<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>process_info<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            process_info<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-delete">delete</span> handle_count_struct_instance<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token function">Process32Next</span><span class="token punctuation">(</span>hProcessSnap<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pe32<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hProcessSnap<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token comment">// sort processes by memory</span></span>
<span class="line">    <span class="token function">sort</span><span class="token punctuation">(</span>processes_information<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> processes_information<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span> a<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span> b<span class="token punctuation">)</span></span>
<span class="line">         <span class="token punctuation">{</span> <span class="token keyword keyword-return">return</span> <span class="token function">stoi</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token function">stoi</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//slice this vector to show only top 20 processes</span></span>
<span class="line">    processes_information<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>processes_information<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> total_processes_to_show<span class="token punctuation">,</span> processes_information<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> processes_information<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">LRESULT WINAPI <span class="token function">WndProc</span><span class="token punctuation">(</span>HWND hWnd<span class="token punctuation">,</span> UINT Msg<span class="token punctuation">,</span> WPARAM wParam<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-switch">switch</span> <span class="token punctuation">(</span>Msg<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> WM_CREATE<span class="token operator">:</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">//paint the popup to salmon</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> WM_TIMER<span class="token operator">:</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token keyword keyword-int">int</span> cell_width <span class="token operator">=</span> <span class="token number">125</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> column_2_distance <span class="token operator">=</span> <span class="token number">125</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> column_3_distance <span class="token operator">=</span> <span class="token number">225</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> column_4_distance <span class="token operator">=</span> <span class="token number">325</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> column_5_distance <span class="token operator">=</span> <span class="token number">450</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">//adds a box</span></span>
<span class="line">        HDC hdcWindow <span class="token operator">=</span> <span class="token function">GetDC</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        RECT rect<span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">GetClientRect</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rect<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        HBRUSH salmon <span class="token operator">=</span> <span class="token function">CreateSolidBrush</span><span class="token punctuation">(</span><span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        COLORREF dark_blue <span class="token operator">=</span> <span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">FillRect</span><span class="token punctuation">(</span>hdcWindow<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rect<span class="token punctuation">,</span> salmon<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//font for the text</span></span>
<span class="line">        <span class="token function">SelectObject</span><span class="token punctuation">(</span>hdcWindow<span class="token punctuation">,</span> windows_95_font<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">SetTextColor</span><span class="token punctuation">(</span>hdcWindow<span class="token punctuation">,</span> dark_blue<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">SetBkMode</span><span class="token punctuation">(</span>hdcWindow<span class="token punctuation">,</span> TRANSPARENT<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//add text</span></span>
<span class="line">        <span class="token keyword keyword-auto">auto</span> processes_information <span class="token operator">=</span> <span class="token function">get_processes_information</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">// SelectObject(hdcWindow, windows_95_font);</span></span>
<span class="line">        <span class="token comment">// SetTextColor(hdcWindow, dark_blue);</span></span>
<span class="line">        <span class="token comment">// SetBkMode(hdcWindow, TRANSPARENT);</span></span>
<span class="line">        <span class="token comment">// DrawText(hdcWindow, TEXT("Processes"), -1, &amp;rect, DT_CENTER | DT_VCENTER | DT_SINGLELINE );</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> processes_information<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-int">int</span> line_height <span class="token operator">=</span> size_of_font <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span></span>
<span class="line">            RECT text_rect <span class="token operator">=</span> <span class="token punctuation">{</span>pop_up_padding<span class="token punctuation">,</span>                     <span class="token comment">//left</span></span>
<span class="line">                              <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token punctuation">(</span>line_height<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token comment">//top</span></span>
<span class="line">                              pop_up_padding <span class="token operator">+</span> cell_width<span class="token punctuation">,</span>        <span class="token comment">//right</span></span>
<span class="line">                              <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token punctuation">(</span>line_height<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> line_height<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//bottom</span></span>
<span class="line">            <span class="token function">DrawText</span><span class="token punctuation">(</span>hdcWindow<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span>processes_information<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>text_rect<span class="token punctuation">,</span> DT_LEFT <span class="token operator">|</span> DT_VCENTER <span class="token operator">|</span> DT_SINGLELINE<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">// draw the text of memory usage right after the process name</span></span>
<span class="line">            text_rect<span class="token punctuation">.</span>left <span class="token operator">=</span> pop_up_padding <span class="token operator">+</span> column_2_distance<span class="token punctuation">;</span></span>
<span class="line">            text_rect<span class="token punctuation">.</span>right <span class="token operator">=</span> pop_up_padding <span class="token operator">+</span> column_2_distance <span class="token operator">+</span> cell_width<span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">DrawText</span><span class="token punctuation">(</span>hdcWindow<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token punctuation">(</span>processes_information<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">" KB"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>text_rect<span class="token punctuation">,</span> DT_LEFT <span class="token operator">|</span> DT_VCENTER <span class="token operator">|</span> DT_SINGLELINE<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">// draw the text of process id right after the memory usage</span></span>
<span class="line">            text_rect<span class="token punctuation">.</span>left <span class="token operator">=</span> pop_up_padding <span class="token operator">+</span> column_3_distance<span class="token punctuation">;</span></span>
<span class="line">            text_rect<span class="token punctuation">.</span>right <span class="token operator">=</span> pop_up_padding <span class="token operator">+</span> column_3_distance <span class="token operator">+</span> cell_width<span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">DrawText</span><span class="token punctuation">(</span>hdcWindow<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"ID: "</span> <span class="token operator">+</span> processes_information<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>text_rect<span class="token punctuation">,</span> DT_LEFT <span class="token operator">|</span> DT_VCENTER <span class="token operator">|</span> DT_SINGLELINE<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">// draw the text of process id right after the memory usage</span></span>
<span class="line">            text_rect<span class="token punctuation">.</span>left <span class="token operator">=</span> pop_up_padding <span class="token operator">+</span> column_4_distance<span class="token punctuation">;</span></span>
<span class="line">            text_rect<span class="token punctuation">.</span>right <span class="token operator">=</span> pop_up_padding <span class="token operator">+</span> column_4_distance <span class="token operator">+</span> cell_width<span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">DrawText</span><span class="token punctuation">(</span>hdcWindow<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"Handles: "</span> <span class="token operator">+</span> processes_information<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>text_rect<span class="token punctuation">,</span> DT_LEFT <span class="token operator">|</span> DT_VCENTER <span class="token operator">|</span> DT_SINGLELINE<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">// draw the text of process id right after the memory usage</span></span>
<span class="line">            text_rect<span class="token punctuation">.</span>left <span class="token operator">=</span> pop_up_padding <span class="token operator">+</span> column_5_distance<span class="token punctuation">;</span></span>
<span class="line">            text_rect<span class="token punctuation">.</span>right <span class="token operator">=</span> pop_up_padding <span class="token operator">+</span> column_5_distance <span class="token operator">+</span> cell_width<span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">DrawText</span><span class="token punctuation">(</span>hdcWindow<span class="token punctuation">,</span> <span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"CPU: "</span> <span class="token operator">+</span> processes_information<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"%"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>text_rect<span class="token punctuation">,</span> DT_LEFT <span class="token operator">|</span> DT_VCENTER <span class="token operator">|</span> DT_SINGLELINE<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token function">DeleteObject</span><span class="token punctuation">(</span>salmon<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">DeleteObject</span><span class="token punctuation">(</span>hdcWindow<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> WM_PAINT<span class="token operator">:</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        PAINTSTRUCT ps<span class="token punctuation">;</span></span>
<span class="line">        HDC hdcWindow <span class="token operator">=</span> <span class="token function">BeginPaint</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        RECT rect<span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">GetClientRect</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rect<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        HBRUSH salmon <span class="token operator">=</span> <span class="token function">CreateSolidBrush</span><span class="token punctuation">(</span><span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        COLORREF dark_blue <span class="token operator">=</span> <span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">FillRect</span><span class="token punctuation">(</span>hdcWindow<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rect<span class="token punctuation">,</span> salmon<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">DeleteObject</span><span class="token punctuation">(</span>salmon<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">DeleteObject</span><span class="token punctuation">(</span>hdcWindow<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">EndPaint</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> WM_ERASEBKGND<span class="token operator">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> WM_CLOSE<span class="token operator">:</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> WM_DESTROY<span class="token operator">:</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">PostQuitMessage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token function">DefWindowProc</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> Msg<span class="token punctuation">,</span> wParam<span class="token punctuation">,</span> lParam<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-int">int</span> APIENTRY <span class="token function">WinMain</span><span class="token punctuation">(</span>HINSTANCE hInstance<span class="token punctuation">,</span> HINSTANCE hPrev<span class="token punctuation">,</span> LPSTR lpCmdLine<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> nShowCmd<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> screen_width <span class="token operator">=</span> <span class="token function">GetSystemMetrics</span><span class="token punctuation">(</span>SM_CXSCREEN<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">        screen_height <span class="token operator">=</span> <span class="token function">GetSystemMetrics</span><span class="token punctuation">(</span>SM_CYSCREEN<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-int">int</span> padding <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> left_padding <span class="token operator">=</span> padding<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> top_padding <span class="token operator">=</span> padding<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> right_padding <span class="token operator">=</span> padding<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> bottom_padding <span class="token operator">=</span> padding<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    pop_up_width <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">GetSystemMetrics</span><span class="token punctuation">(</span>SM_CXSCREEN<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.45</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    pop_up_height <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">GetSystemMetrics</span><span class="token punctuation">(</span>SM_CYSCREEN<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.66</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token comment">//salmon brush HBRUSH</span></span>
<span class="line">    HBRUSH salmon <span class="token operator">=</span> <span class="token function">CreateSolidBrush</span><span class="token punctuation">(</span><span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//salmon pen HPEN</span></span>
<span class="line">    HPEN salmon_pen <span class="token operator">=</span> <span class="token function">CreatePen</span><span class="token punctuation">(</span>PS_SOLID<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    WNDCLASS wndClass <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> WndProc<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> hInstance<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token function">LoadCursor</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> IDC_ARROW<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"popup_process"</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">RegisterClass</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>wndClass<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token function">MessageBox</span><span class="token punctuation">(</span>HWND_DESKTOP<span class="token punctuation">,</span> <span class="token string">"Cannot register class!"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> MB_ICONERROR <span class="token operator">|</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    HWND hWnd <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span>WS_EX_TOPMOST<span class="token punctuation">,</span> <span class="token string">"popup_process"</span><span class="token punctuation">,</span> <span class="token string">"popup_process"</span><span class="token punctuation">,</span> WS_POPUP<span class="token punctuation">,</span></span>
<span class="line">                               screen_width <span class="token operator">-</span> pop_up_width <span class="token operator">-</span> right_padding<span class="token punctuation">,</span> screen_height <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> pop_up_height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> pop_up_width<span class="token punctuation">,</span> pop_up_height<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> hInstance<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//start timer</span></span>
<span class="line">    <span class="token function">SetTimer</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>hWnd<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token function">MessageBox</span><span class="token punctuation">(</span>HWND_DESKTOP<span class="token punctuation">,</span> <span class="token string">"Cannot create window!"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> MB_ICONERROR <span class="token operator">|</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    MSG Msg <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//show &amp; update window</span></span>
<span class="line">    <span class="token function">ShowWindow</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> nShowCmd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">UpdateWindow</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span>Msg<span class="token punctuation">.</span>message <span class="token operator">!=</span> WM_QUIT<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">PeekMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Msg<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> PM_REMOVE<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">TranslateMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Msg<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">DispatchMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Msg<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span>VK_ESCAPE<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x8000</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token function">DestroyWindow</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Stop Frozen Windows Processes above 250000 KB</div>
                <div class="description">Raw C++ Win32 program to terminate processes that are above 250000 KB, to speed up the computer instantaneously. Very great tool to use with AutoHotKey (Win+K)</div>
                <div class="languages">C++</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-cpp" tabindex="0">                <code class="language-cpp"><span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Windows.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Commctrl.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;tlhelp32.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;psapi.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ctime&gt;</span></span></span>
<span class="line"><span class="token keyword keyword-using">using</span> <span class="token keyword keyword-namespace">namespace</span> std<span class="token punctuation">;</span></span>
<span class="line">HHOOK _hook<span class="token punctuation">;</span></span>
<span class="line">HMENU menu<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-void">void</span> <span class="token function">terminate_process</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> pid<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">LRESULT __stdcall <span class="token function">HookCallback</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> nCode<span class="token punctuation">,</span> WPARAM wParam<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token function">CallNextHookEx</span><span class="token punctuation">(</span>_hook<span class="token punctuation">,</span> nCode<span class="token punctuation">,</span> wParam<span class="token punctuation">,</span> lParam<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword keyword-int">int</span> WINAPI <span class="token function">WinMain</span><span class="token punctuation">(</span>HINSTANCE hInstance<span class="token punctuation">,</span> HINSTANCE hPrevInstance<span class="token punctuation">,</span> LPSTR lpCmdLine<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> nCmdShow<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// get list of processes</span></span>
<span class="line">    HANDLE hProcessSnap<span class="token punctuation">;</span></span>
<span class="line">    PROCESSENTRY32 pe32<span class="token punctuation">;</span></span>
<span class="line">    hProcessSnap <span class="token operator">=</span> <span class="token function">CreateToolhelp32Snapshot</span><span class="token punctuation">(</span>TH32CS_SNAPPROCESS<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>hProcessSnap <span class="token operator">==</span> INVALID_HANDLE_VALUE<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    pe32<span class="token punctuation">.</span>dwSize <span class="token operator">=</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation">(</span>PROCESSENTRY32<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">Process32First</span><span class="token punctuation">(</span>hProcessSnap<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pe32<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hProcessSnap<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-do">do</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        HANDLE hProcess<span class="token punctuation">;</span></span>
<span class="line">        PROCESS_MEMORY_COUNTERS pmc<span class="token punctuation">;</span></span>
<span class="line">        hProcess <span class="token operator">=</span> <span class="token function">OpenProcess</span><span class="token punctuation">(</span>PROCESS_QUERY_INFORMATION <span class="token operator">|</span> PROCESS_VM_READ<span class="token punctuation">,</span> FALSE<span class="token punctuation">,</span> pe32<span class="token punctuation">.</span>th32ProcessID<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>hProcess <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            cout <span class="token operator">&lt;&lt;</span> pe32<span class="token punctuation">.</span>szExeFile <span class="token operator">&lt;&lt;</span> <span class="token string">" could not be opened"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-continue">continue</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">GetProcessMemoryInfo</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pmc<span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation">(</span>pmc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            cout <span class="token operator">&lt;&lt;</span> pe32<span class="token punctuation">.</span>szExeFile <span class="token operator">&lt;&lt;</span> <span class="token string">" has "</span> <span class="token operator">&lt;&lt;</span> pmc<span class="token punctuation">.</span>WorkingSetSize <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" KB of memory"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> memory_kbs <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword keyword-int">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pmc<span class="token punctuation">.</span>WorkingSetSize <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">// if memory is greater than 250000 MB, kill the process</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>memory_kbs <span class="token operator">&gt;</span> <span class="token number">250000</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            cout <span class="token operator">&lt;&lt;</span> endl <span class="token operator">&lt;&lt;</span> <span class="token string">"Killing "</span> <span class="token operator">&lt;&lt;</span> pe32<span class="token punctuation">.</span>szExeFile <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">//DWORD to INT</span></span>
<span class="line">            <span class="token keyword keyword-int">int</span> pid <span class="token operator">=</span> pe32<span class="token punctuation">.</span>th32ProcessID<span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">terminate_process</span><span class="token punctuation">(</span>pid<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token function">Process32Next</span><span class="token punctuation">(</span>hProcessSnap<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pe32<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hProcessSnap<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-void">void</span> <span class="token function">terminate_process</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> pid<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    HANDLE hProcess <span class="token operator">=</span> <span class="token function">OpenProcess</span><span class="token punctuation">(</span>PROCESS_TERMINATE<span class="token punctuation">,</span> FALSE<span class="token punctuation">,</span> pid<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>hProcess <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Could not open process"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">TerminateProcess</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Could not terminate process"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Colliding Objects On Desktop</div>
                <div class="description">Win32 C++ pop-up app (using WS_POPUP) to show words colliding, with a transparent background</div>
                <div class="languages">C++</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-cpp" tabindex="0">                <code class="language-cpp"><span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Windows.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Commctrl.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;tlhelp32.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;psapi.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ctime&gt;</span></span></span>
<span class="line"><span class="token keyword keyword-using">using</span> <span class="token keyword keyword-namespace">namespace</span> std<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-int">int</span> pop_up_height<span class="token punctuation">,</span> pop_up_width<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-int">int</span> moving_speed <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-int">int</span> total_words <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-int">int</span> milliseconds_between_frames <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-int">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-void">void</span> <span class="token function">add_transparent_text_to_desktop</span><span class="token punctuation">(</span>HWND <span class="token operator">&amp;</span><span class="token punctuation">,</span> HDC <span class="token operator">&amp;</span><span class="token punctuation">,</span> HDC <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">BOOL <span class="token function">did_rects_collide</span><span class="token punctuation">(</span>RECT<span class="token punctuation">,</span> RECT<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-void">void</span> <span class="token function">bounce_rectangles</span><span class="token punctuation">(</span>RECT<span class="token punctuation">,</span> RECT<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-struct">struct</span> <span class="token class-name">Word</span><span class="token punctuation">;</span></span>
<span class="line">vector<span class="token operator">&lt;</span>pair<span class="token operator">&lt;</span>Word <span class="token operator">*</span><span class="token punctuation">,</span> Word <span class="token operator">*</span><span class="token operator">&gt;&gt;</span> all_collisions<span class="token punctuation">;</span></span>
<span class="line">COLORREF <span class="token function">rainbow_generator</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-struct">struct</span> <span class="token class-name">Word</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    string content<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">;</span></span>
<span class="line">    POINT path_coordinates<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-double">double</span> x_speed<span class="token punctuation">,</span> y_speed<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> width<span class="token punctuation">,</span> height<span class="token punctuation">;</span></span>
<span class="line">    RECT rect<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> id<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-bool">bool</span> currently_dragging<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-static">static</span> <span class="token keyword keyword-int">int</span> last_id<span class="token punctuation">;</span></span>
<span class="line">    COLORREF color<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> color_index<span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//constructor taking in word</span></span>
<span class="line">    <span class="token function">Word</span><span class="token punctuation">(</span>string word_in<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        content <span class="token operator">=</span> word_in<span class="token punctuation">;</span></span>
<span class="line">        x <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> pop_up_width<span class="token punctuation">;</span></span>
<span class="line">        y <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> pop_up_height<span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//x_speed is random number between -20 and 20</span></span>
<span class="line">        x_speed <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> moving_speed <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> moving_speed<span class="token punctuation">;</span></span>
<span class="line">        y_speed <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> moving_speed <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> moving_speed<span class="token punctuation">;</span></span>
<span class="line">        width <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        height <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        RECT rect<span class="token punctuation">;</span></span>
<span class="line">        rect<span class="token punctuation">.</span>left <span class="token operator">=</span> x<span class="token punctuation">;</span></span>
<span class="line">        rect<span class="token punctuation">.</span>top <span class="token operator">=</span> y<span class="token punctuation">;</span></span>
<span class="line">        rect<span class="token punctuation">.</span>right <span class="token operator">=</span> x <span class="token operator">+</span> width<span class="token punctuation">;</span></span>
<span class="line">        rect<span class="token punctuation">.</span>bottom <span class="token operator">=</span> y <span class="token operator">+</span> height<span class="token punctuation">;</span></span>
<span class="line">        color_index <span class="token operator">=</span> <span class="token number">170</span><span class="token punctuation">;</span></span>
<span class="line">        color <span class="token operator">=</span> <span class="token function">rainbow_generator</span><span class="token punctuation">(</span>color_index<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">//new method</span></span>
<span class="line">    BOOL <span class="token function">is_clicked</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> x<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> y<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;</span> rect<span class="token punctuation">.</span>left <span class="token operator">&amp;&amp;</span> x <span class="token operator">&lt;</span> rect<span class="token punctuation">.</span>right <span class="token operator">&amp;&amp;</span> y <span class="token operator">&gt;</span> rect<span class="token punctuation">.</span>top <span class="token operator">&amp;&amp;</span> y <span class="token operator">&lt;</span> rect<span class="token punctuation">.</span>bottom<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">Context</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line"><span class="token keyword keyword-private">private</span><span class="token operator">:</span></span>
<span class="line">    HDC hDC<span class="token punctuation">;</span></span>
<span class="line">    HDC hCDC<span class="token punctuation">;</span></span>
<span class="line">    HWND hWnd<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-static">static</span> Context <span class="token operator">*</span>instance<span class="token punctuation">;</span></span>
<span class="line">    vector<span class="token operator">&lt;</span>Word <span class="token operator">*</span><span class="token operator">&gt;</span> words<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-public">public</span><span class="token operator">:</span></span>
<span class="line">    <span class="token keyword keyword-static">static</span> Context <span class="token operator">&amp;</span><span class="token function">get_instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-static">static</span> Context instance<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> instance<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-void">void</span> <span class="token function">set_all_handles</span><span class="token punctuation">(</span>HDC hDC_in<span class="token punctuation">,</span> HDC hCDC_in<span class="token punctuation">,</span> HWND hWnd_in<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        hDC <span class="token operator">=</span> hDC_in<span class="token punctuation">;</span></span>
<span class="line">        hCDC <span class="token operator">=</span> hCDC_in<span class="token punctuation">;</span></span>
<span class="line">        hWnd <span class="token operator">=</span> hWnd_in<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-void">void</span> <span class="token function">add_word</span><span class="token punctuation">(</span>string word<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        Word <span class="token operator">*</span>new_word <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token function">Word</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        words<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>new_word<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-void">void</span> <span class="token function">add_words</span><span class="token punctuation">(</span>string content<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> number_of_words<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> number_of_words<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">add_word</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    vector<span class="token operator">&lt;</span>Word <span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token function">get_words</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> words<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    HDC <span class="token function">get_hDC</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> hDC<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    HDC <span class="token function">get_hCDC</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> hCDC<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    HWND <span class="token function">get_hWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> hWnd<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-void">void</span> <span class="token function">delete_words_from_memory</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-auto">auto</span> <span class="token operator">&amp;</span>word <span class="token operator">:</span> words<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-delete">delete</span> word<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">Context context <span class="token operator">=</span> <span class="token class-name">Context</span><span class="token double-colon punctuation">::</span><span class="token function">get_instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-double">double</span> old_x_speed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-double">double</span> old_y_speed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-enum">enum</span> <span class="token class-name">direction</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    nw<span class="token punctuation">,</span></span>
<span class="line">    ne<span class="token punctuation">,</span></span>
<span class="line">    sw<span class="token punctuation">,</span></span>
<span class="line">    se</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">direction <span class="token function">direction_path_coordinates_went</span><span class="token punctuation">(</span>Word word_param<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">-</span> word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">-</span> word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> nw<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">-</span> word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">-</span> word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> sw<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">-</span> word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">-</span> word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> ne<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">-</span> word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">-</span> word_param<span class="token punctuation">.</span>path_coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> se<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> nw<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">//define mouseproc</span></span>
<span class="line">LRESULT CALLBACK <span class="token function">MouseProc</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> nCode<span class="token punctuation">,</span> WPARAM wParam<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>nCode <span class="token operator">==</span> HC_ACTION<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">//drag behavior</span></span>
<span class="line">        <span class="token comment">// if (wParam == WM_MOUSEMOVE &amp;&amp; GetAsyncKeyState(VK_LBUTTON) == -32768)</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>wParam <span class="token operator">==</span> WM_LBUTTONDOWN <span class="token operator">||</span> <span class="token punctuation">(</span>wParam <span class="token operator">==</span> WM_MOUSEMOVE <span class="token operator">&amp;&amp;</span> <span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span>VK_LBUTTON<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">32768</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">//get mouse coordinates</span></span>
<span class="line">            POINT p<span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">GetCursorPos</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-int">int</span> arrow_x <span class="token operator">=</span> p<span class="token punctuation">.</span>x<span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-int">int</span> arrow_y <span class="token operator">=</span> p<span class="token punctuation">.</span>y<span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">//check if any of the words are clicked</span></span>
<span class="line">            <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-auto">auto</span> <span class="token operator">&amp;</span>word <span class="token operator">:</span> context<span class="token punctuation">.</span><span class="token function">get_words</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>word<span class="token operator">-&gt;</span><span class="token function">is_clicked</span><span class="token punctuation">(</span>arrow_x<span class="token punctuation">,</span> arrow_y<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">{</span></span>
<span class="line">                    word<span class="token operator">-&gt;</span>x <span class="token operator">=</span> arrow_x <span class="token operator">-</span> word<span class="token operator">-&gt;</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span></span>
<span class="line">                    word<span class="token operator">-&gt;</span>y <span class="token operator">=</span> arrow_y <span class="token operator">-</span> word<span class="token operator">-&gt;</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span></span>
<span class="line">                    word<span class="token operator">-&gt;</span>rect<span class="token punctuation">.</span>left <span class="token operator">=</span> word<span class="token operator">-&gt;</span>x<span class="token punctuation">;</span></span>
<span class="line">                    word<span class="token operator">-&gt;</span>rect<span class="token punctuation">.</span>top <span class="token operator">=</span> word<span class="token operator">-&gt;</span>y<span class="token punctuation">;</span></span>
<span class="line">                    word<span class="token operator">-&gt;</span>rect<span class="token punctuation">.</span>right <span class="token operator">=</span> word<span class="token operator">-&gt;</span>x <span class="token operator">+</span> word<span class="token operator">-&gt;</span>width<span class="token punctuation">;</span></span>
<span class="line">                    word<span class="token operator">-&gt;</span>rect<span class="token punctuation">.</span>bottom <span class="token operator">=</span> word<span class="token operator">-&gt;</span>y <span class="token operator">+</span> word<span class="token operator">-&gt;</span>height<span class="token punctuation">;</span></span>
<span class="line">                    <span class="token comment">//do not update the old speed during dragging, only restart it from the speed when mouse was first clicked</span></span>
<span class="line">                    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>wParam <span class="token operator">!=</span> WM_MOUSEMOVE <span class="token operator">&amp;&amp;</span> <span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span>VK_LBUTTON<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">32768</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">{</span></span>
<span class="line">                        old_x_speed <span class="token operator">=</span> word<span class="token operator">-&gt;</span>x_speed<span class="token punctuation">;</span></span>
<span class="line">                        old_y_speed <span class="token operator">=</span> word<span class="token operator">-&gt;</span>y_speed<span class="token punctuation">;</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                    <span class="token comment">//if the path_coordinates[1] is not equal to arrow_x and arrow_y, then update the path_coordinates</span></span>
<span class="line">                    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>word<span class="token operator">-&gt;</span>path_coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">!=</span> arrow_x <span class="token operator">&amp;&amp;</span> word<span class="token operator">-&gt;</span>path_coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">!=</span> arrow_y<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">{</span></span>
<span class="line">                        word<span class="token operator">-&gt;</span>path_coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> word<span class="token operator">-&gt;</span>path_coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">                        word<span class="token operator">-&gt;</span>path_coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">=</span> arrow_x<span class="token punctuation">;</span></span>
<span class="line">                        word<span class="token operator">-&gt;</span>path_coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">=</span> arrow_y<span class="token punctuation">;</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">                    word<span class="token operator">-&gt;</span>x_speed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">                    word<span class="token operator">-&gt;</span>y_speed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">                    word<span class="token operator">-&gt;</span>currently_dragging <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token comment">//if mouse is released</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>wParam <span class="token operator">==</span> WM_LBUTTONUP<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">//get mouse coordinates</span></span>
<span class="line">            POINT p<span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">GetCursorPos</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-int">int</span> arrow_x <span class="token operator">=</span> p<span class="token punctuation">.</span>x<span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-int">int</span> arrow_y <span class="token operator">=</span> p<span class="token punctuation">.</span>y<span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">//check if any of the words are clicked</span></span>
<span class="line">            <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-auto">auto</span> <span class="token operator">&amp;</span>word <span class="token operator">:</span> context<span class="token punctuation">.</span><span class="token function">get_words</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>word<span class="token operator">-&gt;</span><span class="token function">is_clicked</span><span class="token punctuation">(</span>arrow_x<span class="token punctuation">,</span> arrow_y<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">{</span></span>
<span class="line">                    word<span class="token operator">-&gt;</span>currently_dragging <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">                    direction path_coordinates_went <span class="token operator">=</span> <span class="token function">direction_path_coordinates_went</span><span class="token punctuation">(</span><span class="token operator">*</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>path_coordinates_went <span class="token operator">==</span> nw<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">{</span></span>
<span class="line">                        word<span class="token operator">-&gt;</span>x_speed <span class="token operator">=</span> <span class="token operator">-</span><span class="token function">abs</span><span class="token punctuation">(</span>old_x_speed<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                        word<span class="token operator">-&gt;</span>y_speed <span class="token operator">=</span> <span class="token operator">-</span><span class="token function">abs</span><span class="token punctuation">(</span>old_y_speed<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                    <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>path_coordinates_went <span class="token operator">==</span> ne<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">{</span></span>
<span class="line">                        word<span class="token operator">-&gt;</span>x_speed <span class="token operator">=</span> <span class="token function">abs</span><span class="token punctuation">(</span>old_x_speed<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                        word<span class="token operator">-&gt;</span>y_speed <span class="token operator">=</span> <span class="token operator">-</span><span class="token function">abs</span><span class="token punctuation">(</span>old_y_speed<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                    <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>path_coordinates_went <span class="token operator">==</span> sw<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">{</span></span>
<span class="line">                        word<span class="token operator">-&gt;</span>x_speed <span class="token operator">=</span> <span class="token operator">-</span><span class="token function">abs</span><span class="token punctuation">(</span>old_x_speed<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                        word<span class="token operator">-&gt;</span>y_speed <span class="token operator">=</span> <span class="token function">abs</span><span class="token punctuation">(</span>old_y_speed<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                    <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>path_coordinates_went <span class="token operator">==</span> se<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">{</span></span>
<span class="line">                        word<span class="token operator">-&gt;</span>x_speed <span class="token operator">=</span> <span class="token function">abs</span><span class="token punctuation">(</span>old_x_speed<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                        word<span class="token operator">-&gt;</span>y_speed <span class="token operator">=</span> <span class="token function">abs</span><span class="token punctuation">(</span>old_y_speed<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token function">CallNextHookEx</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> nCode<span class="token punctuation">,</span> wParam<span class="token punctuation">,</span> lParam<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">LRESULT WINAPI <span class="token function">WndProc</span><span class="token punctuation">(</span>HWND hWnd<span class="token punctuation">,</span> UINT Msg<span class="token punctuation">,</span> WPARAM wParam<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-switch">switch</span> <span class="token punctuation">(</span>Msg<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">//draw text with a transparent background (no black background</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> WM_PAINT<span class="token operator">:</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-case">case</span> WM_CREATE<span class="token operator">:</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">//get the context object</span></span>
<span class="line">        context <span class="token operator">=</span> <span class="token class-name">Context</span><span class="token double-colon punctuation">::</span><span class="token function">get_instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">//rect</span></span>
<span class="line">        RECT rect<span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">GetClientRect</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rect<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> width <span class="token operator">=</span> rect<span class="token punctuation">.</span>right <span class="token operator">-</span> rect<span class="token punctuation">.</span>left<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> height <span class="token operator">=</span> rect<span class="token punctuation">.</span>bottom <span class="token operator">-</span> rect<span class="token punctuation">.</span>top<span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//Create DC</span></span>
<span class="line">        <span class="token comment">//Create Compatible DC</span></span>
<span class="line">        <span class="token comment">//Create Bitmap</span></span>
<span class="line">        HDC hDC <span class="token operator">=</span> <span class="token function">GetDC</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        HDC hCDC <span class="token operator">=</span> <span class="token function">CreateCompatibleDC</span><span class="token punctuation">(</span>hDC<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        HBITMAP hBmp <span class="token operator">=</span> <span class="token function">CreateCompatibleBitmap</span><span class="token punctuation">(</span>hDC<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        HBITMAP hBmpOld <span class="token operator">=</span> <span class="token punctuation">(</span>HBITMAP<span class="token punctuation">)</span><span class="token function">SelectObject</span><span class="token punctuation">(</span>hCDC<span class="token punctuation">,</span> hBmp<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">add_transparent_text_to_desktop</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> hDC<span class="token punctuation">,</span> hCDC<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">//fill the context object</span></span>
<span class="line">        context<span class="token punctuation">.</span><span class="token function">set_all_handles</span><span class="token punctuation">(</span>hDC<span class="token punctuation">,</span> hCDC<span class="token punctuation">,</span> hWnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">// context.add_word("One");</span></span>
<span class="line">        <span class="token comment">// context.add_word("Two");</span></span>
<span class="line">        <span class="token comment">// context.add_word("Three");</span></span>
<span class="line">        <span class="token comment">// context.add_word("Four");</span></span>
<span class="line">        <span class="token comment">// context.add_word("Five");</span></span>
<span class="line">        <span class="token comment">// context.add_word("Six");</span></span>
<span class="line">        <span class="token comment">// context.add_word("Seven");</span></span>
<span class="line">        <span class="token comment">// context.add_word("Eight");</span></span>
<span class="line">        <span class="token comment">// context.add_word("Nine");</span></span>
<span class="line">        <span class="token comment">// context.add_word("Ten");</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">// context.add_words("Win32 API", 5);</span></span>
<span class="line">        <span class="token comment">// context.add_words("Rust", 3);</span></span>
<span class="line">        <span class="token comment">// context.add_words("C++", 2);</span></span>
<span class="line">        context<span class="token punctuation">.</span><span class="token function">add_word</span><span class="token punctuation">(</span><span class="token string">"Python"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        context<span class="token punctuation">.</span><span class="token function">add_word</span><span class="token punctuation">(</span><span class="token string">"C#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        context<span class="token punctuation">.</span><span class="token function">add_word</span><span class="token punctuation">(</span><span class="token string">"Juniper"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        context<span class="token punctuation">.</span><span class="token function">add_word</span><span class="token punctuation">(</span><span class="token string">"Cisco"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        context<span class="token punctuation">.</span><span class="token function">add_word</span><span class="token punctuation">(</span><span class="token string">"AWS"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        context<span class="token punctuation">.</span><span class="token function">add_word</span><span class="token punctuation">(</span><span class="token string">"JavaScript"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">//Release DC</span></span>
<span class="line">        <span class="token function">ReleaseDC</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> hDC<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//Release Compatible DC</span></span>
<span class="line">        <span class="token function">DeleteDC</span><span class="token punctuation">(</span>hCDC<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//Release Bitmap</span></span>
<span class="line">        <span class="token function">DeleteObject</span><span class="token punctuation">(</span>hBmp<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> WM_TIMER<span class="token operator">:</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">//remember that this context was created once at WM_CREATE</span></span>
<span class="line">        <span class="token comment">// add_transparent_text_to_desktop(context.get_hWnd(), context.get_hDC(), context.get_hCDC());</span></span>
<span class="line">&nbsp;</span>
<span class="line">        RECT rect<span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">GetClientRect</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rect<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> width <span class="token operator">=</span> rect<span class="token punctuation">.</span>right <span class="token operator">-</span> rect<span class="token punctuation">.</span>left<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> height <span class="token operator">=</span> rect<span class="token punctuation">.</span>bottom <span class="token operator">-</span> rect<span class="token punctuation">.</span>top<span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//Create DC</span></span>
<span class="line">        HDC hDC <span class="token operator">=</span> <span class="token function">GetDC</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        HDC hCDC <span class="token operator">=</span> <span class="token function">CreateCompatibleDC</span><span class="token punctuation">(</span>hDC<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        HBITMAP hBmp <span class="token operator">=</span> <span class="token function">CreateCompatibleBitmap</span><span class="token punctuation">(</span>hDC<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        HBITMAP hBmpOld <span class="token operator">=</span> <span class="token punctuation">(</span>HBITMAP<span class="token punctuation">)</span><span class="token function">SelectObject</span><span class="token punctuation">(</span>hCDC<span class="token punctuation">,</span> hBmp<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">add_transparent_text_to_desktop</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> hDC<span class="token punctuation">,</span> hCDC<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//clean</span></span>
<span class="line">        <span class="token function">DeleteDC</span><span class="token punctuation">(</span>hCDC<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">DeleteObject</span><span class="token punctuation">(</span>hBmp<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">ReleaseDC</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> hDC<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> WM_ERASEBKGND<span class="token operator">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> WM_CLOSE<span class="token operator">:</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> WM_DESTROY<span class="token operator">:</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">PostQuitMessage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token function">DefWindowProc</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> Msg<span class="token punctuation">,</span> wParam<span class="token punctuation">,</span> lParam<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">BOOL <span class="token function">did_rects_collide</span><span class="token punctuation">(</span>RECT word1<span class="token punctuation">,</span> RECT word2<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>word1<span class="token punctuation">.</span>left <span class="token operator">&lt;</span> word2<span class="token punctuation">.</span>right <span class="token operator">&amp;&amp;</span> word1<span class="token punctuation">.</span>right <span class="token operator">&gt;</span> word2<span class="token punctuation">.</span>left <span class="token operator">&amp;&amp;</span> word1<span class="token punctuation">.</span>top <span class="token operator">&lt;</span> word2<span class="token punctuation">.</span>bottom <span class="token operator">&amp;&amp;</span> word1<span class="token punctuation">.</span>bottom <span class="token operator">&gt;</span> word2<span class="token punctuation">.</span>top<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">COLORREF <span class="token function">rainbow_generator</span><span class="token punctuation">(</span><span class="token keyword keyword-int">int</span> index<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">//index must be 0 to 255</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> red<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> grn<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> blu<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> region <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword keyword-int">int</span><span class="token punctuation">)</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>index <span class="token operator">/</span> <span class="token number">255.0</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> chunk <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword keyword-int">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">floor</span><span class="token punctuation">(</span>index <span class="token operator">%</span> <span class="token number">43</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">43</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-switch">switch</span> <span class="token punctuation">(</span>region<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> <span class="token number">0</span><span class="token operator">:</span></span>
<span class="line">        red <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span></span>
<span class="line">        grn <span class="token operator">=</span> chunk<span class="token punctuation">;</span></span>
<span class="line">        blu <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span> <span class="token comment">//red</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> <span class="token number">1</span><span class="token operator">:</span></span>
<span class="line">        red <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">-</span> chunk<span class="token punctuation">;</span></span>
<span class="line">        grn <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span></span>
<span class="line">        blu <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span> <span class="token comment">//yellow</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> <span class="token number">2</span><span class="token operator">:</span></span>
<span class="line">        red <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        grn <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span></span>
<span class="line">        blu <span class="token operator">=</span> chunk<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span> <span class="token comment">//green</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> <span class="token number">3</span><span class="token operator">:</span></span>
<span class="line">        red <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        grn <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">-</span> chunk<span class="token punctuation">;</span></span>
<span class="line">        blu <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span> <span class="token comment">//cyan</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> <span class="token number">4</span><span class="token operator">:</span></span>
<span class="line">        red <span class="token operator">=</span> chunk<span class="token punctuation">;</span></span>
<span class="line">        grn <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        blu <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span> <span class="token comment">//blue</span></span>
<span class="line">    <span class="token keyword keyword-case">case</span> <span class="token number">5</span><span class="token operator">:</span></span>
<span class="line">        red <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span></span>
<span class="line">        grn <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        blu <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">-</span> chunk<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span> <span class="token comment">//magenta</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token function">RGB</span><span class="token punctuation">(</span>red<span class="token punctuation">,</span> grn<span class="token punctuation">,</span> blu<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-void">void</span> <span class="token function">add_transparent_text_to_desktop</span><span class="token punctuation">(</span>HWND <span class="token operator">&amp;</span>hWnd<span class="token punctuation">,</span> HDC <span class="token operator">&amp;</span>hDC<span class="token punctuation">,</span> HDC <span class="token operator">&amp;</span>hCDC<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    RECT rect<span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">GetClientRect</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rect<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> width <span class="token operator">=</span> rect<span class="token punctuation">.</span>right <span class="token operator">-</span> rect<span class="token punctuation">.</span>left<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> height <span class="token operator">=</span> rect<span class="token punctuation">.</span>bottom <span class="token operator">-</span> rect<span class="token punctuation">.</span>top<span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//make font size as 50px</span></span>
<span class="line">    LOGFONT lf<span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">GetObject</span><span class="token punctuation">(</span><span class="token function">GetStockObject</span><span class="token punctuation">(</span>DEFAULT_GUI_FONT<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation">(</span>LOGFONT<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>lf<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    lf<span class="token punctuation">.</span>lfHeight <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span></span>
<span class="line">    HFONT hFont <span class="token operator">=</span> <span class="token function">CreateFontIndirect</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>lf<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//hfont with transparent background &amp; white</span></span>
<span class="line">    HFONT hFontOld <span class="token operator">=</span> <span class="token punctuation">(</span>HFONT<span class="token punctuation">)</span><span class="token function">SelectObject</span><span class="token punctuation">(</span>hCDC<span class="token punctuation">,</span> hFont<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//text must be transparent background. This will only work if there's a blending &amp; UpdateLayeredWindow function below</span></span>
<span class="line">    <span class="token function">SetBkMode</span><span class="token punctuation">(</span>hCDC<span class="token punctuation">,</span> TRANSPARENT<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//text color</span></span>
<span class="line">    <span class="token function">SetTextColor</span><span class="token punctuation">(</span>hCDC<span class="token punctuation">,</span> <span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    vector<span class="token operator">&lt;</span>pair<span class="token operator">&lt;</span>Word <span class="token operator">*</span><span class="token punctuation">,</span> Word <span class="token operator">*</span><span class="token operator">&gt;&gt;</span> collided_pairs_vector<span class="token punctuation">;</span></span>
<span class="line">    vector<span class="token operator">&lt;</span>Word <span class="token operator">*</span><span class="token operator">&gt;</span> words <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">get_words</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// cout &lt;&lt; "words size: " &lt;&lt; words.size() &lt;&lt; endl;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token comment">//Get a random rectangle &amp; use DrawText function (not TextOut). Use the important DT_CALCRECT flag to get the size of the text to be drawn so I can later use the coordinates to detect collisions</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-auto">auto</span> <span class="token operator">&amp;</span>word <span class="token operator">:</span> words<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">//honestly seems the only purpose of this RECT is to later calculate the height &amp; width of the Text Box</span></span>
<span class="line">        RECT word_rect<span class="token punctuation">;</span></span>
<span class="line">        word_rect<span class="token punctuation">.</span>left <span class="token operator">=</span> word<span class="token operator">-&gt;</span>x<span class="token punctuation">;</span></span>
<span class="line">        word_rect<span class="token punctuation">.</span>top <span class="token operator">=</span> word<span class="token operator">-&gt;</span>y<span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//After this call, word_rect will likely have the right &amp; bottom fields filled</span></span>
<span class="line">        <span class="token comment">//Also, this is actually not drawing the text</span></span>
<span class="line">        <span class="token function">DrawText</span><span class="token punctuation">(</span>hCDC<span class="token punctuation">,</span> word<span class="token operator">-&gt;</span>content<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> word<span class="token operator">-&gt;</span>content<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>word_rect<span class="token punctuation">,</span> DT_CALCRECT <span class="token operator">|</span> DT_CENTER <span class="token operator">|</span> DT_VCENTER<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        word<span class="token operator">-&gt;</span>width <span class="token operator">=</span> word_rect<span class="token punctuation">.</span>right <span class="token operator">-</span> word_rect<span class="token punctuation">.</span>left<span class="token punctuation">;</span></span>
<span class="line">        word<span class="token operator">-&gt;</span>height <span class="token operator">=</span> word_rect<span class="token punctuation">.</span>bottom <span class="token operator">-</span> word_rect<span class="token punctuation">.</span>top<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">//Actually draw the text</span></span>
<span class="line">        <span class="token function">SetTextColor</span><span class="token punctuation">(</span>hCDC<span class="token punctuation">,</span> word<span class="token operator">-&gt;</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">DrawText</span><span class="token punctuation">(</span>hCDC<span class="token punctuation">,</span> word<span class="token operator">-&gt;</span>content<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> word<span class="token operator">-&gt;</span>content<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>word_rect<span class="token punctuation">,</span> DT_CENTER <span class="token operator">|</span> DT_VCENTER<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        word<span class="token operator">-&gt;</span>x <span class="token operator">+=</span> word<span class="token operator">-&gt;</span>x_speed<span class="token punctuation">;</span></span>
<span class="line">        word<span class="token operator">-&gt;</span>y <span class="token operator">+=</span> word<span class="token operator">-&gt;</span>y_speed<span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//save the word's rect for collision detection</span></span>
<span class="line">        word<span class="token operator">-&gt;</span>rect <span class="token operator">=</span> word_rect<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">//if word is off screen, move it back to the top</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>word<span class="token operator">-&gt;</span>x <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">            word<span class="token operator">-&gt;</span>x <span class="token operator">=</span> width<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>word<span class="token operator">-&gt;</span>x <span class="token operator">&gt;</span> width<span class="token punctuation">)</span></span>
<span class="line">            word<span class="token operator">-&gt;</span>x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>word<span class="token operator">-&gt;</span>y <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">            word<span class="token operator">-&gt;</span>y <span class="token operator">=</span> height<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>word<span class="token operator">-&gt;</span>y <span class="token operator">&gt;</span> height<span class="token punctuation">)</span></span>
<span class="line">            word<span class="token operator">-&gt;</span>y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">// collision detection</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-auto">auto</span> <span class="token operator">&amp;</span>word2 <span class="token operator">:</span> words<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>word <span class="token operator">!=</span> word2<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">did_rects_collide</span><span class="token punctuation">(</span>word_rect<span class="token punctuation">,</span> word2<span class="token operator">-&gt;</span>rect<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token comment">//only add the pair IF the reverse pair flipped is NOT already in the collided_pairs_vector</span></span>
<span class="line">                    pair<span class="token operator">&lt;</span>Word <span class="token operator">*</span><span class="token punctuation">,</span> Word <span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token function">reversed_pair</span><span class="token punctuation">(</span>word2<span class="token punctuation">,</span> word<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token comment">//if the reversed pair does NOT exist in the collided_pairs_vector</span></span>
<span class="line">                    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">find</span><span class="token punctuation">(</span>collided_pairs_vector<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> collided_pairs_vector<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> reversed_pair<span class="token punctuation">)</span> <span class="token operator">==</span> collided_pairs_vector<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">{</span></span>
<span class="line">                        collided_pairs_vector<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">make_pair</span><span class="token punctuation">(</span>word<span class="token punctuation">,</span> word2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token comment">//DEBUG</span></span>
<span class="line">    <span class="token comment">// int cps = collided_pairs_vector.size();</span></span>
<span class="line">    <span class="token comment">// if(cps &gt; 0)</span></span>
<span class="line">    <span class="token comment">// {</span></span>
<span class="line">    <span class="token comment">//     for (auto &amp;collided_pair : collided_pairs_vector)</span></span>
<span class="line">    <span class="token comment">//     {</span></span>
<span class="line">    <span class="token comment">//         cout &lt;&lt; "collided pairs: ";</span></span>
<span class="line">    <span class="token comment">//         for (auto &amp;inner_collided_pair : collided_pairs_vector)</span></span>
<span class="line">    <span class="token comment">//         {</span></span>
<span class="line">    <span class="token comment">//             cout &lt;&lt; inner_collided_pair.first-&gt;content &lt;&lt; " " &lt;&lt; inner_collided_pair.second-&gt;content &lt;&lt; "     ";</span></span>
<span class="line">    <span class="token comment">//         }</span></span>
<span class="line">    <span class="token comment">//         cout &lt;&lt; endl;</span></span>
<span class="line">    <span class="token comment">//     }</span></span>
<span class="line">    <span class="token comment">// }</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-int">int</span> distance <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//remove the pairs</span></span>
<span class="line">    <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token keyword keyword-auto">auto</span> <span class="token operator">&amp;</span>collided_pair <span class="token operator">:</span> collided_pairs_vector<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">&nbsp;</span>
<span class="line">        Word <span class="token operator">*</span>word1 <span class="token operator">=</span> collided_pair<span class="token punctuation">.</span>first<span class="token punctuation">;</span></span>
<span class="line">        Word <span class="token operator">*</span>word2 <span class="token operator">=</span> collided_pair<span class="token punctuation">.</span>second<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token keyword keyword-int">int</span> word1_left <span class="token operator">=</span> word1<span class="token operator">-&gt;</span>rect<span class="token punctuation">.</span>left<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> word1_top <span class="token operator">=</span> word1<span class="token operator">-&gt;</span>rect<span class="token punctuation">.</span>top<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> word1_right <span class="token operator">=</span> word1<span class="token operator">-&gt;</span>rect<span class="token punctuation">.</span>right<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> word1_bottom <span class="token operator">=</span> word1<span class="token operator">-&gt;</span>rect<span class="token punctuation">.</span>bottom<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token keyword keyword-int">int</span> word2_left <span class="token operator">=</span> word2<span class="token operator">-&gt;</span>rect<span class="token punctuation">.</span>left<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> word2_top <span class="token operator">=</span> word2<span class="token operator">-&gt;</span>rect<span class="token punctuation">.</span>top<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> word2_right <span class="token operator">=</span> word2<span class="token operator">-&gt;</span>rect<span class="token punctuation">.</span>right<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> word2_bottom <span class="token operator">=</span> word2<span class="token operator">-&gt;</span>rect<span class="token punctuation">.</span>bottom<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token keyword keyword-int">int</span> x_diff <span class="token operator">=</span> word1_left <span class="token operator">-</span> word2_right<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> y_diff <span class="token operator">=</span> word1_top <span class="token operator">-</span> word2_bottom<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token keyword keyword-int">int</span> word1_xspeed <span class="token operator">=</span> word1<span class="token operator">-&gt;</span>x_speed<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> word1_yspeed <span class="token operator">=</span> word1<span class="token operator">-&gt;</span>y_speed<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> word2_xspeed <span class="token operator">=</span> word2<span class="token operator">-&gt;</span>x_speed<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> word2_yspeed <span class="token operator">=</span> word2<span class="token operator">-&gt;</span>y_speed<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token keyword keyword-int">int</span> margin <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//higher the dampening, the more the distance</span></span>
<span class="line">        <span class="token keyword keyword-float">float</span> dampen_difference <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> distance_between_words_to_turn <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token keyword keyword-int">int</span> move_distance_x <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>x_diff <span class="token operator">*</span> dampen_difference<span class="token punctuation">)</span> <span class="token operator">+</span> margin<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-int">int</span> move_distance_y <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>y_diff <span class="token operator">*</span> dampen_difference<span class="token punctuation">)</span> <span class="token operator">+</span> margin<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">//get the dragged word between word1 &amp; word2</span></span>
<span class="line">        Word <span class="token operator">*</span>dragged_word<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>word1<span class="token operator">-&gt;</span>currently_dragging <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            dragged_word <span class="token operator">=</span> word1<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>word2<span class="token operator">-&gt;</span>currently_dragging <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            dragged_word <span class="token operator">=</span> word2<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-else">else</span></span>
<span class="line">            dragged_word <span class="token operator">=</span> <span class="token keyword keyword-nullptr">nullptr</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        word1<span class="token operator">-&gt;</span>x <span class="token operator">=</span> word1<span class="token operator">-&gt;</span>x <span class="token operator">+</span> move_distance_x<span class="token punctuation">;</span></span>
<span class="line">        word2<span class="token operator">-&gt;</span>x <span class="token operator">=</span> word2<span class="token operator">-&gt;</span>x <span class="token operator">-</span> move_distance_x<span class="token punctuation">;</span></span>
<span class="line">        word1<span class="token operator">-&gt;</span>y <span class="token operator">=</span> word1<span class="token operator">-&gt;</span>y <span class="token operator">+</span> move_distance_y<span class="token punctuation">;</span></span>
<span class="line">        word2<span class="token operator">-&gt;</span>y <span class="token operator">=</span> word2<span class="token operator">-&gt;</span>y <span class="token operator">-</span> move_distance_y<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token keyword keyword-double">double</span> angle_of_collided_words <span class="token operator">=</span> <span class="token function">atan2</span><span class="token punctuation">(</span>y_diff<span class="token punctuation">,</span> x_diff<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-double">double</span> angle_of_word1 <span class="token operator">=</span> <span class="token function">atan2</span><span class="token punctuation">(</span>word1_yspeed<span class="token punctuation">,</span> word1_xspeed<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-double">double</span> angle_of_word2 <span class="token operator">=</span> <span class="token function">atan2</span><span class="token punctuation">(</span>word2_yspeed<span class="token punctuation">,</span> word2_xspeed<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-double">double</span> angle_difference <span class="token operator">=</span> <span class="token function">atan2</span><span class="token punctuation">(</span>y_diff<span class="token punctuation">,</span> x_diff<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">atan2</span><span class="token punctuation">(</span>word1_yspeed<span class="token punctuation">,</span> word1_xspeed<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-double">double</span> angle_difference2 <span class="token operator">=</span> <span class="token function">atan2</span><span class="token punctuation">(</span>y_diff<span class="token punctuation">,</span> x_diff<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">atan2</span><span class="token punctuation">(</span>word2_yspeed<span class="token punctuation">,</span> word2_xspeed<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-double">double</span> angle_difference_to_turn <span class="token operator">=</span> angle_difference <span class="token operator">/</span> distance_between_words_to_turn<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-double">double</span> angle_difference_to_turn2 <span class="token operator">=</span> angle_difference2 <span class="token operator">/</span> distance_between_words_to_turn<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-double">double</span> new_angle_of_word1 <span class="token operator">=</span> angle_of_word1 <span class="token operator">+</span> angle_difference_to_turn<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-double">double</span> new_angle_of_word2 <span class="token operator">=</span> angle_of_word2 <span class="token operator">-</span> angle_difference_to_turn2<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">// cout &lt;&lt; "angle of word 1: " &lt;&lt; angle_of_word1 &lt;&lt; " angle of word 2: " &lt;&lt; angle_of_word2 &lt;&lt; " angle difference: " &lt;&lt; angle_difference &lt;&lt; " angle difference2: " &lt;&lt; angle_difference2 &lt;&lt; " angle difference to turn: " &lt;&lt; angle_difference_to_turn &lt;&lt; " angle difference to turn2: " &lt;&lt; angle_difference_to_turn2 &lt;&lt; " new angle of word 1: " &lt;&lt; new_angle_of_word1 &lt;&lt; " new angle of word 2: " &lt;&lt; new_angle_of_word2 &lt;&lt; endl;</span></span>
<span class="line">        <span class="token comment">// cout &lt;&lt; '-----------' &lt;&lt; endl;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        word1<span class="token operator">-&gt;</span>x_speed <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">cos</span><span class="token punctuation">(</span>new_angle_of_word1<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">cos</span><span class="token punctuation">(</span>new_angle_of_word1<span class="token punctuation">)</span> <span class="token operator">*</span> moving_speed <span class="token operator">:</span> <span class="token function">cos</span><span class="token punctuation">(</span>new_angle_of_word1<span class="token punctuation">)</span> <span class="token operator">*</span> moving_speed<span class="token punctuation">;</span></span>
<span class="line">        word1<span class="token operator">-&gt;</span>y_speed <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">sin</span><span class="token punctuation">(</span>new_angle_of_word1<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">sin</span><span class="token punctuation">(</span>new_angle_of_word1<span class="token punctuation">)</span> <span class="token operator">*</span> moving_speed <span class="token operator">:</span> <span class="token function">sin</span><span class="token punctuation">(</span>new_angle_of_word1<span class="token punctuation">)</span> <span class="token operator">*</span> moving_speed<span class="token punctuation">;</span></span>
<span class="line">        word2<span class="token operator">-&gt;</span>x_speed <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">cos</span><span class="token punctuation">(</span>new_angle_of_word2<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">cos</span><span class="token punctuation">(</span>new_angle_of_word2<span class="token punctuation">)</span> <span class="token operator">*</span> moving_speed <span class="token operator">:</span> <span class="token function">cos</span><span class="token punctuation">(</span>new_angle_of_word2<span class="token punctuation">)</span> <span class="token operator">*</span> moving_speed<span class="token punctuation">;</span></span>
<span class="line">        word2<span class="token operator">-&gt;</span>y_speed <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">sin</span><span class="token punctuation">(</span>new_angle_of_word2<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">sin</span><span class="token punctuation">(</span>new_angle_of_word2<span class="token punctuation">)</span> <span class="token operator">*</span> moving_speed <span class="token operator">:</span> <span class="token function">sin</span><span class="token punctuation">(</span>new_angle_of_word2<span class="token punctuation">)</span> <span class="token operator">*</span> moving_speed<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">// If the word is currently being dragged, then we need to NOT move it</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">//change the direction</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span>move_distance_x<span class="token punctuation">,</span> move_distance_y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> distance_between_words_to_turn<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">//if approaching in opposite directions in X</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word1_xspeed <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> word2_xspeed <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>word1_xspeed <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> word2_xspeed <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                word1<span class="token operator">-&gt;</span>x_speed <span class="token operator">=</span> word1<span class="token operator">-&gt;</span>x_speed<span class="token punctuation">;</span></span>
<span class="line">                word2<span class="token operator">-&gt;</span>x_speed <span class="token operator">=</span> word2<span class="token operator">-&gt;</span>x_speed<span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token comment">//if approaching in opposite directions in Y</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word1_yspeed <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> word2_yspeed <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>word1_yspeed <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> word2_yspeed <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                word1<span class="token operator">-&gt;</span>y_speed <span class="token operator">=</span> word1<span class="token operator">-&gt;</span>y_speed<span class="token punctuation">;</span></span>
<span class="line">                word2<span class="token operator">-&gt;</span>y_speed <span class="token operator">=</span> word2<span class="token operator">-&gt;</span>y_speed<span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token keyword keyword-int">int</span> placeholder<span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">//if approaching in same direction in X</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word1_xspeed <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> word2_xspeed <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>word1_xspeed <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> word2_xspeed <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                placeholder <span class="token operator">=</span> word1_xspeed<span class="token punctuation">;</span></span>
<span class="line">                word1<span class="token operator">-&gt;</span>x_speed <span class="token operator">=</span> word2_xspeed<span class="token punctuation">;</span></span>
<span class="line">                word2<span class="token operator">-&gt;</span>x_speed <span class="token operator">=</span> placeholder<span class="token punctuation">;</span></span>
<span class="line">                <span class="token comment">// word1-&gt;x_speed = -word1_xspeed;</span></span>
<span class="line">                <span class="token comment">// word2-&gt;x_speed = -word2_xspeed;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token comment">//if approaching in same direction in Y</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word1_yspeed <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> word2_yspeed <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>word1_yspeed <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> word2_yspeed <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                placeholder <span class="token operator">=</span> <span class="token function">abs</span><span class="token punctuation">(</span>word1_yspeed<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                word1<span class="token operator">-&gt;</span>y_speed <span class="token operator">=</span> <span class="token function">abs</span><span class="token punctuation">(</span>word2_yspeed<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                word2<span class="token operator">-&gt;</span>y_speed <span class="token operator">=</span> placeholder<span class="token punctuation">;</span></span>
<span class="line">                <span class="token comment">// word1-&gt;y_speed = -word1-&gt;y_speed;</span></span>
<span class="line">                <span class="token comment">// word2-&gt;y_speed = -word2-&gt;y_speed;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">//the word that's dragging doesn't move</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>dragged_word <span class="token operator">==</span> word1<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            cout <span class="token operator">&lt;&lt;</span> dragged_word<span class="token operator">-&gt;</span>content <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">            word1<span class="token operator">-&gt;</span>x <span class="token operator">=</span> word1_left<span class="token punctuation">;</span></span>
<span class="line">            word1<span class="token operator">-&gt;</span>y <span class="token operator">=</span> word1_top<span class="token punctuation">;</span></span>
<span class="line">            word1<span class="token operator">-&gt;</span>x_speed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">            word1<span class="token operator">-&gt;</span>y_speed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-else">else</span> <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>dragged_word <span class="token operator">==</span> word2<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            cout <span class="token operator">&lt;&lt;</span> dragged_word<span class="token operator">-&gt;</span>content <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></span>
<span class="line">            word2<span class="token operator">-&gt;</span>x <span class="token operator">=</span> word2_left<span class="token punctuation">;</span></span>
<span class="line">            word2<span class="token operator">-&gt;</span>y <span class="token operator">=</span> word2_top<span class="token punctuation">;</span></span>
<span class="line">            word2<span class="token operator">-&gt;</span>x_speed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">            word2<span class="token operator">-&gt;</span>y_speed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token comment">// Call UpdateLayeredWindow</span></span>
<span class="line">    BLENDFUNCTION blend <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    blend<span class="token punctuation">.</span>BlendOp <span class="token operator">=</span> AC_SRC_OVER<span class="token punctuation">;</span></span>
<span class="line">    blend<span class="token punctuation">.</span>SourceConstantAlpha <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span></span>
<span class="line">    blend<span class="token punctuation">.</span>AlphaFormat <span class="token operator">=</span> AC_SRC_ALPHA<span class="token punctuation">;</span></span>
<span class="line">    SIZE sizeWnd <span class="token operator">=</span> <span class="token punctuation">{</span>width<span class="token punctuation">,</span> height<span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//ptpox &amp; ptsrc in the center</span></span>
<span class="line">    POINT ptPos <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token function">GetSystemMetrics</span><span class="token punctuation">(</span>SM_CXSCREEN<span class="token punctuation">)</span> <span class="token operator">-</span> width<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token function">GetSystemMetrics</span><span class="token punctuation">(</span>SM_CYSCREEN<span class="token punctuation">)</span> <span class="token operator">-</span> height<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    POINT ptSrc <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">UpdateLayeredWindow</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> hDC<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ptPos<span class="token punctuation">,</span> <span class="token operator">&amp;</span>sizeWnd<span class="token punctuation">,</span> hCDC<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ptSrc<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>blend<span class="token punctuation">,</span> ULW_ALPHA<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-int">int</span> APIENTRY <span class="token function">WinMain</span><span class="token punctuation">(</span>HINSTANCE hInstance<span class="token punctuation">,</span> HINSTANCE hPrev<span class="token punctuation">,</span> LPSTR lpCmdLine<span class="token punctuation">,</span> <span class="token keyword keyword-int">int</span> nShowCmd<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> screen_width <span class="token operator">=</span> <span class="token function">GetSystemMetrics</span><span class="token punctuation">(</span>SM_CXSCREEN<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">        screen_height <span class="token operator">=</span> <span class="token function">GetSystemMetrics</span><span class="token punctuation">(</span>SM_CYSCREEN<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> padding <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> left_padding <span class="token operator">=</span> padding<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> top_padding <span class="token operator">=</span> padding<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> right_padding <span class="token operator">=</span> padding<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-int">int</span> bottom_padding <span class="token operator">=</span> padding<span class="token punctuation">;</span></span>
<span class="line">    pop_up_width <span class="token operator">=</span> screen_width<span class="token punctuation">;</span></span>
<span class="line">    pop_up_height <span class="token operator">=</span> screen_height<span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// pop_up_width = 400;</span></span>
<span class="line">    <span class="token comment">// pop_up_height = 400;</span></span>
<span class="line">    WNDCLASSEX wc<span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>cbSize <span class="token operator">=</span> <span class="token keyword keyword-sizeof">sizeof</span><span class="token punctuation">(</span>WNDCLASSEX<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>lpfnWndProc <span class="token operator">=</span> WndProc<span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>cbClsExtra <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>cbWndExtra <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hInstance <span class="token operator">=</span> hInstance<span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hIcon <span class="token operator">=</span> <span class="token function">LoadIcon</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> IDI_APPLICATION<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hCursor <span class="token operator">=</span> <span class="token function">LoadCursor</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> IDC_ARROW<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//blue brush background</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hbrBackground <span class="token operator">=</span> <span class="token punctuation">(</span>HBRUSH<span class="token punctuation">)</span><span class="token function">CreateSolidBrush</span><span class="token punctuation">(</span><span class="token function">RGB</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">222</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>lpszMenuName <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>lpszClassName <span class="token operator">=</span> <span class="token string">"popup_process"</span><span class="token punctuation">;</span></span>
<span class="line">    wc<span class="token punctuation">.</span>hIconSm <span class="token operator">=</span> <span class="token function">LoadIcon</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> IDI_APPLICATION<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">RegisterClassEx</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>wc<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"Window Registration Failed!"</span><span class="token punctuation">,</span> <span class="token string">"Error!"</span><span class="token punctuation">,</span></span>
<span class="line">                   MB_ICONEXCLAMATION <span class="token operator">|</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">// make a transparent window</span></span>
<span class="line">    HWND hwnd <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span>WS_EX_LAYERED <span class="token operator">|</span> WS_EX_TOPMOST<span class="token punctuation">,</span></span>
<span class="line">                               <span class="token string">"popup_process"</span><span class="token punctuation">,</span></span>
<span class="line">                               <span class="token string">"popup_process"</span><span class="token punctuation">,</span></span>
<span class="line">                               WS_POPUP<span class="token punctuation">,</span></span>
<span class="line">                               left_padding<span class="token punctuation">,</span></span>
<span class="line">                               top_padding<span class="token punctuation">,</span></span>
<span class="line">                               pop_up_width<span class="token punctuation">,</span></span>
<span class="line">                               pop_up_height<span class="token punctuation">,</span></span>
<span class="line">                               <span class="token constant">NULL</span><span class="token punctuation">,</span></span>
<span class="line">                               <span class="token constant">NULL</span><span class="token punctuation">,</span></span>
<span class="line">                               hInstance<span class="token punctuation">,</span></span>
<span class="line">                               <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//make a transparent window</span></span>
<span class="line">    hwnd <span class="token operator">=</span> <span class="token function">CreateWindowEx</span><span class="token punctuation">(</span>WS_EX_TOPMOST <span class="token operator">|</span> WS_EX_LAYERED<span class="token punctuation">,</span> <span class="token string">"popup_process"</span><span class="token punctuation">,</span> <span class="token string">"popup_process"</span><span class="token punctuation">,</span> WS_POPUP<span class="token punctuation">,</span> screen_width <span class="token operator">-</span> pop_up_width <span class="token operator">-</span> right_padding<span class="token punctuation">,</span> screen_height <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> pop_up_height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> pop_up_width<span class="token punctuation">,</span> pop_up_height<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> hInstance<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    HHOOK mouseHookHdl <span class="token operator">=</span> <span class="token function">SetWindowsHookEx</span><span class="token punctuation">(</span>WH_MOUSE_LL<span class="token punctuation">,</span> MouseProc<span class="token punctuation">,</span> hInstance<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>mouseHookHdl <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"SetWindowsHookEx for MouseProc failed!"</span><span class="token punctuation">,</span> <span class="token string">"Error!"</span><span class="token punctuation">,</span> MB_ICONEXCLAMATION <span class="token operator">|</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token function">ShowWindow</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> nShowCmd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">UpdateWindow</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//work with transparency</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>hwnd<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token function">MessageBox</span><span class="token punctuation">(</span>HWND_DESKTOP<span class="token punctuation">,</span> <span class="token string">"Cannot create window!"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> MB_ICONERROR <span class="token operator">|</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    MSG Msg <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//show &amp; update window</span></span>
<span class="line">    <span class="token function">ShowWindow</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> nShowCmd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">UpdateWindow</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//run timer every second infiniteyl</span></span>
<span class="line">    <span class="token function">SetTimer</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> milliseconds_between_frames<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span>Msg<span class="token punctuation">.</span>message <span class="token operator">!=</span> WM_QUIT<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">PeekMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Msg<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> PM_REMOVE<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">TranslateMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Msg<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token function">DispatchMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Msg<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span>VK_ESCAPE<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x8000</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token function">DestroyWindow</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Uforia Alexa Skill to guess numbers</div>
                <div class="description">Number Guessing Alexa Skill for a gaming company with amazing entrepreneur, which was ranked in top 100 on Amazon. Sound clips stored remotely when I should have used S3.</div>
                <div class="languages">Python</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-python" tabindex="0">                <code class="language-python"><span class="line"><span class="token keyword keyword-import">import</span> os<span class="token punctuation">,</span> sys</span>
<span class="line"><span class="token keyword keyword-from">from</span> random <span class="token keyword keyword-import">import</span> randrange</span>
<span class="line"><span class="token keyword keyword-import">import</span> boto3</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">lambda_handler</span></span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment">#FORCED TO HAVE PROGRAM FLOW witih Try &amp; Catch BECAUSE OF A GLITCH IN AMAZON ECHO DEVICE vs Alexa Service Simulator</span></span>
<span class="line">        <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">            response_session_attributes <span class="token operator">=</span> event<span class="token punctuation">[</span><span class="token string">"session"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"attributes"</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">            response_session_attributes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'debug'</span><span class="token punctuation">:</span><span class="token string">'problem'</span><span class="token punctuation">}</span></span>
<span class="line">            </span>
<span class="line">        is_playing <span class="token operator">=</span> get_session_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'playing'</span><span class="token punctuation">)</span></span>
<span class="line">        is_game_over <span class="token operator">=</span> get_session_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'game_over'</span><span class="token punctuation">)</span></span>
<span class="line">        is_playing <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>is_playing<span class="token punctuation">)</span> <span class="token keyword keyword-if">if</span> is_playing <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">None</span> <span class="token keyword keyword-else">else</span> <span class="token number">0</span></span>
<span class="line">        is_game_over <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>is_game_over<span class="token punctuation">)</span> <span class="token keyword keyword-if">if</span> is_game_over <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">None</span> <span class="token keyword keyword-else">else</span> <span class="token number">0</span></span>
<span class="line">        </span>
<span class="line">        one_second_break <span class="token operator">=</span> <span class="token string">'&lt;break time="1000ms"/&gt;'</span></span>
<span class="line">        half_second_break <span class="token operator">=</span> <span class="token string">'&lt;break time="500ms"/&gt;'</span></span>
<span class="line">  </span>
<span class="line">        <span class="token comment"># s3 = boto3.client("s3")</span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment">#AUDIO FILES#</span></span>
<span class="line">        audio_1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'bd_countdown'</span><span class="token punctuation">,</span><span class="token string">'1_game_bd_countdown_48k.mp3'</span><span class="token punctuation">,</span><span class="token string">'https://a.clyp.it/hzvpcfai.mp3'</span><span class="token punctuation">)</span></span>
<span class="line">        audio_2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'bd_intro'</span><span class="token punctuation">,</span><span class="token string">'2_game_bd_intro_48k.mp3'</span><span class="token punctuation">,</span><span class="token string">'https://a.clyp.it/berksyah.mp3'</span><span class="token punctuation">)</span></span>
<span class="line">        audio_3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'bd_win_1'</span><span class="token punctuation">,</span><span class="token string">'3_game_bd_win1_48k.mp3'</span><span class="token punctuation">,</span><span class="token string">'https://a.clyp.it/dmno3wxu.mp3'</span><span class="token punctuation">)</span></span>
<span class="line">        audio_4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'bd_hard'</span><span class="token punctuation">,</span><span class="token string">'4_game_bd_hard_48k.mp3'</span><span class="token punctuation">,</span><span class="token string">'https://a.clyp.it/itskfkr3.mp3'</span><span class="token punctuation">)</span></span>
<span class="line">        audio_5 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'bd_medium'</span><span class="token punctuation">,</span><span class="token string">'5_game_bd_medium_48k.mp3'</span><span class="token punctuation">,</span><span class="token string">'https://a.clyp.it/hmmoie01.mp3'</span><span class="token punctuation">)</span></span>
<span class="line">        audio_6 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'bd_win_2'</span><span class="token punctuation">,</span><span class="token string">'6_game_bd_win_48k.mp3'</span><span class="token punctuation">,</span><span class="token string">'https://a.clyp.it/1eozk1qj.mp3'</span><span class="token punctuation">)</span></span>
<span class="line">        audio_7 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'bd_instructions'</span><span class="token punctuation">,</span><span class="token string">'7_game_bd_instructions_48k.mp3'</span><span class="token punctuation">,</span><span class="token string">'https://a.clyp.it/sstiscoz.mp3'</span><span class="token punctuation">)</span></span>
<span class="line">        audio_8 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'bd_easy'</span><span class="token punctuation">,</span><span class="token string">'8_game_bd_easy_48k.mp3'</span><span class="token punctuation">,</span><span class="token string">'https://a.clyp.it/2dw3nt21.mp3'</span><span class="token punctuation">)</span></span>
<span class="line">        audio_9 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'bd_lose'</span><span class="token punctuation">,</span><span class="token string">'9_game_bd_lose_48k.mp3'</span><span class="token punctuation">,</span><span class="token string">'https://a.clyp.it/odikfqdd.mp3'</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment">#END AUDIO FILES#</span></span>
<span class="line">        </span>
<span class="line">        </span>
<span class="line">        <span class="token comment">#PLAY AGAIN#</span></span>
<span class="line">        <span class="token comment">#</span></span>
<span class="line">        <span class="token comment">#   Note: Reason for a state design pattern is for things just like this!</span></span>
<span class="line">        <span class="token comment">#</span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment">#END PLAY AGAIN#</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token keyword keyword-if">if</span> event<span class="token punctuation">[</span><span class="token string">"request"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"type"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"LaunchRequest"</span><span class="token punctuation">:</span></span>
<span class="line">            response_session_attributes<span class="token punctuation">[</span><span class="token string">'playing'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span>generate_audio_tag<span class="token punctuation">(</span>audio_2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-elif">elif</span> event<span class="token punctuation">[</span><span class="token string">"request"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"type"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"IntentRequest"</span><span class="token punctuation">:</span></span>
<span class="line">            intent_name <span class="token operator">=</span> event<span class="token punctuation">[</span><span class="token string">"request"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"intent"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span></span>
<span class="line">            <span class="token comment">#SATISFIES #2 of Amazon requirements (2017-03-23)</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> intent_name <span class="token operator">==</span> <span class="token string">"AMAZON.CancelIntent"</span> <span class="token keyword keyword-or">or</span> intent_name <span class="token operator">==</span> <span class="token string">"AMAZON.StopIntent"</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">'Thank you for using Bomb Defuse. See you next time!'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token comment">#menu</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> is_playing <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token comment">#choose level section</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> intent_name <span class="token operator">==</span> <span class="token string">"ChooseLevelIntent"</span><span class="token punctuation">:</span></span>
<span class="line">                    <span class="token keyword keyword-if">if</span> is_playing <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></span>
<span class="line">                        <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">"You are already playing"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">                    chosen_level <span class="token operator">=</span> get_slot_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'level'</span><span class="token punctuation">)</span></span>
<span class="line">                    tries_left <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">                    </span>
<span class="line">                    <span class="token keyword keyword-if">if</span> chosen_level <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">False</span><span class="token punctuation">:</span></span>
<span class="line">                        <span class="token keyword keyword-if">if</span> chosen_level <span class="token operator">==</span> <span class="token string">'easy'</span><span class="token punctuation">:</span></span>
<span class="line">                            tries_left <span class="token operator">=</span> <span class="token number">10</span></span>
<span class="line">                            response <span class="token operator">=</span> generate_audio_tag<span class="token punctuation">(</span>audio_8<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span> one_second_break</span>
<span class="line">                        <span class="token keyword keyword-elif">elif</span> chosen_level <span class="token operator">==</span> <span class="token string">'medium'</span><span class="token punctuation">:</span></span>
<span class="line">                            tries_left <span class="token operator">=</span> <span class="token number">9</span></span>
<span class="line">                            response <span class="token operator">=</span> generate_audio_tag<span class="token punctuation">(</span>audio_5<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span> one_second_break</span>
<span class="line">                        <span class="token keyword keyword-elif">elif</span> chosen_level <span class="token operator">==</span> <span class="token string">'hard'</span><span class="token punctuation">:</span></span>
<span class="line">                            tries_left <span class="token operator">=</span> <span class="token number">8</span></span>
<span class="line">                            response <span class="token operator">=</span> generate_audio_tag<span class="token punctuation">(</span>audio_4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span> one_second_break</span>
<span class="line">                        <span class="token keyword keyword-elif">elif</span> chosen_level <span class="token operator">==</span> <span class="token string">'testing'</span><span class="token punctuation">:</span></span>
<span class="line">                            tries_left <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line">                            response <span class="token operator">=</span> <span class="token string">"testing"</span> <span class="token operator">+</span> one_second_break</span>
<span class="line">                        <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">                            <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">"Please Choose Level between Easy, Medium or Hard"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token comment">#this is where the game really starts. It starts when level is chosen (so far)</span></span>
<span class="line">                    response_session_attributes<span class="token punctuation">[</span><span class="token string">'tries_left'</span><span class="token punctuation">]</span> <span class="token operator">=</span> tries_left</span>
<span class="line">                    response_session_attributes<span class="token punctuation">[</span><span class="token string">'playing'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line">                    maximum_number <span class="token operator">=</span> <span class="token number">1000</span></span>
<span class="line">                    response_session_attributes<span class="token punctuation">[</span><span class="token string">'maximum_number'</span><span class="token punctuation">]</span> <span class="token operator">=</span> maximum_number</span>
<span class="line">                    response_session_attributes<span class="token punctuation">[</span><span class="token string">'correct_number'</span><span class="token punctuation">]</span> <span class="token operator">=</span> randrange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>maximum_number <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">                    response <span class="token operator">+=</span> <span class="token string">"Guess a number between 1 and 1000. You have %s chances"</span> <span class="token operator">%</span> tries_left</span>
<span class="line">                    <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">                    <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">"Please choose level among Easy, Medium or Hard!"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">            <span class="token comment">#we are currently playing now</span></span>
<span class="line">            <span class="token keyword keyword-elif">elif</span> is_playing <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token comment">#power up section</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> intent_name <span class="token operator">==</span> <span class="token string">"PowerUpIntent"</span><span class="token punctuation">:</span></span>
<span class="line">                    maximum_number <span class="token operator">=</span> get_session_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'maximum_number'</span><span class="token punctuation">)</span></span>
<span class="line">                    chosen_powerup <span class="token operator">=</span> get_slot_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'powerup_type'</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token keyword keyword-if">if</span> chosen_powerup <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">False</span><span class="token punctuation">:</span></span>
<span class="line">                        <span class="token keyword keyword-if">if</span> chosen_powerup <span class="token operator">==</span> <span class="token string">'yellow'</span><span class="token punctuation">:</span></span>
<span class="line">                            maximum_number <span class="token operator">-=</span> <span class="token number">10</span></span>
<span class="line">                        <span class="token keyword keyword-if">if</span> chosen_powerup <span class="token operator">==</span> <span class="token string">'blue'</span><span class="token punctuation">:</span></span>
<span class="line">                            maximum_number <span class="token operator">-=</span> <span class="token number">50</span></span>
<span class="line">                        <span class="token keyword keyword-if">if</span> chosen_powerup <span class="token operator">==</span> <span class="token string">'red'</span><span class="token punctuation">:</span></span>
<span class="line">                            maximum_number <span class="token operator">-=</span> <span class="token number">100</span></span>
<span class="line">                        <span class="token keyword keyword-if">if</span> chosen_powerup <span class="token operator">==</span> <span class="token string">'ultimate'</span><span class="token punctuation">:</span></span>
<span class="line">                            maximum_number <span class="token operator">-=</span> <span class="token number">500</span></span>
<span class="line">                        response_session_attributes<span class="token punctuation">[</span><span class="token string">'maximum_number'</span><span class="token punctuation">]</span> <span class="token operator">=</span> maximum_number</span>
<span class="line">                        <span class="token comment">#the "correct number" changes when there is a powerup</span></span>
<span class="line">                        response_session_attributes<span class="token punctuation">[</span><span class="token string">'correct_number'</span><span class="token punctuation">]</span> <span class="token operator">=</span> randrange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>maximum_number <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">                    response <span class="token operator">=</span> <span class="token string">"%s %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>maximum_number<span class="token punctuation">,</span> chosen_powerup<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-elif">elif</span> intent_name <span class="token operator">==</span> <span class="token string">"TryIntent"</span><span class="token punctuation">:</span></span>
<span class="line">                    correct_number <span class="token operator">=</span> get_session_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'correct_number'</span><span class="token punctuation">)</span></span>
<span class="line">                    correct_number <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>correct_number<span class="token punctuation">)</span> <span class="token keyword keyword-if">if</span> correct_number <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">None</span> <span class="token keyword keyword-else">else</span> <span class="token operator">-</span><span class="token number">1</span></span>
<span class="line">                    tries_left <span class="token operator">=</span> get_session_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'tries_left'</span><span class="token punctuation">)</span></span>
<span class="line">                    chosen_number <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>get_slot_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'chosen_number'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token comment">#between 1 and 1000?</span></span>
<span class="line">                    <span class="token keyword keyword-if">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>chosen_number<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token keyword keyword-and">and</span> <span class="token builtin">int</span><span class="token punctuation">(</span>chosen_number<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">1000</span><span class="token punctuation">:</span></span>
<span class="line">                        tries_left <span class="token operator">-=</span> <span class="token number">1</span></span>
<span class="line">                        word <span class="token operator">=</span> <span class="token string">"tries"</span> <span class="token keyword keyword-if">if</span> tries_left <span class="token operator">!=</span> <span class="token number">1</span> <span class="token keyword keyword-else">else</span> <span class="token string">"try"</span></span>
<span class="line">                        response_session_attributes<span class="token punctuation">[</span><span class="token string">'tries_left'</span><span class="token punctuation">]</span> <span class="token operator">=</span> tries_left</span>
<span class="line">                    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">                        <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">"You said %s. Please pick a number between 1 and 1000"</span> <span class="token operator">%</span> chosen_number<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">                    </span>
<span class="line">                    <span class="token keyword keyword-if">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>correct_number<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">int</span><span class="token punctuation">(</span>chosen_number<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">                        response <span class="token operator">=</span> generate_audio_tag<span class="token punctuation">(</span>audio_6<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span> half_second_break <span class="token operator">+</span> <span class="token string">"Do you want to play again?"</span></span>
<span class="line">                        card_text <span class="token operator">=</span> <span class="token string">"Congratulations! You won! The correct number was %s"</span> <span class="token operator">%</span> correct_number</span>
<span class="line">                        response_session_attributes<span class="token punctuation">[</span><span class="token string">'game_over'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line">                        <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span>response<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">,</span> card_text<span class="token operator">=</span>card_text<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token keyword keyword-elif">elif</span> <span class="token builtin">int</span><span class="token punctuation">(</span>tries_left<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">                        response <span class="token operator">=</span> generate_audio_tag<span class="token punctuation">(</span>audio_9<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token string">"The correct number is %s"</span> <span class="token operator">%</span> correct_number <span class="token operator">+</span> half_second_break <span class="token operator">+</span> <span class="token string">"Do you want to play again?"</span></span>
<span class="line">                        card_text <span class="token operator">=</span> <span class="token string">"Game over. The correct number was %s"</span> <span class="token operator">%</span> correct_number</span>
<span class="line">                        response_session_attributes<span class="token punctuation">[</span><span class="token string">'game_over'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line">                        <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span>response<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">,</span> card_text<span class="token operator">=</span>card_text<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token keyword keyword-elif">elif</span> <span class="token builtin">int</span><span class="token punctuation">(</span>correct_number<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin">int</span><span class="token punctuation">(</span>chosen_number<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">                        response <span class="token operator">=</span> <span class="token string">"Higher. You have %s %s left."</span> <span class="token operator">%</span> <span class="token punctuation">(</span>tries_left<span class="token punctuation">,</span>word<span class="token punctuation">)</span></span>
<span class="line">                        <span class="token comment">#response = "%s is incorrect. Guess a higher number. You have %s %s left" % (chosen_number,tries_left,word)</span></span>
<span class="line">                        <span class="token comment">#debug</span></span>
<span class="line">                        <span class="token comment"># response = "Guess a higher number. You have %s %s left. Hint: %s" % (tries_left,word,correct_number)</span></span>
<span class="line">                        <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span>response<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token keyword keyword-elif">elif</span> <span class="token builtin">int</span><span class="token punctuation">(</span>correct_number<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token builtin">int</span><span class="token punctuation">(</span>chosen_number<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">                        response <span class="token operator">=</span> <span class="token string">"Lower. You have %s %s left."</span> <span class="token operator">%</span> <span class="token punctuation">(</span>tries_left<span class="token punctuation">,</span>word<span class="token punctuation">)</span></span>
<span class="line">                        <span class="token comment">#response = "%s is incorrect. Guess a lower number. You have %s %s left" % (chosen_number,tries_left,word)</span></span>
<span class="line">                        <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span>response<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">                        <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">"Unknown Error"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-elif">elif</span> intent_name <span class="token operator">==</span> <span class="token string">"PlayAgainIntent"</span> <span class="token keyword keyword-and">and</span> is_game_over <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></span>
<span class="line">                    chosen_play_again_yn <span class="token operator">=</span> get_slot_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'play_again'</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token keyword keyword-if">if</span> chosen_play_again_yn <span class="token operator">==</span> <span class="token string">'yes'</span><span class="token punctuation">:</span></span>
<span class="line">                        response_session_attributes<span class="token punctuation">[</span><span class="token string">'playing'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">                        response_session_attributes<span class="token punctuation">[</span><span class="token string">'game_over'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">                        <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">"Choose A Level Between Easy, Medium, or Hard"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token keyword keyword-elif">elif</span> chosen_play_again_yn <span class="token operator">==</span> <span class="token string">'no'</span><span class="token punctuation">:</span></span>
<span class="line">                        <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">"Thank You For playing Bomb Defuse"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">                        <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">"Unknown Error"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">,</span> card_text<span class="token operator">=</span><span class="token string">"PlayAgainIntent called"</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">                     <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span>intent <span class="token operator">+</span> <span class="token string">' I did not understand. Can you say it again?'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">        exc_type<span class="token punctuation">,</span> exc_obj<span class="token punctuation">,</span> exc_tb <span class="token operator">=</span> sys<span class="token punctuation">.</span>exc_info<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        fname <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>split<span class="token punctuation">(</span>exc_tb<span class="token punctuation">.</span>tb_frame<span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_filename<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">        card_text <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>exc_type<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>fname<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>exc_tb<span class="token punctuation">.</span>tb_lineno<span class="token punctuation">)</span></span>
<span class="line">        response_session_attributes<span class="token punctuation">[</span><span class="token string">'card_text'</span><span class="token punctuation">]</span> <span class="token operator">=</span> card_text</span>
<span class="line">        <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">"I did not understand you. Can you please say it again?"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">generate_audio_tag</span></span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment">#</span></span>
<span class="line">    <span class="token comment">#url = 'https://s3.amazonaws.com/alexagamefilesbucket/' + filename</span></span>
<span class="line">    <span class="token comment">#</span></span>
<span class="line">    <span class="token comment">#IF PRIVATE</span></span>
<span class="line">    <span class="token comment">#</span></span>
<span class="line">    <span class="token comment"># url = s3.generate_presigned_url('get_object', Params = {'Bucket': 'alexagamefilesbucket', 'Key': filename}, ExpiresIn = 3600)</span></span>
<span class="line">    <span class="token comment"># url = url.replace("&amp;","%26")</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token string">'&lt;audio src="%s"/&gt;'</span> <span class="token operator">%</span> url</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">put_in_audio_tag</span></span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token string">'&lt;audio src="%s"/&gt;'</span> <span class="token operator">%</span> url</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_session_value</span></span><span class="token punctuation">(</span>event<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">        value <span class="token operator">=</span> event<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'session'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'attributes'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> value</span>
<span class="line">    <span class="token keyword keyword-except">except</span> TypeError<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token boolean">False</span></span>
<span class="line">    <span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token boolean">False</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_slot_value</span></span><span class="token punctuation">(</span>event<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">        attribute <span class="token operator">=</span> event<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'intent'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'slots'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'value'</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> attribute</span>
<span class="line">    <span class="token keyword keyword-except">except</span> TypeError<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token boolean">False</span></span>
<span class="line">    <span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token boolean">False</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">build_ssml_response</span></span><span class="token punctuation">(</span>speech_output<span class="token punctuation">,</span> should_end_session<span class="token punctuation">,</span> session_attributes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    response <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">"sessionAttributes"</span><span class="token punctuation">:</span> session_attributes<span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">"response"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token string">"outputSpeech"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"SSML"</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token string">"ssml"</span><span class="token punctuation">:</span><span class="token string">"&lt;speak&gt;"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>speech_output<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">7999</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"&lt;/speak&gt;"</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">"reprompt"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token string">"outputSpeech"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"SSML"</span><span class="token punctuation">,</span></span>
<span class="line">                    <span class="token string">"ssml"</span><span class="token punctuation">:</span> <span class="token string">"&lt;speak&gt;"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>speech_output<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">7999</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"&lt;/speak&gt;"</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">"shouldEndSession"</span><span class="token punctuation">:</span> should_end_session</span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">#if problem playing on amazon echo device</span></span>
<span class="line">    <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> kwargs<span class="token punctuation">[</span><span class="token string">'card_text'</span><span class="token punctuation">]</span> <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">False</span><span class="token punctuation">:</span></span>
<span class="line">            response<span class="token punctuation">[</span><span class="token string">'response'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'card'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Simple"</span><span class="token punctuation">,</span> <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">'Defuse'</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> kwargs<span class="token punctuation">[</span><span class="token string">'card_text'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">#except is GOOD in this case &amp; normal</span></span>
<span class="line">    <span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-pass">pass</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> response</span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Uforia Alexa Skill Hangman</div>
                <div class="description">A Hangman game skill for Alexa.</div>
                <div class="languages">Python</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-python" tabindex="0">                <code class="language-python"><span class="line"><span class="token keyword keyword-import">import</span> os<span class="token punctuation">,</span> sys</span>
<span class="line"><span class="token keyword keyword-import">import</span> urllib2</span>
<span class="line"><span class="token keyword keyword-import">import</span> random</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">lambda_handler</span></span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment">#FORCED TO HAVE PROGRAM FLOW with Try &amp; Catch BECAUSE OF A GLITCH IN AMAZON ECHO DEVICE vs Alexa Service Simulator</span></span>
<span class="line">        <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">            response_session_attributes <span class="token operator">=</span> event<span class="token punctuation">[</span><span class="token string">"session"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"attributes"</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">            response_session_attributes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'debug'</span><span class="token punctuation">:</span><span class="token string">'problem with session variables'</span><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">        state <span class="token operator">=</span> get_session_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'state'</span><span class="token punctuation">,</span><span class="token string">'menu'</span><span class="token punctuation">)</span></span>
<span class="line">        intent <span class="token operator">=</span> get_intent<span class="token punctuation">(</span>event<span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment">#return build_ssml_response(intent, 1, response_session_attributes)</span></span>
<span class="line">        <span class="token keyword keyword-print">print</span> intent</span>
<span class="line">&nbsp;</span>
<span class="line">        bodyparts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Gallows"</span><span class="token punctuation">,</span><span class="token string">"Body"</span><span class="token punctuation">,</span><span class="token string">"Right Arm"</span><span class="token punctuation">,</span><span class="token string">"Left Arm"</span><span class="token punctuation">,</span><span class="token string">"Right Leg"</span><span class="token punctuation">,</span><span class="token string">"Left Leg"</span><span class="token punctuation">]</span></span>
<span class="line">        dict_of_bodyparts <span class="token operator">=</span> <span class="token punctuation">{</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span>c <span class="token keyword keyword-for">for</span> i<span class="token punctuation">,</span>c <span class="token keyword keyword-in">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>bodyparts<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
<span class="line">        number_descriptors <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string">'first'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string">'second'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">'third'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">'fourth'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">'fifth'</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string">'sixth'</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token string">'seventh'</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string">'eighth'</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token string">'ninth'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string">'tenth'</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string">'eleventh'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token string">'twelveth'</span><span class="token punctuation">}</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword keyword-if">if</span> state <span class="token operator">==</span> <span class="token string">'game_over'</span><span class="token punctuation">:</span> </span>
<span class="line">            <span class="token keyword keyword-if">if</span> intent <span class="token operator">==</span> <span class="token string">"PlayAgainIntent"</span><span class="token punctuation">:</span></span>
<span class="line">                choose_play_again_yn <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>get_slot_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'play_again'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> choose_play_again_yn <span class="token operator">==</span> <span class="token string">'yes'</span><span class="token punctuation">:</span></span>
<span class="line">                    <span class="token comment">#fall-through</span></span>
<span class="line">                    state <span class="token operator">=</span> <span class="token string">'menu'</span></span>
<span class="line">                    response_session_attributes<span class="token punctuation">[</span><span class="token string">'state'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'menu'</span></span>
<span class="line">                <span class="token keyword keyword-elif">elif</span> choose_play_again_yn <span class="token operator">==</span> <span class="token string">'no'</span><span class="token punctuation">:</span></span>
<span class="line">                    <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">'Thank you for playing Hang Guy'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">                    <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">'Do you want to play again?'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">'Do you want to play again?'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token keyword keyword-if">if</span> state <span class="token operator">==</span> <span class="token string">'menu'</span><span class="token punctuation">:</span>    </span>
<span class="line">            <span class="token keyword keyword-if">if</span> intent <span class="token operator">==</span> <span class="token string">'ChooseLevelIntent'</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token comment">#change this eventually</span></span>
<span class="line">                chosen_level <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>get_slot_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'level'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> chosen_level <span class="token keyword keyword-not">not</span> <span class="token keyword keyword-in">in</span> <span class="token punctuation">[</span><span class="token string">'easy'</span><span class="token punctuation">,</span><span class="token string">'medium'</span><span class="token punctuation">,</span><span class="token string">'hard'</span><span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="line">                    <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">"Please choose a level between easy, medium or hard"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">                word <span class="token operator">=</span> get_word<span class="token punctuation">(</span>chosen_level<span class="token punctuation">)</span></span>
<span class="line">                response_session_attributes<span class="token punctuation">[</span><span class="token string">'word'</span><span class="token punctuation">]</span> <span class="token operator">=</span> word</span>
<span class="line">                response_session_attributes<span class="token punctuation">[</span><span class="token string">'state'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'guessing'</span></span>
<span class="line">                response_session_attributes<span class="token punctuation">[</span><span class="token string">'puzzle'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span></span>
<span class="line">                response_session_attributes<span class="token punctuation">[</span><span class="token string">'instruction_flag'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line">                response_session_attributes<span class="token punctuation">[</span><span class="token string">'correct'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span></span>
<span class="line">                response_session_attributes<span class="token punctuation">[</span><span class="token string">'tries_left'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>bodyparts<span class="token punctuation">)</span></span>
<span class="line">                instructions <span class="token operator">=</span> <span class="token string">'Your word is %s letters. Start Guessing Letters'</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span>instructions<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">"Please choose a level between easy, medium or hard"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-elif">elif</span> state <span class="token operator">==</span> <span class="token string">'guessing'</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> intent <span class="token operator">==</span> <span class="token string">"ChooseLetterIntent"</span><span class="token punctuation">:</span></span>
<span class="line">                chosen_letter <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>get_slot_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'chosen_letter'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                word <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>get_session_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'word'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                debug_text <span class="token operator">=</span> <span class="token string">"%s %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>chosen_letter<span class="token punctuation">,</span> word<span class="token punctuation">)</span></span>
<span class="line">                word_length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span></span>
<span class="line">                tries_left <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>get_session_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'tries_left'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                tries_left <span class="token operator">-=</span> <span class="token number">1</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> tries_left <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">                    response_session_attributes<span class="token punctuation">[</span><span class="token string">'state'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'game_over'</span></span>
<span class="line">                    <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">"You lost. The correct word was %s . Would you like to play again?"</span> <span class="token operator">%</span> word<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-elif">elif</span> chosen_letter <span class="token keyword keyword-in">in</span> word<span class="token punctuation">:</span>   </span>
<span class="line">                    correct <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>get_session_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'correct'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                    correct <span class="token operator">+=</span> chosen_letter</span>
<span class="line">                    correct_position <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">                    correct_count <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">                    puzzle <span class="token operator">=</span> <span class="token string">''</span></span>
<span class="line">                    response_letter_placement <span class="token operator">=</span> <span class="token string">''</span></span>
<span class="line">                    <span class="token keyword keyword-for">for</span> i <span class="token keyword keyword-in">in</span> word<span class="token punctuation">:</span></span>
<span class="line">                        correct_position <span class="token operator">+=</span> <span class="token number">1</span></span>
<span class="line">                        <span class="token keyword keyword-if">if</span> i <span class="token keyword keyword-in">in</span> correct<span class="token punctuation">:</span></span>
<span class="line">                            puzzle <span class="token operator">+=</span> i</span>
<span class="line">                        <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">                            puzzle <span class="token operator">+=</span> <span class="token string">"_"</span></span>
<span class="line">                        <span class="token keyword keyword-if">if</span> i <span class="token operator">==</span> chosen_letter<span class="token punctuation">:</span></span>
<span class="line">                            response_letter_placement <span class="token operator">+=</span> <span class="token string">" %s is the %s letter, "</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span>number_descriptors<span class="token punctuation">[</span>correct_position<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">                            <span class="token keyword keyword-if">if</span> correct_position <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">                                response_letter_placement <span class="token operator">+=</span> <span class="token string">'&lt;break time="200ms"/&gt; %s is the last letter. '</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span></span>
<span class="line">                            correct_count <span class="token operator">+=</span> <span class="token number">1</span></span>
<span class="line">                    times <span class="token operator">=</span> <span class="token string">"once"</span> <span class="token keyword keyword-if">if</span> correct_count <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword keyword-else">else</span> <span class="token string">"%s times"</span> <span class="token operator">%</span> correct_count</span>
<span class="line">                    response <span class="token operator">=</span> <span class="token string">"%s shows up %s. "</span> <span class="token operator">%</span> <span class="token punctuation">(</span>chosen_letter<span class="token punctuation">,</span>times<span class="token punctuation">)</span> <span class="token operator">+</span> response_letter_placement</span>
<span class="line">                    <span class="token comment">#ONLY GIVE INSTRUCTIONS ON FIRST TRY</span></span>
<span class="line">                    instruction_flag <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>get_session_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'instruction_flag'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token keyword keyword-if">if</span> instruction_flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></span>
<span class="line">                        response <span class="token operator">+=</span> <span class="token string">' Say, What Do I Have, to hear your progress. Put &lt;break time="40ms"/&gt;Is&lt;break time="10ms"/&gt;It&lt;break time="50ms"/&gt;before your answer'</span></span>
<span class="line">                        response_session_attributes<span class="token punctuation">[</span><span class="token string">'instruction_flag'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">                    <span class="token comment">#CORRECT IF ALL LETTERS ARE SOLVED</span></span>
<span class="line">                    <span class="token keyword keyword-if">if</span> puzzle <span class="token operator">==</span> word<span class="token punctuation">:</span></span>
<span class="line">                        response_session_attributes<span class="token punctuation">[</span><span class="token string">'state'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'game_over'</span></span>
<span class="line">                        <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">'Congratulations. You win! The word was %s. Do you want to play again'</span> <span class="token operator">%</span> word<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">                    response_session_attributes<span class="token punctuation">[</span><span class="token string">'correct'</span><span class="token punctuation">]</span> <span class="token operator">=</span> correct</span>
<span class="line">                    response_session_attributes<span class="token punctuation">[</span><span class="token string">'puzzle'</span><span class="token punctuation">]</span> <span class="token operator">=</span> puzzle</span>
<span class="line">&nbsp;</span>
<span class="line">                    <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">,</span> exception<span class="token operator">=</span>debug_text<span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-elif">elif</span> chosen_letter <span class="token keyword keyword-not">not</span> <span class="token keyword keyword-in">in</span> word<span class="token punctuation">:</span></span>
<span class="line">                    response <span class="token operator">=</span> <span class="token string">"Sorry, no &lt;say-as interpret-as='spell-out'&gt;%s&lt;/say-as&gt;. drawing the %s."</span> <span class="token operator">%</span> <span class="token punctuation">(</span>chosen_letter<span class="token punctuation">,</span> dict_of_bodyparts<span class="token punctuation">[</span>tries_left<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">                    response_session_attributes<span class="token punctuation">[</span><span class="token string">'tries_left'</span><span class="token punctuation">]</span> <span class="token operator">=</span> tries_left</span>
<span class="line">                    <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">,</span> exception<span class="token operator">=</span>debug_text<span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">                    <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">"You said  &lt;say-as interpret-as='spell-out'&gt;%s&lt;/say-as&gt;. If you want to solve, say I'd like to solve"</span> <span class="token operator">%</span> chosen_letter<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">,</span>exception<span class="token operator">=</span>word<span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> intent <span class="token operator">==</span> <span class="token string">"RemindIntent"</span><span class="token punctuation">:</span></span>
<span class="line">                puzzle <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>get_session_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'puzzle'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                word <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>get_session_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'word'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                response <span class="token operator">=</span> <span class="token string">'You have a %s letter word&lt;break time="500ms"/&gt;'</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span>  <span class="token operator">+</span> <span class="token string">'&lt;break time="300ms"/&gt;'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'blank'</span> <span class="token keyword keyword-if">if</span> i<span class="token operator">==</span><span class="token string">'_'</span> <span class="token keyword keyword-else">else</span> i <span class="token keyword keyword-for">for</span> i <span class="token keyword keyword-in">in</span> <span class="token builtin">list</span><span class="token punctuation">(</span>puzzle<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> intent <span class="token operator">==</span> <span class="token string">"SolveIntent"</span><span class="token punctuation">:</span></span>
<span class="line">                solve <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>get_slot_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'solve'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                word <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>get_session_value<span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">'word'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> solve <span class="token operator">==</span> word<span class="token punctuation">:</span></span>
<span class="line">                    response_session_attributes<span class="token punctuation">[</span><span class="token string">'state'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'game_over'</span></span>
<span class="line">                    <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">'Congratulations. You win! Do you want to play again'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">                    response_session_attributes<span class="token punctuation">[</span><span class="token string">'state'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'guessing'</span></span>
<span class="line">                    <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">'%s is not the answer. Please choose more letters or solve again.'</span> <span class="token operator">%</span> solve<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span>                </span>
<span class="line">            <span class="token keyword keyword-if">if</span> intent <span class="token operator">==</span> <span class="token string">"AMAZON.CancelIntent"</span> <span class="token keyword keyword-or">or</span> intent <span class="token operator">==</span> <span class="token string">"AMAZON.StopIntent"</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">'Thank you for using Hang Guy. See you next time!'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">'Please guess more letters or solve the puzzle. Say, is it, before the answer'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">        exc_type<span class="token punctuation">,</span> exc_obj<span class="token punctuation">,</span> exc_tb <span class="token operator">=</span> sys<span class="token punctuation">.</span>exc_info<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        fname <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>split<span class="token punctuation">(</span>exc_tb<span class="token punctuation">.</span>tb_frame<span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_filename<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">        exception_text <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>exc_type<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>fname<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>exc_tb<span class="token punctuation">.</span>tb_lineno<span class="token punctuation">)</span></span>
<span class="line">        response_session_attributes<span class="token punctuation">[</span><span class="token string">'exception'</span><span class="token punctuation">]</span> <span class="token operator">=</span> exception_text</span>
<span class="line">        <span class="token keyword keyword-return">return</span> build_ssml_response<span class="token punctuation">(</span><span class="token string">"I did not understand you. Can you please say it again?"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>response_session_attributes<span class="token punctuation">,</span>exception<span class="token operator">=</span>exception_text<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">#####</span></span>
<span class="line"><span class="token comment"># PLEASE REPLACE URL IF YOU ARE CHANGING IT!!! WORDS MUST BE SEPARATED IN NEW LINES</span></span>
<span class="line"><span class="token comment">#####</span></span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_word</span></span><span class="token punctuation">(</span>level<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    results <span class="token operator">=</span> urllib2<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span><span class="token string">'http://pastebin.com/raw/baKjRnDu'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    list_of_results <span class="token operator">=</span> results<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span></span>
<span class="line">    length_of_results <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>list_of_results<span class="token punctuation">)</span></span>
<span class="line">    dict_of_lengths <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'easy'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'medium'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'hard'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-while">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></span>
<span class="line">        list_index <span class="token operator">=</span> random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>length_of_results<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        word <span class="token operator">=</span> list_of_results<span class="token punctuation">[</span>list_index<span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        list_index <span class="token operator">+=</span> <span class="token number">1</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> list_index <span class="token operator">==</span> length_of_results <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span></span>
<span class="line">            list_index <span class="token operator">=</span> <span class="token number">0</span> </span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span> <span class="token keyword keyword-in">in</span> dict_of_lengths<span class="token punctuation">[</span>level<span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword keyword-break">break</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> word</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_intent</span></span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> event<span class="token punctuation">[</span><span class="token string">"request"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"type"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"LaunchRequest"</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token string">"LaunchRequest"</span></span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> event<span class="token punctuation">[</span><span class="token string">"request"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"type"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"IntentRequest"</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> event<span class="token punctuation">[</span><span class="token string">"request"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"intent"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token boolean">False</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_session_value</span></span><span class="token punctuation">(</span>event<span class="token punctuation">,</span>key<span class="token punctuation">,</span>default<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">        value <span class="token operator">=</span> event<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'session'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'attributes'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">,</span>default<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> value</span>
<span class="line">    <span class="token keyword keyword-except">except</span> TypeError<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> default</span>
<span class="line">    <span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> default</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_slot_value</span></span><span class="token punctuation">(</span>event<span class="token punctuation">,</span>key<span class="token punctuation">,</span>default<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">        attribute <span class="token operator">=</span> event<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'intent'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'slots'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'value'</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> attribute</span>
<span class="line">    <span class="token keyword keyword-except">except</span> TypeError<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> default</span>
<span class="line">    <span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> default</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">build_ssml_response</span></span><span class="token punctuation">(</span>speech_output<span class="token punctuation">,</span> should_end_session<span class="token punctuation">,</span> session_attributes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    response <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">"sessionAttributes"</span><span class="token punctuation">:</span> session_attributes<span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">"response"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token string">"outputSpeech"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"SSML"</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token string">"ssml"</span><span class="token punctuation">:</span><span class="token string">"&lt;speak&gt;"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>speech_output<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">7999</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"&lt;/speak&gt;"</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">"reprompt"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token string">"outputSpeech"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"SSML"</span><span class="token punctuation">,</span></span>
<span class="line">                    <span class="token string">"ssml"</span><span class="token punctuation">:</span> <span class="token string">"&lt;speak&gt;"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>speech_output<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">7999</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"&lt;/speak&gt;"</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">"shouldEndSession"</span><span class="token punctuation">:</span> should_end_session</span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">#if problem playing on amazon echo device</span></span>
<span class="line">    <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> kwargs<span class="token punctuation">[</span><span class="token string">'exception'</span><span class="token punctuation">]</span> <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">False</span><span class="token punctuation">:</span></span>
<span class="line">            response<span class="token punctuation">[</span><span class="token string">'response'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'card'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"Simple"</span><span class="token punctuation">,</span> <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> kwargs<span class="token punctuation">[</span><span class="token string">'exception'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">#except is GOOD in this case &amp; normal</span></span>
<span class="line">    <span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-pass">pass</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> response</span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Connecting to Network Devices with Low Level Network Sockets</div>
                <div class="description">An asynchronous socket connection to network devices. Do not use, Netmiko is better. Done for learning when I couldn't get Paramiko to work (before)</div>
                <div class="languages">Python</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-python" tabindex="0">                <code class="language-python"><span class="line"><span class="token keyword keyword-import">import</span> asyncio</span>
<span class="line"><span class="token keyword keyword-import">import</span> regex</span>
<span class="line"><span class="token keyword keyword-import">import</span> traceback</span>
<span class="line"><span class="token keyword keyword-import">import</span> sys</span>
<span class="line"><span class="token keyword keyword-import">import</span> time</span>
<span class="line"><span class="token keyword keyword-from">from</span> helper <span class="token keyword keyword-import">import</span> <span class="token operator">*</span></span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">CiscoAsyncObject</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">	command_timeout <span class="token operator">=</span> <span class="token number">40</span></span>
<span class="line">	<span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">byte_to_string</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>obj<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">		<span class="token triple-quoted-string string">'''byte_to_string</span>
<span class="line">		clean up a raw byte stream by recv. Chiefly used in read function.</span>
<span class="line">		Arguments:</span>
<span class="line">			obj {bytes (recv(1024))} -- messy bytes</span>
<span class="line">		Returns:</span>
<span class="line">			string -- so beautifully neat</span>
<span class="line">		'''</span></span>
<span class="line">		text <span class="token operator">=</span> obj<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span><span class="token string">'ignore'</span><span class="token punctuation">)</span></span>
<span class="line">		text <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>x <span class="token keyword keyword-for">for</span> x <span class="token keyword keyword-in">in</span> <span class="token builtin">str</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token keyword keyword-if">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token keyword keyword-return">return</span> text</span>
<span class="line">	<span class="token keyword keyword-async">async</span> <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">async_cisco_socket</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>loop<span class="token punctuation">,</span>ip<span class="token punctuation">,</span>port <span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">		<span class="token triple-quoted-string string">'''async_cisco_socket</span>
<span class="line">		</span>
<span class="line">		This should be like the __init__ function of a socket class, but I don't know how to do init in an asynchronous context. So the end result will be that this will just populate self.reader &amp; self.writer of this object</span>
<span class="line">		'''</span></span>
<span class="line">		connect_retries <span class="token operator">=</span> <span class="token number">8</span></span>
<span class="line">		tries <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">		<span class="token comment">#try this the amount of connect_retries times</span></span>
<span class="line">		<span class="token keyword keyword-while">while</span> tries <span class="token operator">&lt;</span> connect_retries<span class="token punctuation">:</span></span>
<span class="line">			<span class="token keyword keyword-try">try</span> <span class="token punctuation">:</span></span>
<span class="line">				reader<span class="token punctuation">,</span> writer <span class="token operator">=</span> <span class="token keyword keyword-await">await</span> asyncio<span class="token punctuation">.</span>open_connection<span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">,</span> loop<span class="token operator">=</span>loop<span class="token punctuation">)</span></span>
<span class="line">				<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>reader <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">					hostname_line<span class="token punctuation">(</span>ip<span class="token punctuation">,</span><span class="token string">'Socket Created'</span><span class="token punctuation">)</span></span>
<span class="line">					<span class="token comment">#when the connection begins and you have to write "en" &amp; password for Socket</span></span>
<span class="line">					self<span class="token punctuation">.</span>ip <span class="token operator">=</span> ip</span>
<span class="line">					self<span class="token punctuation">.</span>hostname <span class="token operator">=</span> get_hostname<span class="token punctuation">(</span>ip<span class="token punctuation">)</span></span>
<span class="line">					self<span class="token punctuation">.</span>reader <span class="token operator">=</span> reader</span>
<span class="line">					self<span class="token punctuation">.</span>writer <span class="token operator">=</span> writer</span>
<span class="line">					<span class="token keyword keyword-await">await</span> self<span class="token punctuation">.</span>initialize_socket<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">					<span class="token keyword keyword-break">break</span></span>
<span class="line">				<span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">					<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>reader<span class="token punctuation">,</span>writer<span class="token punctuation">)</span></span>
<span class="line">			<span class="token keyword keyword-except">except</span> ConnectionRefusedError<span class="token punctuation">:</span></span>
<span class="line">				tries <span class="token operator">=</span> tries <span class="token operator">+</span> <span class="token number">1</span></span>
<span class="line">				hostname_line<span class="token punctuation">(</span>ip<span class="token punctuation">,</span><span class="token string">"Couldn't connect because of ConnectionRefusedError"</span><span class="token punctuation">)</span></span>
<span class="line">			<span class="token keyword keyword-except">except</span> TimeoutError<span class="token punctuation">:</span></span>
<span class="line">				tries <span class="token operator">=</span> tries <span class="token operator">+</span> <span class="token number">1</span></span>
<span class="line">				hostname_line<span class="token punctuation">(</span>ip<span class="token punctuation">,</span><span class="token string">"Couldn't connect because of TimeoutError"</span><span class="token punctuation">)</span></span>
<span class="line">				<span class="token keyword keyword-await">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">			<span class="token keyword keyword-except">except</span> Exception <span class="token keyword keyword-as">as</span> exc<span class="token punctuation">:</span></span>
<span class="line">				tries <span class="token operator">=</span> tries <span class="token operator">+</span> <span class="token number">1</span></span>
<span class="line">				hostname_line<span class="token punctuation">(</span>ip<span class="token punctuation">,</span><span class="token string">"Generic Exception -&gt; %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>exc<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token keyword keyword-if">if</span> tries <span class="token operator">&gt;=</span> connect_retries<span class="token punctuation">:</span></span>
<span class="line">			hostname_line<span class="token punctuation">(</span>ip<span class="token punctuation">,</span><span class="token string">"No socket connection because it exhausted it's maximum limit of retries."</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token keyword keyword-async">async</span> <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">sendline</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>command<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">		<span class="token triple-quoted-string string">'''sendline</span>
<span class="line">		</span>
<span class="line">		sendlines a command into the socket (Cisco here), and you could make it return the text to show up in the loop results, OR you could have it print as it goes. I prefer to have it print as it goes, and I did that option. </span>
<span class="line">&nbsp;</span>
<span class="line">		Kwargs is:</span>
<span class="line">&nbsp;</span>
<span class="line">		expect = regex, which will break the recv read calls</span>
<span class="line">		print = True/False, which prints the message as it goes</span>
<span class="line">		newline = True/False (default True)</span>
<span class="line">		'''</span></span>
<span class="line">		chunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">		text <span class="token operator">=</span> <span class="token string">''</span></span>
<span class="line">		start_time_timeout_check <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>		</span>
<span class="line">		reader <span class="token operator">=</span> self<span class="token punctuation">.</span>reader</span>
<span class="line">		writer <span class="token operator">=</span> self<span class="token punctuation">.</span>writer</span>
<span class="line">		ip <span class="token operator">=</span> self<span class="token punctuation">.</span>ip</span>
<span class="line">		hostname <span class="token operator">=</span> self<span class="token punctuation">.</span>hostname</span>
<span class="line">		print_it <span class="token operator">=</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'print'</span><span class="token punctuation">,</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token comment">#expect regex that will break the recv loop</span></span>
<span class="line">		expect_regex <span class="token operator">=</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'expect'</span><span class="token punctuation">,</span><span class="token boolean">None</span><span class="token punctuation">)</span></span>
<span class="line">		default_regex <span class="token operator">=</span> hostname <span class="token operator">+</span> <span class="token string">'.*'</span> <span class="token operator">+</span> <span class="token string">'[#|\^|&gt;]'</span></span>
<span class="line">		<span class="token comment">#the default is in the right</span></span>
<span class="line">		expect_regex <span class="token operator">=</span> expect_regex <span class="token keyword keyword-if">if</span> expect_regex <span class="token operator">!=</span> <span class="token boolean">None</span> <span class="token keyword keyword-else">else</span> default_regex</span>
<span class="line">		<span class="token comment">#IF NEWLINE KWARGS IS FALSE</span></span>
<span class="line">		<span class="token keyword keyword-if">if</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"newline"</span><span class="token punctuation">)</span> <span class="token keyword keyword-is">is</span> <span class="token boolean">False</span><span class="token punctuation">:</span></span>
<span class="line">			command <span class="token operator">=</span> command</span>
<span class="line">		<span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">			command <span class="token operator">=</span> command <span class="token operator">+</span> <span class="token string">"\n"</span></span>
<span class="line">		<span class="token comment">#clear line</span></span>
<span class="line">		<span class="token keyword keyword-for">for</span> i <span class="token keyword keyword-in">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">			writer<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"\x15"</span><span class="token punctuation">)</span></span>
<span class="line">			<span class="token keyword keyword-await">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">.05</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token comment">#do actual sending</span></span>
<span class="line">		writer<span class="token punctuation">.</span>write<span class="token punctuation">(</span>command<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token keyword keyword-while">while</span> <span class="token number">1</span><span class="token punctuation">:</span></span>
<span class="line">			<span class="token comment">#Break up out of here no matte what, by the command timeout</span></span>
<span class="line">			total_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time_timeout_check	</span>
<span class="line">			<span class="token comment"># print("%s %s" % (command,total_time))</span></span>
<span class="line">			<span class="token keyword keyword-if">if</span> total_time <span class="token operator">&gt;</span> self<span class="token punctuation">.</span>command_timeout<span class="token punctuation">:</span></span>
<span class="line">				<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">'"%s" has timed out'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">				<span class="token keyword keyword-return">return</span> <span class="token string">'Time Out'</span></span>
<span class="line">			<span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">				chunk <span class="token operator">=</span> <span class="token keyword keyword-await">await</span> self<span class="token punctuation">.</span>reader<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">8024</span><span class="token punctuation">)</span></span>
<span class="line">				<span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> chunk<span class="token punctuation">:</span></span>
<span class="line">					<span class="token keyword keyword-break">break</span></span>
<span class="line">				chunk <span class="token operator">=</span> self<span class="token punctuation">.</span>byte_to_string<span class="token punctuation">(</span>chunk<span class="token punctuation">)</span></span>
<span class="line">				chunk_length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span></span>
<span class="line">				text <span class="token operator">=</span> text <span class="token operator">+</span> chunk</span>
<span class="line">				<span class="token comment"># print("REGEX&gt; ", expect_regex,  len(chunk), chunk.replace('\n', ' ').replace('\r', ' '),regex.search(expect_regex,chunk))</span></span>
<span class="line">				<span class="token comment">#stop doing the recv at if the expect regex is not in the ENTIRE TEXT or the exception. It will stop at expect</span></span>
<span class="line">				<span class="token keyword keyword-if">if</span> regex<span class="token punctuation">.</span>search<span class="token punctuation">(</span>expect_regex<span class="token punctuation">,</span>text<span class="token punctuation">)</span> <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">					<span class="token comment"># print(command, "Expect happened")</span></span>
<span class="line">					<span class="token keyword keyword-break">break</span></span>
<span class="line">				</span>
<span class="line">				</span>
<span class="line">			<span class="token keyword keyword-except">except</span> Exception <span class="token keyword keyword-as">as</span> exc<span class="token punctuation">:</span></span>
<span class="line">				<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>hostname_line<span class="token punctuation">(</span>ip<span class="token punctuation">,</span> <span class="token string">"Exception as %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>exc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">				traceback<span class="token punctuation">.</span>print_exc<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">				<span class="token keyword keyword-await">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">.5</span><span class="token punctuation">)</span></span>
<span class="line">				<span class="token keyword keyword-continue">continue</span></span>
<span class="line">			<span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">				<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Error"</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token comment">#END READ</span></span>
<span class="line">		<span class="token comment">#THIS IS DONE TO KEEP TRACK OF ? COMMANDS</span></span>
<span class="line">		<span class="token comment">#This is for later text cleanup</span></span>
<span class="line">		<span class="token keyword keyword-if">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">			self<span class="token punctuation">.</span>current_command <span class="token operator">=</span> command<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token comment">#just get the result without fluff</span></span>
<span class="line">		<span class="token comment">#remove command in beginning &amp; prompt at end</span></span>
<span class="line">		text <span class="token operator">=</span> text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_command<span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span></span>
<span class="line">		text <span class="token operator">=</span> text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_command<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' ?'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span></span>
<span class="line">		text <span class="token operator">=</span> regex<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_command<span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span>text<span class="token punctuation">)</span></span>
<span class="line">		text <span class="token operator">=</span> text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token comment">#clean will remove the prompt, and other custom cleaning</span></span>
<span class="line">		<span class="token comment">#remove the prompt in the end!</span></span>
<span class="line">		text <span class="token operator">=</span> regex<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">'\n%s.*[#|\^|&gt;]'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>hostname<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span>text<span class="token punctuation">)</span></span>
<span class="line">		text <span class="token operator">=</span> regex<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">'%s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_command<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' ?'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span>text<span class="token punctuation">)</span></span>
<span class="line">		<span class="token comment"># text = text.strip()</span></span>
<span class="line">		<span class="token comment">#clean up it for the console</span></span>
<span class="line">		text <span class="token operator">=</span> sanitize<span class="token punctuation">(</span>text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">		text <span class="token operator">=</span> regex<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">'\r\s*'</span><span class="token punctuation">,</span><span class="token string">'\r'</span><span class="token punctuation">,</span>text<span class="token punctuation">)</span></span>
<span class="line">		<span class="token comment">#does the printing in each send line IF kwargs print is true (like print=True as parameter)</span></span>
<span class="line">		<span class="token keyword keyword-if">if</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"newline"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span></span>
<span class="line">			header <span class="token operator">=</span> wrap<span class="token punctuation">(</span>wrap_hostname_line<span class="token punctuation">(</span>ip<span class="token punctuation">,</span><span class="token string">'Results of "%s"'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">			<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>header <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> text<span class="token punctuation">)</span></span>
<span class="line">		<span class="token keyword keyword-return">return</span> text</span>
<span class="line">&nbsp;</span>
<span class="line">	<span class="token keyword keyword-async">async</span> <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">initialize_socket</span></span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">		<span class="token triple-quoted-string string">'''initialize_socket</span>
<span class="line">		this is called by the async_connect to get to the config mode</span>
<span class="line">		'''</span></span>
<span class="line">		<span class="token keyword keyword-await">await</span> self<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'en'</span><span class="token punctuation">,</span>expect<span class="token operator">=</span><span class="token string">"Password"</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token keyword keyword-await">await</span> self<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'goon'</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token keyword keyword-await">await</span> self<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'terminal length 0'</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token keyword keyword-await">await</span> self<span class="token punctuation">.</span>config_mode<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token keyword keyword-async">async</span> <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">config_mode</span></span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">		<span class="token triple-quoted-string string">'''config mode</span>
<span class="line">		Goes Into Config Mode of course</span>
<span class="line">		'''</span></span>
<span class="line">		<span class="token keyword keyword-await">await</span> self<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"configure terminal"</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token keyword keyword-async">async</span> <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">privileged_mode</span></span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">		<span class="token triple-quoted-string string">'''privilged_mode</span>
<span class="line">		the mode before global config mode, which is privileged mode</span>
<span class="line">		'''</span></span>
<span class="line">		<span class="token keyword keyword-await">await</span> self<span class="token punctuation">.</span>config_mode<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token keyword keyword-await">await</span> self<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"end"</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token keyword keyword-async">async</span> <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">write</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">		<span class="token triple-quoted-string string">'''write</span>
<span class="line">		</span>
<span class="line">		Write raw BYTES</span>
<span class="line">&nbsp;</span>
<span class="line">		command is in BYTES, not string</span>
<span class="line">		'''</span></span>
<span class="line">		<span class="token comment"># print("Writing: %s" % (command))</span></span>
<span class="line">		self<span class="token punctuation">.</span>writer<span class="token punctuation">.</span>write<span class="token punctuation">(</span>command<span class="token punctuation">)</span></span>
<span class="line">	<span class="token keyword keyword-async">async</span> <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">clear_line</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>command<span class="token operator">=</span><span class="token string">b"\x15"</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">		<span class="token triple-quoted-string string">'''clear_line</span>
<span class="line">		</span>
<span class="line">		Simply writes b'\x15' into Telnet which clears the line! This is required for those ? help commands.</span>
<span class="line">		This also represents Ctrl+U in the ASCII map, and is verified in Wireshark.</span>
<span class="line">		'''</span></span>
<span class="line">		<span class="token keyword keyword-await">await</span> self<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"\x15"</span><span class="token punctuation">)</span></span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Connecting to Network Devices with Low Level Network Sockets</div>
                <div class="description">A synchronous socket connection to network devices. Network Automation.</div>
                <div class="languages">Python</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-python" tabindex="0">                <code class="language-python"><span class="line"><span class="token keyword keyword-import">import</span> asyncio</span>
<span class="line"><span class="token keyword keyword-import">import</span> regex</span>
<span class="line"><span class="token keyword keyword-import">import</span> traceback</span>
<span class="line"><span class="token keyword keyword-import">import</span> sys</span>
<span class="line"><span class="token keyword keyword-from">from</span> async_socket_connection <span class="token keyword keyword-import">import</span> <span class="token operator">*</span></span>
<span class="line"><span class="token keyword keyword-from">from</span> helper <span class="token keyword keyword-import">import</span> <span class="token operator">*</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">CiscoSyncObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">	cisco_async_object <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line">	loop <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line">	<span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">__init__</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>ip<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">		<span class="token triple-quoted-string string">'''__init__</span>
<span class="line">		</span>
<span class="line">		The Constructor will simply set an instance variable of an instance of the CiscoAsyncObject inside of async_socket_connection.py. The constructor runs the Asyncio Loop that will never end. </span>
<span class="line">		</span>
<span class="line">		Arguments:</span>
<span class="line">			ip {string} -- ip address of device to access</span>
<span class="line">		</span>
<span class="line">		Returns:</span>
<span class="line">			nothing -- nothing</span>
<span class="line">		'''</span></span>
<span class="line">		<span class="token keyword keyword-async">async</span> <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">instantiate_inner_func</span></span><span class="token punctuation">(</span>loop<span class="token punctuation">,</span>ip<span class="token punctuation">)</span><span class="token punctuation">:</span> </span>
<span class="line">			cisco_async_object <span class="token operator">=</span> CiscoAsyncObject<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">			<span class="token keyword keyword-await">await</span> cisco_async_object<span class="token punctuation">.</span>async_cisco_socket<span class="token punctuation">(</span>loop<span class="token punctuation">,</span>ip<span class="token punctuation">)</span></span>
<span class="line">			<span class="token keyword keyword-return">return</span> cisco_async_object</span>
<span class="line">		self<span class="token punctuation">.</span>loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>new_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">		asyncio<span class="token punctuation">.</span>set_event_loop<span class="token punctuation">(</span>self<span class="token punctuation">.</span>loop<span class="token punctuation">)</span></span>
<span class="line">		tasks <span class="token operator">=</span> <span class="token punctuation">[</span>asyncio<span class="token punctuation">.</span>ensure_future<span class="token punctuation">(</span>instantiate_inner_func<span class="token punctuation">(</span>self<span class="token punctuation">.</span>loop<span class="token punctuation">,</span>ip<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line">		nodes <span class="token operator">=</span> self<span class="token punctuation">.</span>loop<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>tasks<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token builtin">object</span> <span class="token operator">=</span> l<span class="token punctuation">(</span>nodes<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">		self<span class="token punctuation">.</span>cisco_async_object <span class="token operator">=</span> <span class="token builtin">object</span></span>
<span class="line">	<span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">__getattr__</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>name<span class="token punctuation">,</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">		<span class="token triple-quoted-string string">'''__get_attr</span>
<span class="line">		</span>
<span class="line">		__getattr__ and __call__ are the two methods that are called when an unknown function is ran in a Python Class, similar to the behavior to the PHP __get magic function. Here the method call is saved for later use in the __call__ function. GetAttr dunder method gets the function name.</span>
<span class="line">		</span>
<span class="line">		Arguments:</span>
<span class="line">			name {string} -- method name</span>
<span class="line">			*args {[type]} -- [description]</span>
<span class="line">			**kwargs {[type]} -- [description]</span>
<span class="line">		</span>
<span class="line">		Returns:</span>
<span class="line">			CiscoSyncSocket -- Self</span>
<span class="line">		'''</span></span>
<span class="line">		self<span class="token punctuation">.</span>method_call <span class="token operator">=</span> name</span>
<span class="line">		<span class="token keyword keyword-return">return</span> self</span>
<span class="line">	<span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">__call__</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">		<span class="token triple-quoted-string string">'''__call__</span>
<span class="line">		</span>
<span class="line">		See the getattr method. __getattr__ and __call__ both deal with unknown functions. But there's a lot more. getattr(self.cisco_async_object,self.method_call)(name,*args,**kwargs) calls the function dynamically. It calls the self.method call (by call) on the self.cisco_async_object. </span>
<span class="line">		</span>
<span class="line">		Arguments:</span>
<span class="line">			name {string} -- argument inside of function</span>
<span class="line">			*args {[type]} -- [description]</span>
<span class="line">			**kwargs {[type]} -- [description]</span>
<span class="line">		</span>
<span class="line">		Returns:</span>
<span class="line">			string -- result</span>
<span class="line">		'''</span></span>
<span class="line">		<span class="token keyword keyword-return">return</span> l<span class="token punctuation">(</span>self<span class="token punctuation">.</span>loop<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>cisco_async_object<span class="token punctuation">,</span>self<span class="token punctuation">.</span>method_call<span class="token punctuation">)</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Data ETL (Australian Company)</div>
                <div class="description">Convert messy phone log data into neat CSV via advanced regex. Done for an Australian company to clean unstructured data for data analysis. ETL.</div>
                <div class="languages">Python</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-python" tabindex="0">                <code class="language-python"><span class="line"><span class="token keyword keyword-import">import</span> regex<span class="token punctuation">,</span> sys<span class="token punctuation">,</span> csv<span class="token punctuation">,</span> functools<span class="token punctuation">,</span>operator<span class="token punctuation">,</span>time</span>
<span class="line"><span class="token keyword keyword-from">from</span> helper <span class="token keyword keyword-import">import</span> <span class="token operator">*</span></span>
<span class="line"> </span>
<span class="line"><span class="token comment">#########################</span></span>
<span class="line"><span class="token comment">#    NONE DECORATOR EXCEPTION</span></span>
<span class="line"><span class="token comment">#########################</span></span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">catch_exception</span></span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">	<span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">func_wrapper</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">		<span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">			<span class="token comment">#actually run function</span></span>
<span class="line">			data <span class="token operator">=</span> func<span class="token punctuation">(</span>self<span class="token punctuation">,</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span></span>
<span class="line">		<span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">			data <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line">		<span class="token keyword keyword-return">return</span> data</span>
<span class="line">	<span class="token keyword keyword-return">return</span> func_wrapper</span>
<span class="line"> </span>
<span class="line"><span class="token comment">#########################</span></span>
<span class="line"><span class="token comment">#    RULES</span></span>
<span class="line"><span class="token comment">#########################</span></span>
<span class="line">rules_d <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'0244230000'</span><span class="token punctuation">:</span><span class="token string">'Shandi Grenville (or another person who attended the phones at the Beechwood offices)'</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token string">'0242245500'</span><span class="token punctuation">:</span><span class="token string">'Shandi Grenville (or another person who attended the phones at the Beechwood offices)'</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token string">'0404821015'</span><span class="token punctuation">:</span><span class="token string">'Trevor Moffatt (Beechwood)'</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token string">'0242960139'</span><span class="token punctuation">:</span><span class="token string">'"Matt Slee (Building &amp; Design Team - South Coast:\' Beechwood)"'</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token string">'0412605594'</span><span class="token punctuation">:</span><span class="token string">'Anthony Higgins (Southern Trenching)'</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token string">'0404821914'</span><span class="token punctuation">:</span><span class="token string">'Wayne Braid (Beechwood)'</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token string">'0296160999'</span><span class="token punctuation">:</span><span class="token string">'someone at the Beechwood Sydney Business Centre (Head Office)'</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token string">'0244221233'</span><span class="token punctuation">:</span><span class="token string">'someone at Leslie &amp; Thompson Pty Ltd'</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token string">'0402350828'</span><span class="token punctuation">:</span><span class="token string">'"Thomas Smith (Building &amp; Design Team:\' Beechwood)"'</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token string">'0244240012'</span><span class="token punctuation">:</span><span class="token string">'someone at the Twin Waters estate (Beechwood)'</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token string">'0414975583'</span><span class="token punctuation">:</span><span class="token string">'"Geoff Slee (Building &amp; Design Team - South Coast, Beechwood)"'</span><span class="token punctuation">}</span></span>
<span class="line">rules_d_k <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>rules_d<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line"><span class="token comment">#########################</span></span>
<span class="line"><span class="token comment">#    REGEX VARIABLES</span></span>
<span class="line"><span class="token comment">#    //ANCHOR: Variables</span></span>
<span class="line"><span class="token comment">#########################</span></span>
<span class="line">format_regex <span class="token operator">=</span> <span class="token string">''</span></span>
<span class="line">time_regex <span class="token operator">=</span> <span class="token string">'\d{1,2}:\d{1,2}:\d{1,2}'</span></span>
<span class="line">date_regex <span class="token operator">=</span> <span class="token string">'\d{4}\-\d{1,2}\-\d{1,2}'</span></span>
<span class="line">space_new_regex <span class="token operator">=</span> <span class="token string">'[\s|\n]*'</span></span>
<span class="line">any_regex <span class="token operator">=</span> <span class="token string">'.*?'</span></span>
<span class="line">date_time_regex <span class="token operator">=</span> date_regex <span class="token operator">+</span> space_new_regex <span class="token operator">+</span> time_regex</span>
<span class="line">time_date_regex <span class="token operator">=</span> time_regex <span class="token operator">+</span> space_new_regex <span class="token operator">+</span> date_regex</span>
<span class="line">overall_date_regex <span class="token operator">=</span> <span class="token string">'('</span> <span class="token operator">+</span> time_date_regex <span class="token operator">+</span> <span class="token string">'|'</span> <span class="token operator">+</span> date_time_regex <span class="token operator">+</span> <span class="token string">')'</span></span>
<span class="line">look_start_regex <span class="token operator">=</span> <span class="token string">'(?&lt;=^|\s)'</span></span>
<span class="line">look_end_regex <span class="token operator">=</span> <span class="token string">'(?=\s|$)'</span></span>
<span class="line">series_of_words_regex <span class="token operator">=</span> look_start_regex <span class="token operator">+</span> <span class="token string">'\d*\s*[A-Za-z]*[A-Za-z|\-|\s]*'</span> <span class="token operator">+</span> look_end_regex</span>
<span class="line">disk_space_regex <span class="token operator">=</span> look_start_regex <span class="token operator">+</span> <span class="token string">'\d{1,2}\.\d{1,2}MB|GB'</span> <span class="token operator">+</span> look_end_regex</span>
<span class="line">currency_regex <span class="token operator">=</span> look_start_regex <span class="token operator">+</span> <span class="token string">'\$\d*\.\d*'</span> <span class="token operator">+</span> look_end_regex</span>
<span class="line">duration_regex <span class="token operator">=</span> look_start_regex <span class="token operator">+</span> <span class="token string">'\d{1,2}:\d{1,2}'</span> <span class="token comment">#00:22 + look_end_regex</span></span>
<span class="line">phone_number_regex <span class="token operator">=</span> look_start_regex <span class="token operator">+</span> <span class="token string">'[0-9]+'</span> <span class="token operator">+</span> look_end_regex</span>
<span class="line">integer_regex <span class="token operator">=</span> look_start_regex <span class="token operator">+</span> <span class="token string">'[0-9]+'</span> <span class="token operator">+</span> look_end_regex</span>
<span class="line">input_base_path <span class="token operator">=</span> <span class="token string">'C:/makeshift/files/australia_mobile/data/'</span></span>
<span class="line">csv_base_path <span class="token operator">=</span> <span class="token string">'C:/makeshift/files/australia_mobile/csv/'</span></span>
<span class="line">csv_all_file_name <span class="token operator">=</span> <span class="token string">'phone_all.csv'</span></span>
<span class="line">csv_filtered_file_name <span class="token operator">=</span> <span class="token string">'phone_filtered.csv'</span></span>
<span class="line">csv_rules_file_name <span class="token operator">=</span> <span class="token string">'rules_total.csv'</span></span>
<span class="line">csv_all_file_path <span class="token operator">=</span> csv_base_path <span class="token operator">+</span> csv_all_file_name</span>
<span class="line">csv_filtered_file_path <span class="token operator">=</span> csv_base_path <span class="token operator">+</span> csv_filtered_file_name</span>
<span class="line">csv_rules_file_path <span class="token operator">=</span> csv_base_path <span class="token operator">+</span> csv_filtered_file_name</span>
<span class="line">input_files <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'logs_mobile.txt'</span><span class="token punctuation">,</span><span class="token string">'logs_2016.txt'</span><span class="token punctuation">,</span><span class="token string">'logs_2017.txt'</span><span class="token punctuation">]</span></span>
<span class="line">input_files <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'logs_mobile_2.txt'</span><span class="token punctuation">,</span><span class="token string">'logs_2016.txt'</span><span class="token punctuation">,</span><span class="token string">'logs_2017.txt'</span><span class="token punctuation">]</span></span>
<span class="line">nodes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">row <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">schema <span class="token operator">=</span> <span class="token string">''</span></span>
<span class="line">usage_type <span class="token operator">=</span> <span class="token string">''</span></span>
<span class="line">called_number <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line">schema_allowed <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'mobile'</span><span class="token punctuation">,</span><span class="token string">'phone'</span><span class="token punctuation">,</span><span class="token string">'sms_national'</span><span class="token punctuation">,</span><span class="token string">'data'</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token comment"># input_files = ['logs_2017.txt']</span></span>
<span class="line"><span class="token comment">#DO SHIT FOR RULES_COUNT_CSV!!! </span></span>
<span class="line">rules_count_d <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword keyword-for">for</span> phone_number<span class="token punctuation">,</span> name <span class="token keyword keyword-in">in</span> rules_d<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">	rules_count_d<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>phone_number<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">	rules_count_d<span class="token punctuation">[</span>phone_number<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> name</span>
<span class="line">	<span class="token keyword keyword-for">for</span> input_file <span class="token keyword keyword-in">in</span> input_files<span class="token punctuation">:</span></span>
<span class="line">		rules_count_d<span class="token punctuation">[</span>phone_number<span class="token punctuation">]</span><span class="token punctuation">[</span>input_file<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line"> </span>
<span class="line"><span class="token comment">#note</span></span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment">#TWO TYPES OF ROWS</span></span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment">#1) data = ['Data', '0.02MB', '0.02MB', '$0.00000', '$0.00000', '$0.00000']</span></span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment">#2) calls =  ['Mobile', 'Call', '09:46', '0418695084', '0.00MB', '$9.35000', '$0.00000', '$0.00000']</span></span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment">#//ANCHOR: REGEX ROWS</span></span>
<span class="line">data_regex_row <span class="token operator">=</span> <span class="token string">'(%s)%s(%s)%s(%s)%s(%s)%s(%s)%s(%s)'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>series_of_words_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> disk_space_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> disk_space_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> currency_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> currency_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> currency_regex<span class="token punctuation">)</span></span>
<span class="line">calls_mobile_regex_row <span class="token operator">=</span> <span class="token string">'(%s)%s(%s)%s(%s)%s(%s)%s(%s)%s(%s)%s(%s)'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>series_of_words_regex <span class="token punctuation">,</span> space_new_regex<span class="token punctuation">,</span> duration_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> phone_number_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> disk_space_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> currency_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> currency_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> currency_regex<span class="token punctuation">)</span></span>
<span class="line">sms_national_regex_row <span class="token operator">=</span> <span class="token string">'(%s)%s(%s)%s(%s)%s(%s)%s(%s)%s(%s)%s(%s)'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>series_of_words_regex <span class="token punctuation">,</span> space_new_regex<span class="token punctuation">,</span> integer_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> phone_number_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> disk_space_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> currency_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> currency_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> currency_regex<span class="token punctuation">)</span></span>
<span class="line">calls_phone_regex_row <span class="token operator">=</span> <span class="token string">'(%s)%s(%s)%s(%s)%s(%s)%s(%s)'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>series_of_words_regex <span class="token punctuation">,</span> space_new_regex<span class="token punctuation">,</span> duration_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> phone_number_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> currency_regex <span class="token punctuation">,</span> space_new_regex <span class="token punctuation">,</span> duration_regex<span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line"><span class="token comment">#########################</span></span>
<span class="line"><span class="token comment">#    GET NODES!!! the nodes is a list of dictionaries, and the dictionaries have values of date_time &amp; data</span></span>
<span class="line"><span class="token comment">#########################</span></span>
<span class="line"><span class="token keyword keyword-for">for</span> input_file <span class="token keyword keyword-in">in</span> input_files<span class="token punctuation">:</span></span>
<span class="line">	input_file_path <span class="token operator">=</span> input_base_path <span class="token operator">+</span> input_file</span>
<span class="line">	<span class="token keyword keyword-with">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>input_file_path<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> f<span class="token punctuation">:</span></span>
<span class="line">		lines <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token keyword keyword-for">for</span> index<span class="token punctuation">,</span>line <span class="token keyword keyword-in">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>lines<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">			<span class="token comment">#IF IT STARTS WITH DATE &amp; TIME</span></span>
<span class="line">			<span class="token keyword keyword-if">if</span> regex<span class="token punctuation">.</span>match<span class="token punctuation">(</span><span class="token string">"^"</span> <span class="token operator">+</span> any_regex <span class="token operator">+</span> date_time_regex<span class="token punctuation">,</span>line<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">				date_time <span class="token operator">=</span> regex<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>date_regex<span class="token punctuation">,</span>line<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> regex<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>time_regex<span class="token punctuation">,</span>line<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">				data <span class="token operator">=</span> regex<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>date_time_regex <span class="token operator">+</span> <span class="token string">"(.*)"</span> <span class="token operator">+</span> look_end_regex<span class="token punctuation">,</span>line<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">				nodes<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'date_time'</span><span class="token punctuation">:</span>date_time<span class="token punctuation">,</span><span class="token string">'data'</span><span class="token punctuation">:</span>data<span class="token punctuation">,</span><span class="token string">'file'</span><span class="token punctuation">:</span>input_file<span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">				<span class="token comment"># pass</span></span>
<span class="line">			<span class="token comment">#handles the very weird situation of DATE + DATA + TIME</span></span>
<span class="line">			<span class="token keyword keyword-if">if</span> regex<span class="token punctuation">.</span>match<span class="token punctuation">(</span><span class="token string">"^"</span> <span class="token operator">+</span> time_regex <span class="token operator">+</span> <span class="token string">"$"</span><span class="token punctuation">,</span>line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">				<span class="token comment">#get date</span></span>
<span class="line">				date <span class="token operator">=</span> lines<span class="token punctuation">[</span>index<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">				<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>regex<span class="token punctuation">.</span>match<span class="token punctuation">(</span>date_regex<span class="token punctuation">,</span>date<span class="token punctuation">)</span> <span class="token keyword keyword-is">is</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">					<span class="token keyword keyword-for">for</span> i <span class="token keyword keyword-in">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">						<span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">							date <span class="token operator">=</span> regex<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>date_regex<span class="token punctuation">,</span>nodes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'date_time'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">						<span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">							<span class="token keyword keyword-continue">continue</span></span>
<span class="line">				date_time <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">				data <span class="token operator">=</span> lines<span class="token punctuation">[</span>index<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">				nodes<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'date_time'</span><span class="token punctuation">:</span>date_time<span class="token punctuation">,</span><span class="token string">'data'</span><span class="token punctuation">:</span>data<span class="token punctuation">,</span><span class="token string">'file'</span><span class="token punctuation">:</span>input_file<span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line"><span class="token comment">#########################</span></span>
<span class="line"><span class="token comment">#    CLIENT</span></span>
<span class="line"><span class="token comment">#########################</span></span>
<span class="line"><span class="token comment">#Inside File</span></span>
<span class="line">csv_all_handle <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>csv_all_file_path<span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span></span>
<span class="line">csv_filtered_handle <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>csv_filtered_file_path<span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span></span>
<span class="line">csv_rules_handle <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>csv_rules_file_path<span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword keyword-for">for</span> node <span class="token keyword keyword-in">in</span> nodes<span class="token punctuation">:</span></span>
<span class="line">	<span class="token comment">#if the row is not neat, it will reflect in the default if statement below</span></span>
<span class="line">	ignore_row <span class="token operator">=</span> <span class="token boolean">False</span></span>
<span class="line">	date_time <span class="token operator">=</span> node<span class="token punctuation">[</span><span class="token string">'date_time'</span><span class="token punctuation">]</span></span>
<span class="line">	messy_line <span class="token operator">=</span> node<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span></span>
<span class="line">	<span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">		<span class="token comment">#VARIABLES THAT WILL BE IN THE ROW</span></span>
<span class="line">		<span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">			time_tuple <span class="token operator">=</span> time<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>date_time<span class="token punctuation">,</span><span class="token string">"%Y-%m-%d %H:%M:%S"</span><span class="token punctuation">)</span></span>
<span class="line">			date_row_value <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%d/%m/%Y %H:%M:%S'</span><span class="token punctuation">,</span> time_tuple<span class="token punctuation">)</span></span>
<span class="line">			description_date_value <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%H:%M'</span><span class="token punctuation">,</span> time_tuple<span class="token punctuation">)</span></span>
<span class="line">		<span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">			<span class="token comment">#if reaching here, the row will likely not even show up</span></span>
<span class="line">			overall_date <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line">			date_row_value <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line">			description_date_value <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line">		<span class="token comment">#Note: string is already stripped in regex_groups function as it calls the strip_iterate function</span></span>
<span class="line">		<span class="token comment">#CALL SCHEMA (MOBILE)!!! (follows call structure define above)!!!</span></span>
<span class="line">		<span class="token comment">#['Call', 'to', 'non-Optus', 'GSM', '01:35', '0412977644', '0.00MB', '$2.15000', '$0.00000', '$0.00000']</span></span>
<span class="line">		<span class="token keyword keyword-if">if</span> regex_groups<span class="token punctuation">(</span>calls_mobile_regex_row<span class="token punctuation">,</span>messy_line<span class="token punctuation">)</span> <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">			schema <span class="token operator">=</span> <span class="token string">'mobile'</span></span>
<span class="line">			rgo <span class="token operator">=</span> regex_groups<span class="token punctuation">(</span>calls_mobile_regex_row<span class="token punctuation">,</span>messy_line<span class="token punctuation">)</span></span>
<span class="line">			usage_type <span class="token operator">=</span> l<span class="token punctuation">(</span>rgo<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">			duration <span class="token operator">=</span> l<span class="token punctuation">(</span>rgo<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">			called_number <span class="token operator">=</span> l<span class="token punctuation">(</span>rgo<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">			<span class="token comment"># debug</span></span>
<span class="line">			<span class="token comment"># print("CALL",row)</span></span>
<span class="line">			<span class="token comment"># pass</span></span>
<span class="line">		<span class="token comment">#DATA SCHEMA (follows data structure define above)!!!</span></span>
<span class="line">		<span class="token comment">#['Data', '5.85MB', '5.85MB', '$0.00000', '$0.00000', '$0.00000']</span></span>
<span class="line">		<span class="token keyword keyword-elif">elif</span> regex_groups<span class="token punctuation">(</span>data_regex_row<span class="token punctuation">,</span>messy_line<span class="token punctuation">)</span> <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">			<span class="token comment">#according to Sarah, ignore all data</span></span>
<span class="line">			ignore_row <span class="token operator">=</span> <span class="token boolean">True</span></span>
<span class="line">			<span class="token comment"># debug</span></span>
<span class="line">			<span class="token comment"># print("DATA",row)</span></span>
<span class="line">			<span class="token comment"># pass</span></span>
<span class="line">		<span class="token comment">#SMS NATIONAL TYPE OF DATA SCHEMA</span></span>
<span class="line">		<span class="token comment">#['SMS', 'National', '1', '0406665748', '0.00MB', '$0.00000', '$0.00000', '$0.00000']</span></span>
<span class="line">		<span class="token keyword keyword-elif">elif</span> regex_groups<span class="token punctuation">(</span>sms_national_regex_row<span class="token punctuation">,</span>messy_line<span class="token punctuation">)</span> <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">			schema <span class="token operator">=</span> <span class="token string">'sms_national'</span></span>
<span class="line">			rgo <span class="token operator">=</span> regex_groups<span class="token punctuation">(</span>sms_national_regex_row<span class="token punctuation">,</span>messy_line<span class="token punctuation">)</span></span>
<span class="line">			usage_type <span class="token operator">=</span> l<span class="token punctuation">(</span>rgo<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">			duration <span class="token operator">=</span> l<span class="token punctuation">(</span>rgo<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">			called_number <span class="token operator">=</span> l<span class="token punctuation">(</span>rgo<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">			<span class="token comment"># print("SMS",row)</span></span>
<span class="line">			<span class="token comment"># pass</span></span>
<span class="line">		<span class="token comment">#CALL PHONE!!</span></span>
<span class="line">		<span class="token keyword keyword-elif">elif</span> regex_groups<span class="token punctuation">(</span>calls_phone_regex_row<span class="token punctuation">,</span>messy_line<span class="token punctuation">)</span> <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">			schema <span class="token operator">=</span> <span class="token string">'phone'</span></span>
<span class="line">			rgo <span class="token operator">=</span> regex_groups<span class="token punctuation">(</span>calls_phone_regex_row<span class="token punctuation">,</span>messy_line<span class="token punctuation">)</span></span>
<span class="line">			usage_type <span class="token operator">=</span> l<span class="token punctuation">(</span>rgo<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">			duration <span class="token operator">=</span> l<span class="token punctuation">(</span>rgo<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">			called_number <span class="token operator">=</span> l<span class="token punctuation">(</span>rgo<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">			<span class="token comment"># print("PHONE", row) </span></span>
<span class="line">			<span class="token keyword keyword-pass">pass</span></span>
<span class="line">		<span class="token comment">#Fits No Criteria</span></span>
<span class="line">		<span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>	</span>
<span class="line">			ignore_row <span class="token operator">=</span> <span class="token boolean">True</span></span>
<span class="line">			<span class="token keyword keyword-pass">pass</span></span>
<span class="line">		<span class="token comment">#is_sms? </span></span>
<span class="line">		is_sms <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword keyword-if">if</span> <span class="token string">'sms'</span> <span class="token keyword keyword-in">in</span> usage_type<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-else">else</span> <span class="token number">0</span></span>
<span class="line">		<span class="token comment">#what is person's name in the rule sheet</span></span>
<span class="line">		person_name <span class="token operator">=</span> dvkp<span class="token punctuation">(</span>rules_d<span class="token punctuation">,</span>called_number<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">		describe_event <span class="token operator">=</span> <span class="token string">'At %s I called %s and spoke with %s on the telephone.'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>description_date_value<span class="token punctuation">,</span> called_number<span class="token punctuation">,</span> person_name<span class="token punctuation">)</span></span>
<span class="line">		input_file <span class="token operator">=</span> node<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span></span>
<span class="line">	<span class="token keyword keyword-except">except</span> KeyError<span class="token punctuation">:</span></span>
<span class="line">		<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"KeyError in "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token keyword keyword-pass">pass</span></span>
<span class="line">	<span class="token keyword keyword-except">except</span> IndexError<span class="token punctuation">:</span></span>
<span class="line">		<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"IndexError in "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token keyword keyword-pass">pass</span></span>
<span class="line">	<span class="token keyword keyword-except">except</span> ValueError<span class="token punctuation">:</span></span>
<span class="line">		<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"ValueError in "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token keyword keyword-pass">pass</span></span>
<span class="line">	<span class="token keyword keyword-except">except</span> TypeError<span class="token punctuation">:</span></span>
<span class="line">		<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"TypeError in "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token keyword keyword-pass">pass</span></span>
<span class="line"> </span>
<span class="line">	<span class="token comment">#########################</span></span>
<span class="line">	<span class="token comment">#    WRITE CSV ROW HERE</span></span>
<span class="line">	<span class="token comment">#########################</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>ignore_row <span class="token operator">==</span> <span class="token boolean">False</span> <span class="token keyword keyword-and">and</span> date_row_value <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">		row <span class="token operator">=</span> <span class="token punctuation">[</span>date_row_value<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>is_sms<span class="token punctuation">,</span>called_number<span class="token punctuation">,</span>input_file<span class="token punctuation">]</span></span>
<span class="line">		<span class="token comment"># print(row)</span></span>
<span class="line">		csv_all_handle<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">,</span>row<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">		csv_all_handle<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span></span>
<span class="line">		csv_all_handle<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token comment">#FILTERED SHEET</span></span>
<span class="line">	<span class="token comment">#ignore row here means don't print data</span></span>
<span class="line">	<span class="token comment">#person_name filter means only show values inside the rules section</span></span>
<span class="line">	<span class="token comment">#date_row_value means don't show funny looking rows</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>ignore_row <span class="token operator">==</span> <span class="token boolean">False</span> <span class="token keyword keyword-and">and</span> date_row_value <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">None</span> <span class="token keyword keyword-and">and</span> person_name <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">		row <span class="token operator">=</span> <span class="token punctuation">[</span>date_row_value<span class="token punctuation">,</span>duration<span class="token punctuation">,</span>is_sms<span class="token punctuation">,</span>describe_event<span class="token punctuation">,</span>input_file<span class="token punctuation">]</span></span>
<span class="line">		<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span></span>
<span class="line">		<span class="token comment">#record tallies for the next rules csv sheet</span></span>
<span class="line">		rules_count_d<span class="token punctuation">[</span>called_number<span class="token punctuation">]</span><span class="token punctuation">[</span>input_file<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span></span>
<span class="line">		<span class="token comment"># print(rules_count_d)</span></span>
<span class="line">		csv_filtered_handle<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">,</span>row<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">		csv_filtered_handle<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span></span>
<span class="line">		csv_filtered_handle<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line"><span class="token comment">#########################</span></span>
<span class="line"><span class="token comment">#    WORK ON RULES CSV FILE</span></span>
<span class="line"><span class="token comment">#########################</span></span>
<span class="line"><span class="token comment"># for phone_number,node in rules_count_d.items():</span></span>
<span class="line"><span class="token comment"># 	row = [node[input_file] for input_file in input_files]</span></span>
<span class="line"><span class="token comment"># 	total_sum = sum(row)</span></span>
<span class="line"><span class="token comment"># 	row.insert(0,node['name'])</span></span>
<span class="line"><span class="token comment"># 	row.insert(1,phone_number)</span></span>
<span class="line"><span class="token comment"># 	row.append(total_sum)</span></span>
<span class="line"><span class="token comment"># 	csv_rules_handle.write(str(','.join(list(map(str,row)))))</span></span>
<span class="line"><span class="token comment"># 	csv_rules_handle.write('\n')</span></span>
<span class="line"><span class="token comment"># 	csv_rules_handle.flush()</span></span>
<span class="line">Netconf</span>
<span class="line">Network Automation via NETCONF <span class="token operator">+</span> Configure both CLI<span class="token operator">/</span>NETCONF via Python<span class="token punctuation">,</span> to analyze <span class="token builtin">all</span> the key<span class="token operator">/</span>value pairs <span class="token operator">&amp;</span> configurable values <span class="token keyword keyword-in">in</span> a Cisco CSR V1000 router<span class="token punctuation">.</span> Subclassing was separate <span class="token keyword keyword-for">for</span> Netconf <span class="token operator">&amp;</span> regular CLI<span class="token punctuation">.</span></span>
<span class="line">Python</span>
<span class="line">Click <span class="token keyword keyword-for">for</span> Portfolio</span>
<span class="line"><span class="token keyword keyword-import">import</span> paramiko</span>
<span class="line"><span class="token keyword keyword-import">import</span> xmltodict</span>
<span class="line"><span class="token keyword keyword-import">import</span> xml</span>
<span class="line"><span class="token keyword keyword-import">import</span> pprint</span>
<span class="line"><span class="token keyword keyword-import">import</span> sys</span>
<span class="line"><span class="token keyword keyword-from">from</span> helpers <span class="token keyword keyword-import">import</span> <span class="token operator">*</span></span>
<span class="line"><span class="token keyword keyword-from">from</span> time <span class="token keyword keyword-import">import</span> sleep</span>
<span class="line"><span class="token keyword keyword-from">from</span> functools <span class="token keyword keyword-import">import</span> partial</span>
<span class="line"><span class="token keyword keyword-from">from</span> bs4 <span class="token keyword keyword-import">import</span> BeautifulSoup</span>
<span class="line"><span class="token keyword keyword-from">from</span> itertools <span class="token keyword keyword-import">import</span> cycle</span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">SSH</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    client <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line">    session <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line">    read_interval <span class="token operator">=</span> <span class="token number">.5</span></span>
<span class="line">    connect_params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"hostname"</span><span class="token punctuation">:</span> <span class="token string">"192.168.0.201"</span><span class="token punctuation">,</span> <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"goon"</span><span class="token punctuation">,</span></span>
<span class="line">                      <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string">"goon"</span><span class="token punctuation">,</span> <span class="token string">"port"</span><span class="token punctuation">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string">"look_for_keys"</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"allow_agent"</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">}</span></span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">read</span></span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        blocks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">        chunk_size <span class="token operator">=</span> <span class="token number">2524</span></span>
<span class="line">        <span class="token keyword keyword-while">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></span>
<span class="line">            sleep<span class="token punctuation">(</span>self<span class="token punctuation">.</span>read_interval<span class="token punctuation">)</span></span>
<span class="line">            block <span class="token operator">=</span> self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>chunk_size<span class="token punctuation">)</span></span>
<span class="line">            <span class="token comment"># DEBUG</span></span>
<span class="line">            <span class="token comment"># print(block.decode(),end="")</span></span>
<span class="line">            <span class="token comment"># file_add_contents("add.xml",block.decode())</span></span>
<span class="line">            <span class="token comment"># end debug</span></span>
<span class="line">            blocks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>block<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>block<span class="token punctuation">)</span> <span class="token operator">&lt;</span> chunk_size<span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword keyword-break">break</span></span>
<span class="line">        text <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>blocks<span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> text</span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">start</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>client <span class="token operator">=</span> paramiko<span class="token punctuation">.</span>SSHClient<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># overrides the default above</span></span>
<span class="line">        self<span class="token punctuation">.</span>connect_params<span class="token punctuation">.</span>update<span class="token punctuation">(</span>kwargs<span class="token punctuation">)</span></span>
<span class="line">        hostname <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"hostname"</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-del">del</span> self<span class="token punctuation">.</span>connect_params<span class="token punctuation">[</span><span class="token string">'hostname'</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token comment"># debug</span></span>
<span class="line">        <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"LOGGING INTO:"</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>hostname<span class="token punctuation">,</span> self<span class="token punctuation">.</span>connect_params<span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>set_missing_host_key_policy<span class="token punctuation">(</span>paramiko<span class="token punctuation">.</span>AutoAddPolicy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>hostname<span class="token punctuation">,</span> <span class="token operator">**</span>self<span class="token punctuation">.</span>connect_params<span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>session <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>get_transport<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>open_session<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># Only uncomment if sending command line arguments. Separate into separate class or function if expands.</span></span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">s</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token triple-quoted-string string">'''console shorthand'''</span></span>
<span class="line">        self<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">close</span></span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"SSH Session Closed"</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">CommandLine</span><span class="token punctuation">(</span>SSH<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">'''Command Line Specific'''</span></span>
<span class="line">    <span class="token comment"># port 22</span></span>
<span class="line">    connect_params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'hostname'</span><span class="token punctuation">:</span> <span class="token string">'10.10.20.48'</span><span class="token punctuation">,</span> <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'cisco'</span><span class="token punctuation">,</span></span>
<span class="line">                      <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'cisco_1234!'</span><span class="token punctuation">,</span> <span class="token string">'port'</span><span class="token punctuation">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string">'look_for_keys'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'allow_agent'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">}</span></span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">__init__</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># invoke shell is specific to Command Lines (not netconf)</span></span>
<span class="line">        self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>invoke_shell<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">send</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> command<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        command <span class="token operator">=</span> command <span class="token operator">+</span> <span class="token string">"\n"</span></span>
<span class="line">        self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>send<span class="token punctuation">(</span>command<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        response <span class="token operator">=</span> self<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> response</span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">Netconf</span><span class="token punctuation">(</span>SSH<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">'''Class &amp; Functions &amp; Values specific to NETCONF'''</span></span>
<span class="line">    <span class="token comment">#</span></span>
<span class="line">    <span class="token comment"># Cisco DevNet Params</span></span>
<span class="line">    <span class="token comment"># port 830</span></span>
<span class="line">    <span class="token comment">#</span></span>
<span class="line">    cisco_namespace_prefix <span class="token operator">=</span> <span class="token string">'http://cisco.com/ns/yang/'</span></span>
<span class="line">    ietf_namespace_prefix <span class="token operator">=</span> <span class="token string">'urn:ietf:params:xml:ns:yang:'</span></span>
<span class="line">    connect_params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'hostname'</span><span class="token punctuation">:</span> <span class="token string">'10.10.20.48'</span><span class="token punctuation">,</span> <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'cisco'</span><span class="token punctuation">,</span></span>
<span class="line">                      <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'cisco_1234!'</span><span class="token punctuation">,</span> <span class="token string">'port'</span><span class="token punctuation">:</span> <span class="token number">830</span><span class="token punctuation">,</span> <span class="token string">'look_for_keys'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'allow_agent'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">}</span></span>
<span class="line">    terminator <span class="token operator">=</span> <span class="token string">']]&gt;]]&gt;'</span></span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">__init__</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># Cisco Devnet Params</span></span>
<span class="line">        self<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>netconf_hello<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">n</span></span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token triple-quoted-string string">'''console restart socket &amp; netflow shorthand'''</span></span>
<span class="line">        self<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>netconf_hello<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">send</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> command<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        command <span class="token operator">=</span> command <span class="token operator">+</span> self<span class="token punctuation">.</span>terminator <span class="token operator">+</span> <span class="token string">"/n"</span></span>
<span class="line">        self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>send<span class="token punctuation">(</span>command<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        response <span class="token operator">=</span> self<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> response</span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">netconf_hello</span></span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>invoke_subsystem<span class="token punctuation">(</span><span class="token string">'netconf'</span><span class="token punctuation">)</span></span>
<span class="line">        hello_rpc <span class="token operator">=</span> <span class="token string">'&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;hello xmlns="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;&lt;capabilities&gt;&lt;capability&gt;urn:ietf:params:netconf:base:1.0&lt;/capability&gt;&lt;/capabilities&gt;&lt;/hello&gt;'</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>hello_rpc<span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">change_hostname</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> hostname<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span></span>
<span class="line">            <span class="token string-interpolation"><span class="token string">f'&lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;rpc message-id="101" xmlns="urn:ietf:params:xml:ns:netconf:base:1.0"&gt; &lt;edit-config&gt; &lt;target&gt; &lt;running/&gt; &lt;/target&gt; &lt;config&gt; &lt;cli-config-data&gt; &lt;cmd&gt;hostname </span><span class="token interpolation"><span class="token punctuation">{</span>hostname<span class="token punctuation">}</span></span><span class="token string">&lt;/cmd&gt; &lt;/cli-config-data&gt; &lt;/config&gt; &lt;/edit-config&gt; &lt;/rpc&gt;'</span></span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">print_netconf_graph</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> xml_response<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        xml_response <span class="token operator">=</span> xml_response<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>self<span class="token punctuation">.</span>terminator<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">            print_structure<span class="token punctuation">(</span>xmltodict<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>xml_response<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-except">except</span> xml<span class="token punctuation">.</span>parsers<span class="token punctuation">.</span>expat<span class="token punctuation">.</span>ExpatError<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Your XML is structured wrong"</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">console_send</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> xml_filepath<span class="token operator">=</span><span class="token string">"payload.txt"</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token triple-quoted-string string">'''meant for consoles. filename with XML to send must be in payload.txt'''</span></span>
<span class="line">        self<span class="token punctuation">.</span>print_netconf_graph<span class="token punctuation">(</span>n<span class="token punctuation">.</span>send<span class="token punctuation">(</span>file_get_contents<span class="token punctuation">(</span>xml_filepath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">filter</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        rpc_get <span class="token operator">=</span> <span class="token string">'&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;rpc message-id="101" xmlns="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;&lt;get&gt;&lt;filter&gt;'</span> <span class="token operator">+</span> \</span>
<span class="line">            <span class="token builtin">filter</span> <span class="token operator">+</span> <span class="token string">'&lt;/filter&gt;&lt;/get&gt;&lt;/rpc&gt;'</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>rpc_get<span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">edit_config</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">filter</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        rpc_edit_config <span class="token operator">=</span> <span class="token string">'&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;rpc xmlns="urn:ietf:params:xml:ns:netconf:base:1.0" message-id="111"&gt;&lt;edit-config&gt;&lt;target&gt;&lt;running/&gt;&lt;/target&gt;&lt;config&gt;'</span> <span class="token operator">+</span> \</span>
<span class="line">            <span class="token builtin">filter</span> <span class="token operator">+</span> <span class="token string">'&lt;/config&gt;&lt;/edit-config&gt;&lt;/rpc&gt;'</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>rpc_edit_config<span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">pretty_print_xml</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ugly_xml<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        bs <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>ugly_xml<span class="token punctuation">,</span> <span class="token string">'xml'</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>bs<span class="token punctuation">.</span>prettify<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line"><span class="token keyword keyword-if">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment">#cisco_namespace_prefix = "http://cisco.com/ns/yang/"</span></span>
<span class="line">        <span class="token comment">#ietf_namespace_prefix = "urn:ietf:params:xml:ns:yang:"</span></span>
<span class="line">        <span class="token comment"># CISCO DEVNET! CISCO ANYCONNECT MUST BE ACTIVATED</span></span>
<span class="line">        cs <span class="token operator">=</span> Netconf<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        client <span class="token operator">=</span> cs<span class="token punctuation">.</span>client</span>
<span class="line">        rpc_fragment <span class="token operator">=</span> <span class="token triple-quoted-string string">'''&lt;interfaces xmlns="http://cisco.com/ns/yang/Cisco-IOS-XE-interfaces-oper"&gt;</span>
<span class="line">		&lt;interface&gt;</span>
<span class="line">		&lt;name&gt;GigabitEthernet2&lt;/name&gt;</span>
<span class="line">		</span>
<span class="line">		&lt;/interface&gt;</span>
<span class="line">		&lt;/interfaces&gt;'''</span></span>
<span class="line"> </span>
<span class="line">        <span class="token keyword keyword-for">for</span> octet_4 <span class="token keyword keyword-in">in</span> cycle<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            rpc_fragment <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'&lt;interfaces xmlns="urn:ietf:params:xml:ns:yang:ietf-interfaces"&gt; &lt;interface operation="replace"&gt; &lt;name&gt; GigabitEthernet2 &lt;/name&gt; &lt;description&gt; GOON &lt;/description&gt; &lt;type xmlns:ianaift="urn:ietf:params:xml:ns:yang:iana-if-type"&gt; ianaift:ethernetCsmacd &lt;/type&gt; &lt;enabled&gt; true &lt;/enabled&gt; &lt;ipv4 xmlns="urn:ietf:params:xml:ns:yang:ietf-ip"&gt; &lt;address&gt; &lt;ip&gt; 10.10.50.</span><span class="token interpolation"><span class="token punctuation">{</span>octet_4<span class="token punctuation">}</span></span><span class="token string"> &lt;/ip&gt; &lt;netmask&gt; 255.255.255.0 &lt;/netmask&gt; &lt;/address&gt; &lt;/ipv4&gt; &lt;/interface&gt; &lt;/interfaces&gt; '</span></span></span>
<span class="line">            xml_response <span class="token operator">=</span> cs<span class="token punctuation">.</span>edit_config<span class="token punctuation">(</span>rpc_fragment<span class="token punctuation">)</span></span>
<span class="line">        xml_response <span class="token operator">=</span> cs<span class="token punctuation">.</span>get<span class="token punctuation">(</span>rpc_fragment<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>xml_response<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-finally">finally</span><span class="token punctuation">:</span></span>
<span class="line">        sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Netconf</div>
                <div class="description">Network Automation via NETCONF + Configure both CLI/NETCONF via Python, to analyze all the key/value pairs &amp; configurable values in a Cisco CSR V1000 router. Subclassing was separate for Netconf &amp; regular CLI.</div>
                <div class="languages">Python</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-python" tabindex="0">                <code class="language-python"><span class="line"><span class="token keyword keyword-import">import</span> paramiko</span>
<span class="line"><span class="token keyword keyword-import">import</span> xmltodict</span>
<span class="line"><span class="token keyword keyword-import">import</span> xml</span>
<span class="line"><span class="token keyword keyword-import">import</span> pprint</span>
<span class="line"><span class="token keyword keyword-import">import</span> sys</span>
<span class="line"><span class="token keyword keyword-from">from</span> helpers <span class="token keyword keyword-import">import</span> <span class="token operator">*</span></span>
<span class="line"><span class="token keyword keyword-from">from</span> time <span class="token keyword keyword-import">import</span> sleep</span>
<span class="line"><span class="token keyword keyword-from">from</span> functools <span class="token keyword keyword-import">import</span> partial</span>
<span class="line"><span class="token keyword keyword-from">from</span> bs4 <span class="token keyword keyword-import">import</span> BeautifulSoup</span>
<span class="line"><span class="token keyword keyword-from">from</span> itertools <span class="token keyword keyword-import">import</span> cycle</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">SSH</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    client <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line">    session <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line">    read_interval <span class="token operator">=</span> <span class="token number">.5</span></span>
<span class="line">    connect_params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"hostname"</span><span class="token punctuation">:</span> <span class="token string">"192.168.0.201"</span><span class="token punctuation">,</span> <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"goon"</span><span class="token punctuation">,</span></span>
<span class="line">                      <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string">"goon"</span><span class="token punctuation">,</span> <span class="token string">"port"</span><span class="token punctuation">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string">"look_for_keys"</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"allow_agent"</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">read</span></span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        blocks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">        chunk_size <span class="token operator">=</span> <span class="token number">2524</span></span>
<span class="line">        <span class="token keyword keyword-while">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></span>
<span class="line">            sleep<span class="token punctuation">(</span>self<span class="token punctuation">.</span>read_interval<span class="token punctuation">)</span></span>
<span class="line">            block <span class="token operator">=</span> self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>chunk_size<span class="token punctuation">)</span></span>
<span class="line">            <span class="token comment"># DEBUG</span></span>
<span class="line">            <span class="token comment"># print(block.decode(),end="")</span></span>
<span class="line">            <span class="token comment"># file_add_contents("add.xml",block.decode())</span></span>
<span class="line">            <span class="token comment"># end debug</span></span>
<span class="line">            blocks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>block<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>block<span class="token punctuation">)</span> <span class="token operator">&lt;</span> chunk_size<span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword keyword-break">break</span></span>
<span class="line">        text <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>blocks<span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> text</span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">start</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>client <span class="token operator">=</span> paramiko<span class="token punctuation">.</span>SSHClient<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># overrides the default above</span></span>
<span class="line">        self<span class="token punctuation">.</span>connect_params<span class="token punctuation">.</span>update<span class="token punctuation">(</span>kwargs<span class="token punctuation">)</span></span>
<span class="line">        hostname <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"hostname"</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-del">del</span> self<span class="token punctuation">.</span>connect_params<span class="token punctuation">[</span><span class="token string">'hostname'</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token comment"># debug</span></span>
<span class="line">        <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"LOGGING INTO:"</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>hostname<span class="token punctuation">,</span> self<span class="token punctuation">.</span>connect_params<span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>set_missing_host_key_policy<span class="token punctuation">(</span>paramiko<span class="token punctuation">.</span>AutoAddPolicy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>hostname<span class="token punctuation">,</span> <span class="token operator">**</span>self<span class="token punctuation">.</span>connect_params<span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>session <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>get_transport<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>open_session<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># Only uncomment if sending command line arguments. Separate into separate class or function if expands.</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">s</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token triple-quoted-string string">'''console shorthand'''</span></span>
<span class="line">        self<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">close</span></span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"SSH Session Closed"</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">CommandLine</span><span class="token punctuation">(</span>SSH<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">'''Command Line Specific'''</span></span>
<span class="line">    <span class="token comment"># port 22</span></span>
<span class="line">    connect_params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'hostname'</span><span class="token punctuation">:</span> <span class="token string">'10.10.20.48'</span><span class="token punctuation">,</span> <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'cisco'</span><span class="token punctuation">,</span></span>
<span class="line">                      <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'cisco_1234!'</span><span class="token punctuation">,</span> <span class="token string">'port'</span><span class="token punctuation">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string">'look_for_keys'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'allow_agent'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">__init__</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># invoke shell is specific to Command Lines (not netconf)</span></span>
<span class="line">        self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>invoke_shell<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">send</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> command<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        command <span class="token operator">=</span> command <span class="token operator">+</span> <span class="token string">"\n"</span></span>
<span class="line">        self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>send<span class="token punctuation">(</span>command<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        response <span class="token operator">=</span> self<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> response</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">Netconf</span><span class="token punctuation">(</span>SSH<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">'''Class &amp; Functions &amp; Values specific to NETCONF'''</span></span>
<span class="line">    <span class="token comment">#</span></span>
<span class="line">    <span class="token comment"># Cisco DevNet Params</span></span>
<span class="line">    <span class="token comment"># port 830</span></span>
<span class="line">    <span class="token comment">#</span></span>
<span class="line">    cisco_namespace_prefix <span class="token operator">=</span> <span class="token string">'http://cisco.com/ns/yang/'</span></span>
<span class="line">    ietf_namespace_prefix <span class="token operator">=</span> <span class="token string">'urn:ietf:params:xml:ns:yang:'</span></span>
<span class="line">    connect_params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'hostname'</span><span class="token punctuation">:</span> <span class="token string">'10.10.20.48'</span><span class="token punctuation">,</span> <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'cisco'</span><span class="token punctuation">,</span></span>
<span class="line">                      <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'cisco_1234!'</span><span class="token punctuation">,</span> <span class="token string">'port'</span><span class="token punctuation">:</span> <span class="token number">830</span><span class="token punctuation">,</span> <span class="token string">'look_for_keys'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'allow_agent'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">}</span></span>
<span class="line">    terminator <span class="token operator">=</span> <span class="token string">']]&gt;]]&gt;'</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">__init__</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># Cisco Devnet Params</span></span>
<span class="line">        self<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>netconf_hello<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">n</span></span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token triple-quoted-string string">'''console restart socket &amp; netflow shorthand'''</span></span>
<span class="line">        self<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>netconf_hello<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">send</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> command<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        command <span class="token operator">=</span> command <span class="token operator">+</span> self<span class="token punctuation">.</span>terminator <span class="token operator">+</span> <span class="token string">"/n"</span></span>
<span class="line">        self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>send<span class="token punctuation">(</span>command<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        response <span class="token operator">=</span> self<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> response</span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">netconf_hello</span></span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>invoke_subsystem<span class="token punctuation">(</span><span class="token string">'netconf'</span><span class="token punctuation">)</span></span>
<span class="line">        hello_rpc <span class="token operator">=</span> <span class="token string">'&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;hello xmlns="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;&lt;capabilities&gt;&lt;capability&gt;urn:ietf:params:netconf:base:1.0&lt;/capability&gt;&lt;/capabilities&gt;&lt;/hello&gt;'</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>hello_rpc<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">change_hostname</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> hostname<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span></span>
<span class="line">            <span class="token string-interpolation"><span class="token string">f'&lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;rpc message-id="101" xmlns="urn:ietf:params:xml:ns:netconf:base:1.0"&gt; &lt;edit-config&gt; &lt;target&gt; &lt;running/&gt; &lt;/target&gt; &lt;config&gt; &lt;cli-config-data&gt; &lt;cmd&gt;hostname </span><span class="token interpolation"><span class="token punctuation">{</span>hostname<span class="token punctuation">}</span></span><span class="token string">&lt;/cmd&gt; &lt;/cli-config-data&gt; &lt;/config&gt; &lt;/edit-config&gt; &lt;/rpc&gt;'</span></span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">print_netconf_graph</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> xml_response<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        xml_response <span class="token operator">=</span> xml_response<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>self<span class="token punctuation">.</span>terminator<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">            print_structure<span class="token punctuation">(</span>xmltodict<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>xml_response<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-except">except</span> xml<span class="token punctuation">.</span>parsers<span class="token punctuation">.</span>expat<span class="token punctuation">.</span>ExpatError<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Your XML is structured wrong"</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">console_send</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> xml_filepath<span class="token operator">=</span><span class="token string">"payload.txt"</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token triple-quoted-string string">'''meant for consoles. filename with XML to send must be in payload.txt'''</span></span>
<span class="line">        self<span class="token punctuation">.</span>print_netconf_graph<span class="token punctuation">(</span>n<span class="token punctuation">.</span>send<span class="token punctuation">(</span>file_get_contents<span class="token punctuation">(</span>xml_filepath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">filter</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        rpc_get <span class="token operator">=</span> <span class="token string">'&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;rpc message-id="101" xmlns="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;&lt;get&gt;&lt;filter&gt;'</span> <span class="token operator">+</span> \</span>
<span class="line">            <span class="token builtin">filter</span> <span class="token operator">+</span> <span class="token string">'&lt;/filter&gt;&lt;/get&gt;&lt;/rpc&gt;'</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>rpc_get<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">edit_config</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">filter</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        rpc_edit_config <span class="token operator">=</span> <span class="token string">'&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;rpc xmlns="urn:ietf:params:xml:ns:netconf:base:1.0" message-id="111"&gt;&lt;edit-config&gt;&lt;target&gt;&lt;running/&gt;&lt;/target&gt;&lt;config&gt;'</span> <span class="token operator">+</span> \</span>
<span class="line">            <span class="token builtin">filter</span> <span class="token operator">+</span> <span class="token string">'&lt;/config&gt;&lt;/edit-config&gt;&lt;/rpc&gt;'</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>rpc_edit_config<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">pretty_print_xml</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ugly_xml<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        bs <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>ugly_xml<span class="token punctuation">,</span> <span class="token string">'xml'</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>bs<span class="token punctuation">.</span>prettify<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-if">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment">#cisco_namespace_prefix = "http://cisco.com/ns/yang/"</span></span>
<span class="line">        <span class="token comment">#ietf_namespace_prefix = "urn:ietf:params:xml:ns:yang:"</span></span>
<span class="line">        <span class="token comment"># CISCO DEVNET! CISCO ANYCONNECT MUST BE ACTIVATED</span></span>
<span class="line">        cs <span class="token operator">=</span> Netconf<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        client <span class="token operator">=</span> cs<span class="token punctuation">.</span>client</span>
<span class="line">        rpc_fragment <span class="token operator">=</span> <span class="token triple-quoted-string string">'''&lt;interfaces xmlns="http://cisco.com/ns/yang/Cisco-IOS-XE-interfaces-oper"&gt;</span>
<span class="line">		&lt;interface&gt;</span>
<span class="line">		&lt;name&gt;GigabitEthernet2&lt;/name&gt;</span>
<span class="line">		</span>
<span class="line">		&lt;/interface&gt;</span>
<span class="line">		&lt;/interfaces&gt;'''</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token keyword keyword-for">for</span> octet_4 <span class="token keyword keyword-in">in</span> cycle<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            rpc_fragment <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'&lt;interfaces xmlns="urn:ietf:params:xml:ns:yang:ietf-interfaces"&gt; &lt;interface operation="replace"&gt; &lt;name&gt; GigabitEthernet2 &lt;/name&gt; &lt;description&gt; GOON &lt;/description&gt; &lt;type xmlns:ianaift="urn:ietf:params:xml:ns:yang:iana-if-type"&gt; ianaift:ethernetCsmacd &lt;/type&gt; &lt;enabled&gt; true &lt;/enabled&gt; &lt;ipv4 xmlns="urn:ietf:params:xml:ns:yang:ietf-ip"&gt; &lt;address&gt; &lt;ip&gt; 10.10.50.</span><span class="token interpolation"><span class="token punctuation">{</span>octet_4<span class="token punctuation">}</span></span><span class="token string"> &lt;/ip&gt; &lt;netmask&gt; 255.255.255.0 &lt;/netmask&gt; &lt;/address&gt; &lt;/ipv4&gt; &lt;/interface&gt; &lt;/interfaces&gt; '</span></span></span>
<span class="line">            xml_response <span class="token operator">=</span> cs<span class="token punctuation">.</span>edit_config<span class="token punctuation">(</span>rpc_fragment<span class="token punctuation">)</span></span>
<span class="line">        xml_response <span class="token operator">=</span> cs<span class="token punctuation">.</span>get<span class="token punctuation">(</span>rpc_fragment<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>xml_response<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-finally">finally</span><span class="token punctuation">:</span></span>
<span class="line">        sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">TreeView Search Python</div>
                <div class="description">Same TreeView Windows Code Injection search, done in Python instead of C++. I did the Python first, as it would be near impossbile for me to do it in C++ to start (in the beginning)</div>
                <div class="languages">Python</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-python" tabindex="0">                <code class="language-python"><span class="line"><span class="token keyword keyword-import">import</span> ctypes</span>
<span class="line"><span class="token keyword keyword-import">import</span> sys</span>
<span class="line"><span class="token keyword keyword-import">import</span> pprint</span>
<span class="line"><span class="token keyword keyword-import">import</span> time</span>
<span class="line"><span class="token keyword keyword-import">import</span> string</span>
<span class="line"><span class="token keyword keyword-import">import</span> webbrowser</span>
<span class="line"><span class="token keyword keyword-from">from</span> winapi_constants <span class="token keyword keyword-import">import</span> <span class="token operator">*</span></span>
<span class="line"><span class="token keyword keyword-from">from</span> ctypes <span class="token keyword keyword-import">import</span> <span class="token operator">*</span></span>
<span class="line"><span class="token keyword keyword-from">from</span> ctypes<span class="token punctuation">.</span>wintypes <span class="token keyword keyword-import">import</span> <span class="token operator">*</span></span>
<span class="line">&nbsp;</span>
<span class="line">k <span class="token operator">=</span> ctypes<span class="token punctuation">.</span>WinDLL<span class="token punctuation">(</span><span class="token string">'kernel32'</span><span class="token punctuation">,</span> use_last_error<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">u <span class="token operator">=</span> ctypes<span class="token punctuation">.</span>WinDLL<span class="token punctuation">(</span><span class="token string">'user32'</span><span class="token punctuation">,</span> use_last_error<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">c <span class="token operator">=</span> ctypes<span class="token punctuation">.</span>WinDLL<span class="token punctuation">(</span><span class="token string">'comctl32'</span><span class="token punctuation">,</span> use_last_error<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">dvkp</span></span><span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">,</span> key_part<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token punctuation">[</span>value <span class="token keyword keyword-for">for</span> key<span class="token punctuation">,</span> value <span class="token keyword keyword-in">in</span> <span class="token builtin">dict</span><span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-if">if</span> key_part <span class="token keyword keyword-in">in</span> key<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> default</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">hwnds <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_hwnd</span></span><span class="token punctuation">(</span>window_part_name<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">foreach_window</span></span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> lParam<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> u<span class="token punctuation">.</span>IsWindowVisible<span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            length <span class="token operator">=</span> u<span class="token punctuation">.</span>GetWindowTextLengthW<span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span></span>
<span class="line">            buff <span class="token operator">=</span> ctypes<span class="token punctuation">.</span>create_unicode_buffer<span class="token punctuation">(</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">            u<span class="token punctuation">.</span>GetWindowTextW<span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> buff<span class="token punctuation">,</span> length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">            hwnds<span class="token punctuation">[</span>buff<span class="token punctuation">.</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> hwnd</span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token boolean">True</span></span>
<span class="line">    EnumWindowsProc <span class="token operator">=</span> WINFUNCTYPE<span class="token punctuation">(</span>c_bool<span class="token punctuation">,</span> POINTER<span class="token punctuation">(</span>c_int<span class="token punctuation">)</span><span class="token punctuation">,</span> POINTER<span class="token punctuation">(</span>c_int<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    u<span class="token punctuation">.</span>EnumWindows<span class="token punctuation">(</span>EnumWindowsProc<span class="token punctuation">(</span>foreach_window<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> dvkp<span class="token punctuation">(</span>hwnds<span class="token punctuation">,</span> window_part_name<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_class_name</span></span><span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    class_name <span class="token operator">=</span> create_unicode_buffer<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span></span>
<span class="line">    u<span class="token punctuation">.</span>GetClassNameW<span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> class_name<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> class_name<span class="token punctuation">.</span>value<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_window_text</span></span><span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    window_text <span class="token operator">=</span> create_unicode_buffer<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span></span>
<span class="line">    u<span class="token punctuation">.</span>GetWindowTextW<span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> window_text<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> window_text<span class="token punctuation">.</span>value<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">child_window <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span></span>
<span class="line">window_index <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_window_children</span></span><span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    child_hwnds <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">child_callback</span></span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-nonlocal">nonlocal</span> child_hwnds</span>
<span class="line">        child_hwnds<span class="token punctuation">.</span>append<span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token boolean">True</span></span>
<span class="line">    EnumChildProc <span class="token operator">=</span> WINFUNCTYPE<span class="token punctuation">(</span>c_bool<span class="token punctuation">,</span> POINTER<span class="token punctuation">(</span>c_int<span class="token punctuation">)</span><span class="token punctuation">,</span> POINTER<span class="token punctuation">(</span>c_long<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    u<span class="token punctuation">.</span>EnumChildWindows<span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> EnumChildProc<span class="token punctuation">(</span>child_callback<span class="token punctuation">)</span><span class="token punctuation">,</span> pointer<span class="token punctuation">(</span>c_long<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> child_hwnds</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">debug_hwnds</span></span><span class="token punctuation">(</span>child_hwnds<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>child_hwnds<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> child_hwnd <span class="token keyword keyword-in">in</span> child_hwnds<span class="token punctuation">:</span></span>
<span class="line">            length <span class="token operator">=</span> u<span class="token punctuation">.</span>GetWindowTextLengthW<span class="token punctuation">(</span>child_hwnd<span class="token punctuation">)</span></span>
<span class="line">            window_text <span class="token operator">=</span> create_unicode_buffer<span class="token punctuation">(</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">            u<span class="token punctuation">.</span>GetWindowTextW<span class="token punctuation">(</span>child_hwnd<span class="token punctuation">,</span> window_text<span class="token punctuation">,</span> length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"EXAMINING: "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">repr</span><span class="token punctuation">(</span>child_hwnd<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n\tCLASS NAME -&gt; "</span> <span class="token operator">+</span></span>
<span class="line">                  get_class_name<span class="token punctuation">(</span>child_hwnd<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n\tWINDOW TEXT -&gt; "</span> <span class="token operator">+</span> window_text<span class="token punctuation">.</span>value<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span></span>
<span class="line">            get_window_children<span class="token punctuation">(</span>child_hwnd<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_systreeview32_hwnds</span></span><span class="token punctuation">(</span>child_hwnds<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    systreeview_hwnds <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>child_hwnds<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> child_hwnd <span class="token keyword keyword-in">in</span> child_hwnds<span class="token punctuation">:</span></span>
<span class="line">            class_name <span class="token operator">=</span> get_class_name<span class="token punctuation">(</span>child_hwnd<span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>class_name <span class="token operator">==</span> <span class="token string">"SysTreeView32"</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">                systreeview_hwnds<span class="token punctuation">.</span>append<span class="token punctuation">(</span>child_hwnd<span class="token punctuation">)</span></span>
<span class="line">            get_window_children<span class="token punctuation">(</span>child_hwnd<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> systreeview_hwnds</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># https://docs.microsoft.com/en-us/windows/win32/controls/tvm-getitem</span></span>
<span class="line"><span class="token comment"># https://docs.microsoft.com/en-us/windows/win32/controls/tvm-selectitem</span></span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">TVITEMA</span><span class="token punctuation">(</span>Structure<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    _fields_ <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'mask'</span><span class="token punctuation">,</span> UINT<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'hItem'</span><span class="token punctuation">,</span> UINT<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token punctuation">(</span><span class="token string">'state'</span><span class="token punctuation">,</span> UINT<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'stateMask'</span><span class="token punctuation">,</span> UINT<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'pszTextx'</span><span class="token punctuation">,</span> LPSTR<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token punctuation">(</span><span class="token string">'cchTextMax'</span><span class="token punctuation">,</span> c_int<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'iImage'</span><span class="token punctuation">,</span> c_int<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'iSelectedImage'</span><span class="token punctuation">,</span> c_int<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'children'</span><span class="token punctuation">,</span> c_int<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'lparam'</span><span class="token punctuation">,</span> LPARAM<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># class TVITEMEX(Structure):</span></span>
<span class="line"><span class="token comment">#     _fields_ = (('mask', UINT), ('hItem', UINT),</span></span>
<span class="line"><span class="token comment">#                 ('state', UINT), ('stateMask', UINT), ('pszTextx', LPSTR),</span></span>
<span class="line"><span class="token comment">#                 	('cchTextMax',c_int),('iImage',c_int),('iSelectedImage',c_int),('children',c_int),('lparam',LPARAM),('iIntegral',c_int),('uStateEx',c_int),("hwnd",HWND),("iExpandedImage",int),("int",iReserved))</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_selected_item_text</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    systreeview_hwnds <span class="token operator">=</span> get_systreeview32_hwnds<span class="token punctuation">(</span></span>
<span class="line">        get_window_children<span class="token punctuation">(</span>get_hwnd<span class="token punctuation">(</span><span class="token string">"Redacted"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-for">for</span> hwnd <span class="token keyword keyword-in">in</span> systreeview_hwnds<span class="token punctuation">:</span></span>
<span class="line">        root_item_handle_int <span class="token operator">=</span> u<span class="token punctuation">.</span>SendMessageA<span class="token punctuation">(</span></span>
<span class="line">            hwnd<span class="token punctuation">,</span> TVM_GETNEXTITEM<span class="token punctuation">,</span> TVGN_ROOT<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># print("Root Item", hex(root_item_handle_int))</span></span>
<span class="line">        <span class="token comment"># SELECTING CODE</span></span>
<span class="line">        selected_item_handle_int <span class="token operator">=</span> u<span class="token punctuation">.</span>SendMessageA<span class="token punctuation">(</span></span>
<span class="line">            hwnd<span class="token punctuation">,</span> TVM_GETNEXTITEM<span class="token punctuation">,</span> TVGN_CARET<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># print("Selected Item", hex(selected_item_handle_int))</span></span>
<span class="line">        text_buffer_size <span class="token operator">=</span> <span class="token number">127</span></span>
<span class="line">        <span class="token comment"># make item object</span></span>
<span class="line">        selected_item <span class="token operator">=</span> TVITEMA<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        selected_item<span class="token punctuation">.</span>hItem <span class="token operator">=</span> selected_item_handle_int</span>
<span class="line">        selected_item<span class="token punctuation">.</span>mask <span class="token operator">=</span> TVIF_TEXT <span class="token operator">|</span> TVIF_HANDLE</span>
<span class="line">        selected_item<span class="token punctuation">.</span>cchTextMax <span class="token operator">=</span> <span class="token number">127</span></span>
<span class="line">        item_memory_size <span class="token operator">=</span> sizeof<span class="token punctuation">(</span>selected_item<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1024</span></span>
<span class="line">        process_id_dword <span class="token operator">=</span> DWORD<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># note: DO NOT FORGET THE BYREF FOR PUTTING VARIABLES IN THAT WILL COME OUT WITH A NEW VALUE (IN SOME CASES LIKE THIS DWORD)</span></span>
<span class="line">        thread_id <span class="token operator">=</span> u<span class="token punctuation">.</span>GetWindowThreadProcessId<span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> byref<span class="token punctuation">(</span>process_id_dword<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># note, if it was a long pointer, extracting it would be .contents (similar to dereferencing with &amp;. Since it's not a pointer, you use .value</span></span>
<span class="line">        process_id <span class="token operator">=</span> process_id_dword<span class="token punctuation">.</span>value</span>
<span class="line">        <span class="token comment"># now that you have process ID, open Process</span></span>
<span class="line">        k<span class="token punctuation">.</span>OpenProcess<span class="token punctuation">.</span>argtypes <span class="token operator">=</span> <span class="token punctuation">[</span>DWORD<span class="token punctuation">,</span> BOOL<span class="token punctuation">,</span> DWORD<span class="token punctuation">]</span></span>
<span class="line">        k<span class="token punctuation">.</span>OpenProcess<span class="token punctuation">.</span>restype <span class="token operator">=</span> HANDLE</span>
<span class="line">        process <span class="token operator">=</span> k<span class="token punctuation">.</span>OpenProcess<span class="token punctuation">(</span>PROCESS_VM_OPERATION <span class="token operator">|</span> PROCESS_VM_READ <span class="token operator">|</span></span>
<span class="line">                                PROCESS_VM_WRITE <span class="token operator">|</span> PROCESS_QUERY_INFORMATION<span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> process_id_dword<span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># print("PROCESS_ID", process_id)</span></span>
<span class="line">        <span class="token comment"># print("PROCESS", process)</span></span>
<span class="line">        <span class="token comment"># https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualallocex</span></span>
<span class="line">        <span class="token comment"># allocate space for the item object &amp; text object in this process</span></span>
<span class="line">        address_item_remote <span class="token operator">=</span> k<span class="token punctuation">.</span>VirtualAllocEx<span class="token punctuation">(</span></span>
<span class="line">            process<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> item_memory_size<span class="token punctuation">,</span> MEM_COMMIT<span class="token punctuation">,</span> PAGE_READWRITE<span class="token punctuation">)</span></span>
<span class="line">        address_text_remote <span class="token operator">=</span> k<span class="token punctuation">.</span>VirtualAllocEx<span class="token punctuation">(</span></span>
<span class="line">            process<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> text_buffer_size<span class="token punctuation">,</span> MEM_COMMIT<span class="token punctuation">,</span> PAGE_READWRITE<span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># when you copy the selected item in the remote process, put the new memory address pointer in that item</span></span>
<span class="line">        selected_item<span class="token punctuation">.</span>pszTextx <span class="token operator">=</span> address_text_remote</span>
<span class="line">        <span class="token comment"># print("address_item_remote", hex(address_item_remote))</span></span>
<span class="line">        <span class="token comment"># print("address_text_remote", hex(address_text_remote))</span></span>
<span class="line">        item_memory_size <span class="token operator">=</span> sizeof<span class="token punctuation">(</span>selected_item<span class="token punctuation">)</span></span>
<span class="line">        bytes_written <span class="token operator">=</span> DWORD<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        k<span class="token punctuation">.</span>WriteProcessMemory<span class="token punctuation">(</span>process<span class="token punctuation">,</span> address_item_remote<span class="token punctuation">,</span> byref<span class="token punctuation">(</span></span>
<span class="line">            selected_item<span class="token punctuation">)</span><span class="token punctuation">,</span> item_memory_size<span class="token punctuation">,</span> byref<span class="token punctuation">(</span>bytes_written<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        u<span class="token punctuation">.</span>SendMessageA<span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> TVM_GETITEM<span class="token punctuation">,</span> TVGN_CARET<span class="token punctuation">,</span> address_item_remote<span class="token punctuation">)</span></span>
<span class="line">        text_buffer <span class="token operator">=</span> create_string_buffer<span class="token punctuation">(</span>text_buffer_size<span class="token punctuation">)</span></span>
<span class="line">        bytes_size <span class="token operator">=</span> text_buffer_size</span>
<span class="line">        bytes_read <span class="token operator">=</span> DWORD<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        k<span class="token punctuation">.</span>ReadProcessMemory<span class="token punctuation">(</span>process<span class="token punctuation">,</span> address_text_remote<span class="token punctuation">,</span> byref<span class="token punctuation">(</span></span>
<span class="line">            text_buffer<span class="token punctuation">)</span><span class="token punctuation">,</span> text_buffer_size<span class="token punctuation">,</span> byref<span class="token punctuation">(</span>bytes_read<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># print("BYTES READ", bytes_read)</span></span>
<span class="line">        selected_item_text <span class="token operator">=</span> text_buffer<span class="token punctuation">.</span>value<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        k<span class="token punctuation">.</span>VirtualFreeEx<span class="token punctuation">(</span>process<span class="token punctuation">,</span> address_item_remote<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> MEM_RELEASE<span class="token punctuation">)</span></span>
<span class="line">        k<span class="token punctuation">.</span>VirtualFreeEx<span class="token punctuation">(</span>process<span class="token punctuation">,</span> address_text_remote<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> MEM_RELEASE<span class="token punctuation">)</span></span>
<span class="line">        k<span class="token punctuation">.</span>CloseHandle<span class="token punctuation">(</span>process<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> selected_item_text</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">go_to_url</span></span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    chrome_path <span class="token operator">=</span> <span class="token string">"C:/Program Files (x86)/Google/Chrome/Application/chrome.exe"</span></span>
<span class="line">    webbrowser<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> new<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">LRESULT <span class="token operator">=</span> LPARAM</span>
<span class="line">ULONG_PTR <span class="token operator">=</span> WPARAM</span>
<span class="line">chrome_path <span class="token operator">=</span> <span class="token string">"C:/Program Files (x86)/Google/Chrome/Application/chrome.exe"</span></span>
<span class="line">LowLevelKeyboardProc <span class="token operator">=</span> WINFUNCTYPE<span class="token punctuation">(</span>LRESULT<span class="token punctuation">,</span> c_int<span class="token punctuation">,</span> WPARAM<span class="token punctuation">,</span> LPARAM<span class="token punctuation">)</span></span>
<span class="line">alphanumeric <span class="token operator">=</span> <span class="token punctuation">[</span>c <span class="token keyword keyword-for">for</span> c <span class="token keyword keyword-in">in</span> string<span class="token punctuation">.</span>digits <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_uppercase<span class="token punctuation">]</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">KBDLLHOOKSTRUCT</span><span class="token punctuation">(</span>Structure<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    _fields_ <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'vkCode'</span><span class="token punctuation">,</span> DWORD<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'scanCode'</span><span class="token punctuation">,</span> DWORD<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token punctuation">(</span><span class="token string">'flags'</span><span class="token punctuation">,</span> DWORD<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'time'</span><span class="token punctuation">,</span> DWORD<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'dwExtraInfo'</span><span class="token punctuation">,</span> ULONG_PTR<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">@LowLevelKeyboardProc</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">keyboard_low_level</span></span><span class="token punctuation">(</span>nCode<span class="token punctuation">,</span> wParam<span class="token punctuation">,</span> lParam<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    msg <span class="token operator">=</span> cast<span class="token punctuation">(</span>lParam<span class="token punctuation">,</span> POINTER<span class="token punctuation">(</span>KBDLLHOOKSTRUCT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">    vk_code <span class="token operator">=</span> msg<span class="token punctuation">.</span>vkCode</span>
<span class="line">    <span class="token comment"># character = chr(vk_code)</span></span>
<span class="line">    <span class="token comment"># if alphanumeric, and only proceed if pressing down, not both up &amp; down for duplicates</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> wParam <span class="token operator">==</span> WM_KEYDOWN<span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># character = character.lower()</span></span>
<span class="line">        <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"You wrote </span><span class="token interpolation"><span class="token punctuation">{</span>vk_code<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># leave if "e"</span></span>
<span class="line">        query <span class="token operator">=</span> get_selected_item_text<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> vk_code <span class="token operator">==</span> <span class="token number">186</span><span class="token punctuation">:</span>  <span class="token comment"># ;</span></span>
<span class="line">            go_to_url<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"https://open.spotify.com/search/</span><span class="token interpolation"><span class="token punctuation">{</span>query<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-elif">elif</span> vk_code <span class="token operator">==</span> <span class="token number">222</span><span class="token punctuation">:</span>  <span class="token comment"># '</span></span>
<span class="line">            go_to_url<span class="token punctuation">(</span></span>
<span class="line">                <span class="token string-interpolation"><span class="token string">f"http://www.amazon.com/s/ref=nb_sb_noss_2?url=search-alias`%3Ddigital-music&amp;field-keywords=</span><span class="token interpolation"><span class="token punctuation">{</span>query<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-elif">elif</span> vk_code <span class="token operator">==</span> <span class="token number">188</span><span class="token punctuation">:</span></span>
<span class="line">            go_to_url<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"http://www.youtube.com/results?search_query=</span><span class="token interpolation"><span class="token punctuation">{</span>query<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-elif">elif</span> vk_code <span class="token operator">==</span> <span class="token number">219</span><span class="token punctuation">:</span></span>
<span class="line">            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> u<span class="token punctuation">.</span>CallNextHookEx<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> nCode<span class="token punctuation">,</span> wParam<span class="token punctuation">,</span> lParam<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">u<span class="token punctuation">.</span>SetWindowsHookExW<span class="token punctuation">(</span>WH_KEYBOARD_LL<span class="token punctuation">,</span> keyboard_low_level<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">msg <span class="token operator">=</span> MSG<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">lpmsg <span class="token operator">=</span> pointer<span class="token punctuation">(</span>msg<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword keyword-while">while</span> u<span class="token punctuation">.</span>GetMessageW<span class="token punctuation">(</span>lpmsg<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">    u<span class="token punctuation">.</span>TranslateMessage<span class="token punctuation">(</span>lpmsg<span class="token punctuation">)</span></span>
<span class="line">    u<span class="token punctuation">.</span>DispatchMessageW<span class="token punctuation">(</span>lpmsg<span class="token punctuation">)</span></span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Rust Sports Cards</div>
                <div class="description">A Rust program for managing sports cards.</div>
                <div class="languages">Rust</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-rust" tabindex="0">                <code class="language-rust"><span class="line"><span class="token attribute attr-name">#![allow(warnings, unused)]</span></span>
<span class="line"><span class="token keyword keyword-mod">mod</span> <span class="token module-declaration namespace">players</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-mod">mod</span> <span class="token module-declaration namespace">clear_console</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-use">use</span> <span class="token namespace">std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span></span><span class="token class-name">Deref</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-use">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>io<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-use">use</span> <span class="token namespace">rand<span class="token punctuation">::</span></span><span class="token class-name">Rng</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-use">use</span> <span class="token namespace">rand<span class="token punctuation">::</span></span>thread_rng<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-use">use</span> <span class="token namespace">rand<span class="token punctuation">::</span>seq<span class="token punctuation">::</span></span><span class="token class-name">SliceRandom</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-const">const</span> amount_of_cards_in_pack<span class="token punctuation">:</span><span class="token keyword keyword-i8">i8</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-const">const</span> amount_of_packs_in_box<span class="token punctuation">:</span><span class="token keyword keyword-i8">i8</span> <span class="token operator">=</span> <span class="token number">24</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token attribute attr-name">#[derive(Debug, PartialEq,Clone)]</span></span>
<span class="line"><span class="token keyword keyword-enum">enum</span> <span class="token type-definition class-name">SportsCardEnum</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Plain</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token keyword keyword-i32">i32</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name">Refractor</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name">AtomicRefractor</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name">Autograph</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name">Jersey</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name">Patch</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name">PatchAutograph</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-impl">impl</span> <span class="token class-name">SportsCardEnum</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-pub">pub</span> <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">odds</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-self">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword keyword-i32">i32</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-match">match</span> <span class="token keyword keyword-self">self</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">PatchAutograph</span> <span class="token operator">=&gt;</span> <span class="token number">60000</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Patch</span> <span class="token operator">=&gt;</span> <span class="token number">7500</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Jersey</span> <span class="token operator">=&gt;</span> <span class="token number">2500</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">360</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">288</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">144</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">AtomicRefractor</span> <span class="token operator">=&gt;</span> <span class="token number">244</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Autograph</span> <span class="token operator">=&gt;</span> <span class="token number">128</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">96</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Refractor</span> <span class="token operator">=&gt;</span> <span class="token number">72</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">36</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">16</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">4</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Plain</span> <span class="token operator">=&gt;</span> <span class="token number">4</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token operator">=&gt;</span> <span class="token number">1</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-pub">pub</span> <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">name_of_insert</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-self">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword keyword-str">str</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-match">match</span> <span class="token keyword keyword-self">self</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Autograph</span> <span class="token operator">=&gt;</span> <span class="token string">"Autograph"</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">AtomicRefractor</span> <span class="token operator">=&gt;</span> <span class="token string">"Atomic Refractor"</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">PatchAutograph</span> <span class="token operator">=&gt;</span> <span class="token string">"Patch Autograph"</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Plain</span> <span class="token operator">=&gt;</span> <span class="token string">"Plain"</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Patch</span> <span class="token operator">=&gt;</span> <span class="token string">"Patch"</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Refractor</span> <span class="token operator">=&gt;</span> <span class="token string">"Refactor"</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Jersey</span> <span class="token operator">=&gt;</span> <span class="token string">"Jersey"</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">"Jam City"</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">"Season's Best"</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">"Rock Stars"</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">"Quick Strike"</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">"Thunder &amp; Lightning"</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">"NetRageous"</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">"Hardware"</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token operator">=&gt;</span> <span class="token string">"Plain"</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-pub">pub</span> <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">multiplier</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-self">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword keyword-f32">f32</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-match">match</span> <span class="token keyword keyword-self">self</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">PatchAutograph</span> <span class="token operator">=&gt;</span> <span class="token number">5000.0</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Patch</span> <span class="token operator">=&gt;</span> <span class="token number">2000.0</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Jersey</span> <span class="token operator">=&gt;</span> <span class="token number">1000.0</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">150.0</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">AtomicRefractor</span> <span class="token operator">=&gt;</span> <span class="token number">130.0</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">100.0</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Autograph</span> <span class="token operator">=&gt;</span> <span class="token number">75.0</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">75.0</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Refractor</span> <span class="token operator">=&gt;</span> <span class="token number">75.0</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">25.0</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">20.0</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">8.0</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Plain</span> <span class="token operator">=&gt;</span> <span class="token number">1.0</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token operator">=&gt;</span> <span class="token number">1.0</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token attribute attr-name">#[derive(Debug,Clone)]</span></span>
<span class="line"><span class="token keyword keyword-struct">struct</span> <span class="token type-definition class-name">SportsCard</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    sports_card_type<span class="token punctuation">:</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">,</span></span>
<span class="line">    player_name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span></span>
<span class="line">    player_tier<span class="token punctuation">:</span> <span class="token keyword keyword-i8">i8</span><span class="token punctuation">,</span></span>
<span class="line">    price<span class="token punctuation">:</span> <span class="token keyword keyword-f32">f32</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword keyword-impl">impl</span> <span class="token class-name">SportsCard</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">get_price</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-self">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword keyword-f32">f32</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> base_price<span class="token punctuation">:</span> <span class="token keyword keyword-f32">f32</span> <span class="token operator">=</span> <span class="token keyword keyword-match">match</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>player_tier</span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>player_tier <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">=&gt;</span> <span class="token number">2.0</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>player_tier <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">=&gt;</span> <span class="token number">0.5</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>player_tier <span class="token operator">==</span> <span class="token number">3</span> <span class="token operator">=&gt;</span> <span class="token number">0.4</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>player_tier <span class="token operator">==</span> <span class="token number">4</span> <span class="token operator">=&gt;</span> <span class="token number">0.3</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>player_tier <span class="token operator">==</span> <span class="token number">5</span> <span class="token operator">=&gt;</span> <span class="token number">0.25</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>player_tier <span class="token operator">==</span> <span class="token number">6</span> <span class="token operator">=&gt;</span> <span class="token number">0.20</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>player_tier <span class="token operator">==</span> <span class="token number">7</span> <span class="token operator">=&gt;</span> <span class="token number">0.15</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>player_tier <span class="token operator">==</span> <span class="token number">8</span> <span class="token operator">=&gt;</span> <span class="token number">0.05</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token operator">=&gt;</span> <span class="token number">1.0</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> multiplier<span class="token punctuation">:</span> <span class="token keyword keyword-f32">f32</span> <span class="token operator">=</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>sports_card_type<span class="token punctuation">.</span><span class="token function">multiplier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> price <span class="token operator">=</span> <span class="token punctuation">(</span>base_price <span class="token operator">*</span> multiplier<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        price <span class="token operator">=</span> <span class="token keyword keyword-match">match</span> price</span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> price <span class="token operator">&gt;=</span> <span class="token number">50.0</span> <span class="token operator">=&gt;</span> price <span class="token operator">-</span> <span class="token punctuation">(</span>price <span class="token operator">%</span> <span class="token number">10.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> price <span class="token operator">&gt;=</span> <span class="token number">20.0</span> <span class="token operator">=&gt;</span> price <span class="token operator">-</span> <span class="token punctuation">(</span>price <span class="token operator">%</span> <span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token operator">=&gt;</span> price</span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">        price</span>
<span class="line">    <span class="token punctuation">}</span>    </span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword keyword-impl">impl</span> <span class="token class-name">Default</span> <span class="token keyword keyword-for">for</span> <span class="token class-name">SportsCard</span> </span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">     <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword keyword-Self">Self</span> <span class="token punctuation">{</span> </span>
<span class="line">        <span class="token class-name">SportsCard</span> <span class="token punctuation">{</span> </span>
<span class="line">            sports_card_type<span class="token punctuation">:</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Plain</span><span class="token punctuation">,</span></span>
<span class="line">            player_name<span class="token punctuation">:</span> <span class="token string">"None"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            price<span class="token punctuation">:</span> <span class="token number">1.50</span><span class="token punctuation">,</span></span>
<span class="line">            player_tier<span class="token punctuation">:</span> <span class="token number">8</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">     <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token attribute attr-name">#[derive(Debug)]</span></span>
<span class="line"><span class="token keyword keyword-struct">struct</span> <span class="token type-definition class-name">Pack</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    cards<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">SportsCard</span><span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line">    status_of_pack<span class="token punctuation">:</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">,</span></span>
<span class="line">    begin_border<span class="token punctuation">:</span> <span class="token keyword keyword-usize">usize</span><span class="token punctuation">,</span></span>
<span class="line">    begin_insert_border<span class="token punctuation">:</span> <span class="token keyword keyword-usize">usize</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword keyword-impl">impl</span> <span class="token class-name">Pack</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">get_regular_card</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-mut">mut</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">SportsCard</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> player_tuples <span class="token operator">=</span> <span class="token namespace">players<span class="token punctuation">::</span></span>player_tuples<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> rng <span class="token operator">=</span> <span class="token function">thread_rng</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        player_tuples<span class="token punctuation">.</span><span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-mut">mut</span> <span class="token function">thread_rng</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> player_tuple_length <span class="token operator">=</span> player_tuples<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> shuffle_interval <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> end_border <span class="token operator">=</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>begin_border <span class="token operator">+</span> shuffle_interval<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> index <span class="token operator">=</span> rng<span class="token punctuation">.</span><span class="token function">gen_range</span><span class="token punctuation">(</span><span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>begin_border<span class="token punctuation">..</span>end_border<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> player <span class="token operator">=</span> player_tuples<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//iterate to next level in tuple for the next function call</span></span>
<span class="line">        <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>begin_border <span class="token operator">=</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>begin_border <span class="token operator">+</span> shuffle_interval<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> regular_card <span class="token operator">=</span> <span class="token class-name">SportsCard</span></span>
<span class="line">        <span class="token punctuation">{</span> </span>
<span class="line">            sports_card_type<span class="token punctuation">:</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Plain</span><span class="token punctuation">,</span></span>
<span class="line">            player_name<span class="token punctuation">:</span> player<span class="token number">.0</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            player_tier<span class="token punctuation">:</span> player<span class="token number">.1</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">..</span><span class="token class-name">Default</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">        regular_card<span class="token punctuation">.</span>price <span class="token operator">=</span> regular_card<span class="token punctuation">.</span><span class="token function">get_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        regular_card</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">get_insert</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-mut">mut</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">,</span> sports_card_type<span class="token punctuation">:</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">SportsCard</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> player_tuples <span class="token operator">=</span> <span class="token namespace">players<span class="token punctuation">::</span></span>player_tuples<span class="token punctuation">;</span></span>
<span class="line">        player_tuples<span class="token punctuation">.</span><span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-mut">mut</span> <span class="token function">thread_rng</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">// Only those ranked 1 to 4 ( Vec&lt;&amp;(&amp;str, i8) )</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> player_inserts_tuple <span class="token operator">=</span> player_tuples<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>player<span class="token closure-punctuation punctuation">|</span></span> player<span class="token number">.1</span> <span class="token operator">&lt;=</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span>_<span class="token operator">&gt;</span> <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> rng <span class="token operator">=</span> <span class="token function">thread_rng</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        player_inserts_tuple<span class="token punctuation">.</span><span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-mut">mut</span> <span class="token function">thread_rng</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> player_inserts_tuple_length <span class="token operator">=</span> player_inserts_tuple<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> shuffle_interval <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> end_border <span class="token operator">=</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>begin_insert_border <span class="token operator">+</span> shuffle_interval<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> index <span class="token operator">=</span> rng<span class="token punctuation">.</span><span class="token function">gen_range</span><span class="token punctuation">(</span><span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>begin_insert_border<span class="token punctuation">..</span>end_border<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> player_insert <span class="token operator">=</span> player_inserts_tuple<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//iterate to next level in tuple for the next function call</span></span>
<span class="line">        <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>begin_insert_border <span class="token operator">=</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>begin_insert_border <span class="token operator">+</span> shuffle_interval<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> insert <span class="token operator">=</span> <span class="token class-name">SportsCard</span></span>
<span class="line">        <span class="token punctuation">{</span> </span>
<span class="line">            sports_card_type<span class="token punctuation">:</span> sports_card_type<span class="token punctuation">,</span></span>
<span class="line">            player_name<span class="token punctuation">:</span> player_insert<span class="token number">.0</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            player_tier<span class="token punctuation">:</span> player_insert<span class="token number">.1</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">..</span><span class="token class-name">Default</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">        insert<span class="token punctuation">.</span>price <span class="token operator">=</span> insert<span class="token punctuation">.</span><span class="token function">get_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        insert</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">fill_pack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-mut">mut</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> </span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> cards<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">SportsCard</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> rng <span class="token operator">=</span> <span class="token function">thread_rng</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> random_number <span class="token operator">=</span> rng<span class="token punctuation">.</span><span class="token function">gen_range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">60000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> pack_insert_type<span class="token punctuation">:</span> <span class="token class-name">SportsCardEnum</span> <span class="token operator">=</span> <span class="token keyword keyword-match">match</span> random_number</span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> random_number <span class="token operator">%</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">PatchAutograph</span><span class="token punctuation">.</span><span class="token function">odds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>  <span class="token operator">=&gt;</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">PatchAutograph</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> random_number <span class="token operator">%</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Patch</span><span class="token punctuation">.</span><span class="token function">odds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span>  <span class="token operator">=&gt;</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Patch</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> random_number <span class="token operator">%</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Jersey</span><span class="token punctuation">.</span><span class="token function">odds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span>  <span class="token operator">=&gt;</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Jersey</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> random_number <span class="token operator">%</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">odds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span>  <span class="token operator">=&gt;</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   </span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> random_number <span class="token operator">%</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">AtomicRefractor</span><span class="token punctuation">.</span><span class="token function">odds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span>  <span class="token operator">=&gt;</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">AtomicRefractor</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> random_number <span class="token operator">%</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">odds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">5</span>  <span class="token operator">=&gt;</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> random_number <span class="token operator">%</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Autograph</span><span class="token punctuation">.</span><span class="token function">odds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">6</span>  <span class="token operator">=&gt;</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Autograph</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> random_number <span class="token operator">%</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">odds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">7</span>  <span class="token operator">=&gt;</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> random_number <span class="token operator">%</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Refractor</span><span class="token punctuation">.</span><span class="token function">odds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">8</span>  <span class="token operator">=&gt;</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Refractor</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> random_number <span class="token operator">%</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">odds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">9</span>  <span class="token operator">=&gt;</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> random_number <span class="token operator">%</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">odds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">10</span>  <span class="token operator">=&gt;</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> random_number <span class="token operator">%</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">odds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>  <span class="token operator">=&gt;</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token operator">=&gt;</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Plain</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>status_of_pack <span class="token operator">=</span> pack_insert_type<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> i <span class="token keyword keyword-in">in</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">..</span>amount_of_cards_in_pack<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> card <span class="token operator">=</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span><span class="token function">get_regular_card</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            card<span class="token punctuation">.</span>price <span class="token operator">=</span> card<span class="token punctuation">.</span><span class="token function">get_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            cards<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>card<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token comment">//If there is an insert, put ONE insert in</span></span>
<span class="line">        cards<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword keyword-match">match</span> pack_insert_type</span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            _ <span class="token keyword keyword-if">if</span> pack_insert_type <span class="token operator">!=</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Plain</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> insert <span class="token operator">=</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span><span class="token function">get_insert</span><span class="token punctuation">(</span>pack_insert_type<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                insert<span class="token punctuation">.</span>price <span class="token operator">=</span> insert<span class="token punctuation">.</span><span class="token function">get_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                insert</span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token operator">=&gt;</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span><span class="token function">get_regular_card</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>cards <span class="token operator">=</span> cards<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//regular cards gone</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">display</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-self">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> price <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> card <span class="token keyword keyword-in">in</span> <span class="token operator">&amp;</span><span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>cards</span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You got a {:?} card of {} worth ${:.2}!"</span><span class="token punctuation">,</span> card<span class="token punctuation">.</span>sports_card_type<span class="token punctuation">.</span><span class="token function">name_of_insert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> card<span class="token punctuation">.</span>player_name<span class="token punctuation">,</span> card<span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            price <span class="token operator">+=</span> card<span class="token punctuation">.</span>price<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The total price of your pack is ${:.2}!"</span><span class="token punctuation">,</span> price<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> </span>
<span class="line">    <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">get_price</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-self">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword keyword-f32">f32</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> pack_price <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> card <span class="token keyword keyword-in">in</span> <span class="token operator">&amp;</span><span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>cards</span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            pack_price <span class="token operator">+=</span> card<span class="token punctuation">.</span>price<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        pack_price</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword keyword-impl">impl</span> <span class="token class-name">Default</span> <span class="token keyword keyword-for">for</span> <span class="token class-name">Pack</span> </span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">     <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword keyword-Self">Self</span> <span class="token punctuation">{</span> </span>
<span class="line">        <span class="token class-name">Pack</span> <span class="token punctuation">{</span> </span>
<span class="line">            cards<span class="token punctuation">:</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">            status_of_pack<span class="token punctuation">:</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Plain</span><span class="token punctuation">,</span></span>
<span class="line">            begin_border<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="line">            begin_insert_border<span class="token punctuation">:</span> <span class="token number">0</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">     <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token attribute attr-name">#[derive(Debug)]</span></span>
<span class="line"><span class="token keyword keyword-struct">struct</span> <span class="token type-definition class-name">Box</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    packs<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Pack</span><span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line">    best_pack<span class="token punctuation">:</span> <span class="token class-name">Pack</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword keyword-impl">impl</span> <span class="token class-name">Box</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">fill_box</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-mut">mut</span> <span class="token keyword keyword-self">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Box</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> packs <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> i <span class="token keyword keyword-in">in</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">..</span>amount_of_packs_in_box<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> pack <span class="token operator">=</span> <span class="token class-name">Pack</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            pack<span class="token punctuation">.</span><span class="token function">fill_pack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            packs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>pack<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span> </span>
<span class="line">        <span class="token class-name">Box</span> <span class="token punctuation">{</span> packs <span class="token punctuation">,</span> <span class="token punctuation">..</span><span class="token class-name">Default</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">retrieve_pack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-self">self</span><span class="token punctuation">,</span>numeric_choice<span class="token punctuation">:</span> <span class="token keyword keyword-i8">i8</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token class-name">Pack</span> </span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> index <span class="token operator">=</span> numeric_choice <span class="token keyword keyword-as">as</span> <span class="token keyword keyword-usize">usize</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> packs <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>packs<span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//zero-indexed</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> pack <span class="token operator">=</span> packs<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        pack</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">greatest_cards</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-self">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Pack</span> </span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> largest_pack_price <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> largest_pack_index<span class="token punctuation">:</span> <span class="token keyword keyword-usize">usize</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> best_cards<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token class-name">SportsCard</span><span class="token punctuation">,</span><span class="token keyword keyword-usize">usize</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> packs <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>packs<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>pack_index<span class="token punctuation">,</span> pack<span class="token punctuation">)</span> <span class="token keyword keyword-in">in</span> packs<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> current_pack_price <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-for">for</span> card <span class="token keyword keyword-in">in</span> <span class="token operator">&amp;</span>pack<span class="token punctuation">.</span>cards</span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                current_pack_price <span class="token operator">+=</span> card<span class="token punctuation">.</span>price<span class="token punctuation">;</span></span>
<span class="line">                best_cards<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span>card<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>pack_index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          </span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token comment">//traverse the best cards vector</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> current_pack_price <span class="token operator">&gt;</span> largest_pack_price</span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                largest_pack_price <span class="token operator">=</span> current_pack_price<span class="token punctuation">;</span></span>
<span class="line">                largest_pack_index <span class="token operator">=</span> pack_index<span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> best_cards <span class="token operator">=</span> best_cards<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>a<span class="token closure-punctuation punctuation">|</span></span> a<span class="token number">.0</span><span class="token punctuation">.</span>sports_card_type <span class="token operator">!=</span> <span class="token class-name">SportsCardEnum</span><span class="token punctuation">::</span><span class="token class-name">Plain</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span>_<span class="token operator">&gt;</span> <span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        best_cards<span class="token punctuation">.</span><span class="token function">sort_by</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>a<span class="token punctuation">,</span>b<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">(</span>b<span class="token number">.0</span><span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">partial_cmp</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token number">.0</span><span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_or</span><span class="token punctuation">(</span><span class="token namespace">core<span class="token punctuation">::</span>cmp<span class="token punctuation">::</span></span><span class="token class-name">Ordering</span><span class="token punctuation">::</span><span class="token class-name">Equal</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The best pack was pack #{}\n"</span><span class="token punctuation">,</span> largest_pack_index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> best_card_tuple <span class="token keyword keyword-in">in</span> best_cards</span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"In pack #{}, there was a {:?} card with 1:{:#} odds that was a {} insert worth ${:.2}"</span><span class="token punctuation">,</span> best_card_tuple<span class="token number">.1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> best_card_tuple<span class="token number">.0</span><span class="token punctuation">.</span>player_name<span class="token punctuation">,</span> best_card_tuple<span class="token number">.0</span><span class="token punctuation">.</span>sports_card_type<span class="token punctuation">.</span><span class="token function">odds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> best_card_tuple<span class="token number">.0</span><span class="token punctuation">.</span>sports_card_type<span class="token punctuation">.</span><span class="token function">name_of_insert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> best_card_tuple<span class="token number">.0</span><span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">(</span><span class="token class-name">Pack</span><span class="token punctuation">{</span><span class="token punctuation">..</span><span class="token class-name">Default</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span>   </span>
<span class="line">    <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">ranking_pack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-self">self</span><span class="token punctuation">,</span> user_pack<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Pack</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> </span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> pack_prices_vector <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//fill vector of pack prices</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> pack <span class="token keyword keyword-in">in</span> <span class="token operator">&amp;</span><span class="token keyword keyword-self">self</span><span class="token punctuation">.</span>packs</span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> pack_price <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span></span>
<span class="line">            pack_prices_vector<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>pack<span class="token punctuation">.</span><span class="token function">get_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        pack_prices_vector<span class="token punctuation">.</span><span class="token function">sort_by</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>a<span class="token punctuation">,</span> b<span class="token closure-punctuation punctuation">|</span></span> a<span class="token punctuation">.</span><span class="token function">partial_cmp</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> tracking_index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> user_pack_price <span class="token operator">=</span> user_pack<span class="token punctuation">.</span><span class="token function">get_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span>pack_price<span class="token punctuation">)</span> <span class="token keyword keyword-in">in</span> pack_prices_vector<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> user_pack_price <span class="token operator">&lt;=</span> <span class="token operator">*</span>pack_price</span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                tracking_index <span class="token operator">=</span> i<span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> rank <span class="token operator">=</span> amount_of_packs_in_box <span class="token operator">-</span> tracking_index <span class="token keyword keyword-as">as</span> <span class="token keyword keyword-i8">i8</span><span class="token punctuation">;</span>  </span>
<span class="line">        <span class="token keyword keyword-let">let</span> rank_suffix <span class="token operator">=</span> <span class="token keyword keyword-match">match</span> rank <span class="token operator">%</span> <span class="token number">10</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token number">1</span> <span class="token operator">=&gt;</span> <span class="token string">"st"</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token number">2</span> <span class="token operator">=&gt;</span> <span class="token string">"nd"</span><span class="token punctuation">,</span></span>
<span class="line">            _ <span class="token operator">=&gt;</span> <span class="token string">"th"</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> percentile <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tracking_index <span class="token keyword keyword-as">as</span> <span class="token keyword keyword-f32">f32</span><span class="token operator">/</span><span class="token number">24.0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//zero-index to human index</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Your pack was the {:#}{} best of {:#} packs. You're in {}% percentile.\n"</span><span class="token punctuation">,</span> rank<span class="token punctuation">,</span>rank_suffix<span class="token punctuation">,</span>pack_prices_vector<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>percentile<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword keyword-impl">impl</span> <span class="token class-name">Default</span> <span class="token keyword keyword-for">for</span> <span class="token class-name">Box</span> <span class="token punctuation">{</span></span>
<span class="line">     <span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword keyword-Self">Self</span> <span class="token punctuation">{</span> </span>
<span class="line">        <span class="token class-name">Box</span> <span class="token punctuation">{</span></span>
<span class="line">            packs<span class="token punctuation">:</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">            best_pack<span class="token punctuation">:</span> <span class="token class-name">Pack</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token namespace">clear_console<span class="token punctuation">::</span></span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> choice <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-while">while</span> choice<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_lowercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"q"</span> <span class="token operator">&amp;&amp;</span> choice<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_lowercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"quit"</span> <span class="token operator">&amp;&amp;</span> choice<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_lowercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"no"</span> </span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> box_instance <span class="token operator">=</span> <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span><span class="token string">"---------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span><span class="token string">"|   1   |   2   |   3   |   4   |"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span><span class="token string">"---------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span><span class="token string">"|   5   |   6   |   7   |   8   |"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span><span class="token string">"---------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span><span class="token string">"|   9   |  10   |  11   |  12   |"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span><span class="token string">"---------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span><span class="token string">"|  13   |  14   |  15   |  16   |"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span><span class="token string">"---------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span><span class="token string">"|  17   |  18   |  19   |  20   |"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span><span class="token string">"---------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span><span class="token string">"|  21   |  22   |  23   |  24   |"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span><span class="token string">"---------------------------------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span><span class="token string">"You're in Jondar's Comic Books &amp; Sports Cards!!!!! Welcome to my Store, we're happy to have you! A pack of basketcall cards will run you $4.00.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span><span class="token string">"Hope you pull a rare gem!!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> message_to_user <span class="token operator">=</span> <span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"Pick a number between 1 &amp; {}\n"</span><span class="token punctuation">,</span> amount_of_packs_in_box<span class="token punctuation">)</span><span class="token punctuation">;</span> </span>
<span class="line">        <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> numeric_choice <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-loop">loop</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            choice<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span>message_to_user<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token namespace">io<span class="token punctuation">::</span></span><span class="token function">stdin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read_line</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-mut">mut</span> choice<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">"error: unable to read user choice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            numeric_choice <span class="token operator">=</span> choice<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword keyword-i8">i8</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_or</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">//bad</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> numeric_choice <span class="token operator">&lt;</span>  <span class="token number">1</span> <span class="token operator">||</span> numeric_choice <span class="token operator">&gt;</span> amount_of_packs_in_box </span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                message_to_user <span class="token operator">=</span> <span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"Don't be silly. Choose a correct pack number between 1 &amp; {}...  "</span><span class="token punctuation">,</span>amount_of_packs_in_box<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword keyword-continue">continue</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token keyword keyword-else">else</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token comment">// Box.greatest_cards();    </span></span>
<span class="line">        <span class="token namespace">clear_console<span class="token punctuation">::</span></span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> pack <span class="token operator">=</span> box_instance<span class="token punctuation">.</span><span class="token function">retrieve_pack</span><span class="token punctuation">(</span>numeric_choice<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"\nYou picked pack #{}!"</span><span class="token punctuation">,</span>choice<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        pack<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        box_instance<span class="token punctuation">.</span><span class="token function">ranking_pack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pack<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        box_instance<span class="token punctuation">.</span><span class="token function">greatest_cards</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"\nDo you want to open a pack from another box of cards?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"\n(Write \"No\" or \"Q\" or \"Quit\" if you want to leave)\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        choice<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token namespace">io<span class="token punctuation">::</span></span><span class="token function">stdin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read_line</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-mut">mut</span> choice<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">"error: unable to read user choice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token namespace">clear_console<span class="token punctuation">::</span></span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Rust Image Reducer</div>
                <div class="description">A Rust tool to reduce image sizes.</div>
                <div class="languages">Rust</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-rust" tabindex="0">                <code class="language-rust"><span class="line"><span class="token comment">//allow dead code</span></span>
<span class="line"><span class="token attribute attr-name">#![allow(dead_code, warnings)]</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-use">use</span> image<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-use">use</span> <span class="token namespace">std<span class="token punctuation">::</span>path<span class="token punctuation">::</span></span><span class="token class-name">Path</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// ask user for the File Path</span></span>
<span class="line">    <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> directory <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Enter the file path&gt;  "</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token function">stdin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read_line</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-mut">mut</span> directory<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">"Failed to read line"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// trim directory</span></span>
<span class="line">    directory <span class="token operator">=</span> directory<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// make a new directory if it doesn't exist</span></span>
<span class="line">    <span class="token keyword keyword-let">let</span> new_directory <span class="token operator">=</span> directory<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"_r"</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token operator">!</span><span class="token class-name">Path</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>new_directory<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token function">create_dir</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>new_directory<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">// get all files in directory</span></span>
<span class="line">    <span class="token keyword keyword-let">let</span> files_in_directory <span class="token operator">=</span> <span class="token function">get_files_in_directory</span><span class="token punctuation">(</span>directory<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-let">let</span> first_file <span class="token operator">=</span> <span class="token operator">&amp;</span>files_in_directory<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-for">for</span> file_name <span class="token keyword keyword-in">in</span> files_in_directory <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> file_metadata <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token function">metadata</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>file_name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> file_size <span class="token operator">=</span> file_metadata<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> quality <span class="token operator">=</span> <span class="token function">get_quality</span><span class="token punctuation">(</span>file_size<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">compress_image</span><span class="token punctuation">(</span>file_name<span class="token punctuation">.</span><span class="token function">as_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> quality<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">        <span class="token comment">// index += 1;</span></span>
<span class="line">        <span class="token comment">// if index == 10 {</span></span>
<span class="line">        <span class="token comment">//     break;</span></span>
<span class="line">        <span class="token comment">// }</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">get_quality</span><span class="token punctuation">(</span>file_size<span class="token punctuation">:</span> <span class="token keyword keyword-u64">u64</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword keyword-u8">u8</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token keyword keyword-match">match</span> file_size <span class="token punctuation">{</span></span>
<span class="line">        <span class="token number">0</span><span class="token punctuation">..=</span><span class="token number">100_000</span> <span class="token operator">=&gt;</span> <span class="token number">80</span><span class="token punctuation">,</span>    </span>
<span class="line">        <span class="token number">100_001</span><span class="token punctuation">..=</span><span class="token number">200_000</span> <span class="token operator">=&gt;</span> <span class="token number">72</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token number">200_001</span><span class="token punctuation">..=</span><span class="token number">300_000</span> <span class="token operator">=&gt;</span> <span class="token number">71</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token number">300_001</span><span class="token punctuation">..=</span><span class="token number">400_000</span> <span class="token operator">=&gt;</span> <span class="token number">70</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token number">400_001</span><span class="token punctuation">..=</span><span class="token number">500_000</span> <span class="token operator">=&gt;</span> <span class="token number">60</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token number">500_001</span><span class="token punctuation">..=</span><span class="token number">600_000</span> <span class="token operator">=&gt;</span> <span class="token number">25</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token number">600_001</span><span class="token punctuation">..=</span><span class="token number">700_000</span> <span class="token operator">=&gt;</span> <span class="token number">22</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token number">700_001</span><span class="token punctuation">..=</span><span class="token number">800_000</span> <span class="token operator">=&gt;</span> <span class="token number">18</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token number">800_001</span><span class="token punctuation">..</span> <span class="token operator">=&gt;</span> <span class="token number">13</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">get_files_in_directory</span><span class="token punctuation">(</span>directory<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> files <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-for">for</span> entry <span class="token keyword keyword-in">in</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token function">read_dir</span><span class="token punctuation">(</span>directory<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> entry <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> path <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> extension <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">extension</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_or_default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-let">let</span> image_extensions <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"jpg"</span><span class="token punctuation">,</span> <span class="token string">"jpeg"</span><span class="token punctuation">,</span> <span class="token string">"png"</span><span class="token punctuation">,</span> <span class="token string">"bmp"</span><span class="token punctuation">,</span> <span class="token string">"gif"</span><span class="token punctuation">,</span> <span class="token string">"jfif"</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> path<span class="token punctuation">.</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> image_extensions<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>extension<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            files<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">to_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    files</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">//compress image using image crate and have quality parameter</span></span>
<span class="line"><span class="token keyword keyword-fn">fn</span> <span class="token function-definition function">compress_image</span><span class="token punctuation">(</span>image_path<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword keyword-str">str</span><span class="token punctuation">,</span> image_quality<span class="token punctuation">:</span> <span class="token keyword keyword-u8">u8</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-let">let</span> image <span class="token operator">=</span> <span class="token namespace">image<span class="token punctuation">::</span></span><span class="token function">open</span><span class="token punctuation">(</span>image_path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-mut">mut</span> buffer <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-let">let</span> path <span class="token operator">=</span> <span class="token class-name">Path</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>image_path<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-let">let</span> path_directory_parent <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-let">let</span> file_prefix <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">file_stem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-let">let</span> extension <span class="token operator">=</span> <span class="token string">"jpg"</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-let">let</span> new_full_file_path <span class="token operator">=</span> <span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"{}_r/{}_{}.{}"</span><span class="token punctuation">,</span> path_directory_parent<span class="token punctuation">,</span> file_prefix<span class="token punctuation">,</span> image_quality<span class="token punctuation">,</span> extension<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    image<span class="token punctuation">.</span><span class="token function">write_to</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword keyword-mut">mut</span> buffer<span class="token punctuation">,</span> <span class="token namespace">image<span class="token punctuation">::</span></span><span class="token class-name">ImageOutputFormat</span><span class="token punctuation">::</span><span class="token class-name">Jpeg</span><span class="token punctuation">(</span>image_quality<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>new_full_file_path<span class="token punctuation">,</span> <span class="token operator">&amp;</span>buffer<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-let">let</span> size_in_bytes <span class="token operator">=</span> buffer<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// println!("{} bytes written in {}", size_in_bytes, &amp;new_full_file_path);</span></span>
<span class="line"><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Python OpenGL Pyramids</div>
                <div class="description">OpenGL of a spinning 3D pyramid in Python!!! Looks like an amazing video game &amp; Nintendo 64!!! (love OpenGL)</div>
                <div class="languages">Python</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-python" tabindex="0">                <code class="language-python"><span class="line"><span class="token keyword keyword-import">import</span> OpenGL</span>
<span class="line"><span class="token keyword keyword-from">from</span> ctypes <span class="token keyword keyword-import">import</span> <span class="token operator">*</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> glm</span>
<span class="line"><span class="token keyword keyword-import">import</span> random</span>
<span class="line"><span class="token keyword keyword-import">import</span> sys</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-from">from</span> OpenGL<span class="token punctuation">.</span>GL <span class="token keyword keyword-import">import</span> <span class="token operator">*</span></span>
<span class="line"><span class="token keyword keyword-from">from</span> OpenGL<span class="token punctuation">.</span>GLUT <span class="token keyword keyword-import">import</span> <span class="token operator">*</span></span>
<span class="line"><span class="token keyword keyword-from">from</span> OpenGL<span class="token punctuation">.</span>GLU <span class="token keyword keyword-import">import</span> <span class="token operator">*</span></span>
<span class="line"><span class="token keyword keyword-from">from</span> OpenGL<span class="token punctuation">.</span>GL<span class="token punctuation">.</span>shaders <span class="token keyword keyword-import">import</span> <span class="token operator">*</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-import">import</span> random</span>
<span class="line"><span class="token keyword keyword-from">from</span> helpers <span class="token keyword keyword-import">import</span> <span class="token operator">*</span></span>
<span class="line"><span class="token keyword keyword-from">from</span> PIL <span class="token keyword keyword-import">import</span> Image</span>
<span class="line">&nbsp;</span>
<span class="line">width <span class="token operator">=</span> <span class="token number">800</span></span>
<span class="line">height <span class="token operator">=</span> <span class="token number">600</span></span>
<span class="line">&nbsp;</span>
<span class="line">factor <span class="token operator">=</span> <span class="token number">0.55</span></span>
<span class="line">&nbsp;</span>
<span class="line">texcoord_0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">texcoord_1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">texcoord_2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">texcoord_3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">texcoord_4 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span></span>
<span class="line">&nbsp;</span>
<span class="line">vertices <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">   <span class="token comment"># COORDINATES  /COLORS        / TexCoord</span></span>
<span class="line">    <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> texcoord_0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> texcoord_0<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># Vertex 0 Top Right Green</span></span>
<span class="line">    <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> texcoord_1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> texcoord_1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># Vertex 1 Bottom Right Blue</span></span>
<span class="line">    <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> texcoord_2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> texcoord_2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># Vertex 2 Bottom Left Green</span></span>
<span class="line">    <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> texcoord_3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> texcoord_3<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># Vertex 3 Top Left Yellow</span></span>
<span class="line">    <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> texcoord_4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> texcoord_4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># Vertex 4 Pyramid Top Red</span></span>
<span class="line"><span class="token punctuation">]</span> </span>
<span class="line">&nbsp;</span>
<span class="line">attributes_in_vertex <span class="token operator">=</span> <span class="token number">8</span></span>
<span class="line">total_vertices <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>vertices<span class="token punctuation">)</span> <span class="token operator">/</span> attributes_in_vertex<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># PYRAMID</span></span>
<span class="line">indices <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">     <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment"># Triangle 1</span></span>
<span class="line">    <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment"># Triangle 2</span></span>
<span class="line">    <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment"># Triangle 3</span></span>
<span class="line">    <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment"># Triangle 4</span></span>
<span class="line">    <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment"># Triangle 5</span></span>
<span class="line">    <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment"># Triangle 6</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line">&nbsp;</span>
<span class="line">vertex_shader <span class="token operator">=</span> <span class="token triple-quoted-string string">"""</span>
<span class="line">#version 330 core</span>
<span class="line">&nbsp;</span>
<span class="line">// Positions/Coordinates</span>
<span class="line">layout (location = 0) in vec3 aPos;</span>
<span class="line">// Colors</span>
<span class="line">layout (location = 1) in vec3 aColor;</span>
<span class="line">// Texture Coordinates</span>
<span class="line">layout (location = 2) in vec2 aTex;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">// Outputs the color for the Fragment Shader</span>
<span class="line">out vec3 color;</span>
<span class="line">// Outputs the texture coordinates to the fragment shader</span>
<span class="line">out vec2 texCoord;</span>
<span class="line">out vec4 position;</span>
<span class="line">flat out int instanceID;</span>
<span class="line">&nbsp;</span>
<span class="line">// Controls the scale of the vertices</span>
<span class="line">uniform float scale;</span>
<span class="line">&nbsp;</span>
<span class="line">// Inputs the matrices needed for 3D viewing with perspective</span>
<span class="line">uniform mat4 model;</span>
<span class="line">uniform mat4 view;</span>
<span class="line">uniform mat4 proj;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">float cube_root(float x)</span>
<span class="line">{</span>
<span class="line">    return pow(x, 1.0 / 3.0);</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">float dec(float x)</span>
<span class="line">{</span>
<span class="line">    return x - floor(x);</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">float strip_dec(float x)</span>
<span class="line">{</span>
<span class="line">    return int(x) % 1;</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">void main()</span>
<span class="line">{</span>
<span class="line">    // line the shapes next to each other on the x-axis based on gl_InstanceID</span>
<span class="line">    // move the location of the pyramid based on the gl_InstanceID</span>
<span class="line">    </span>
<span class="line">    float distance = 4.0;</span>
<span class="line">    float cube_radius = ceil(cube_root(2500));</span>
<span class="line">    float squared = pow(cube_radius, 2);</span>
<span class="line">   </span>
<span class="line">    // left-right horizontal</span>
<span class="line">    // floor(((77 % 16) / 16) * 5)</span>
<span class="line">    float move_z = floor(((gl_InstanceID % int(squared)) / squared) * cube_radius) * distance;</span>
<span class="line">&nbsp;</span>
<span class="line">    // </span>
<span class="line">    // height </span>
<span class="line">    //</span>
<span class="line">    //    64 / 16 = 4th level</span>
<span class="line">    //</span>
<span class="line">    float move_y = floor(gl_InstanceID / squared) * distance;</span>
<span class="line">&nbsp;</span>
<span class="line">    // towards me</span>
<span class="line">    float move_x = floor(gl_InstanceID % int(cube_radius)) * distance;</span>
<span class="line">&nbsp;</span>
<span class="line">    </span>
<span class="line">    </span>
<span class="line">    </span>
<span class="line">    gl_Position = proj * view * vec4(aPos.x + move_x, aPos.y + move_y, aPos.z + move_z, 1.0);</span>
<span class="line">    position = proj * view * vec4(aPos.x + move_x, aPos.y + move_y, aPos.z + move_z, 1.0);</span>
<span class="line">	// Assigns the colors from the Vertex Data to "color"</span>
<span class="line">	color = aColor;</span>
<span class="line">	// Assigns the texture coordinates from the Vertex Data to "texCoord"</span>
<span class="line">	texCoord = aTex;</span>
<span class="line">    instanceID = gl_InstanceID;</span>
<span class="line">}</span>
<span class="line">"""</span></span>
<span class="line">&nbsp;</span>
<span class="line">fragment_shader <span class="token operator">=</span> <span class="token triple-quoted-string string">"""</span>
<span class="line">#version 330 core</span>
<span class="line">&nbsp;</span>
<span class="line">// Outputs colors in RGBA</span>
<span class="line">out vec4 FragColor;</span>
<span class="line">&nbsp;</span>
<span class="line">// Inputs the color from the Vertex Shader</span>
<span class="line">in vec3 color;</span>
<span class="line">in vec4 position;</span>
<span class="line">// Inputs the texture coordinates from the Vertex Shader</span>
<span class="line">in vec2 texCoord;</span>
<span class="line">&nbsp;</span>
<span class="line">flat in int instanceID;</span>
<span class="line">&nbsp;</span>
<span class="line">// Inputs the texture sampler</span>
<span class="line">uniform float count;</span>
<span class="line">uniform sampler2D imageTextureFoxNews;</span>
<span class="line">uniform sampler2D imageTextureCnn;</span>
<span class="line">uniform sampler2D imageTextureMsnbc;</span>
<span class="line">uniform sampler2D imageTextureAbc;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">void main()</span>
<span class="line">{</span>
<span class="line">&nbsp;</span>
<span class="line">    vec4 texture_colors;</span>
<span class="line">    </span>
<span class="line">    if(instanceID % 4 == 0)</span>
<span class="line">    {</span>
<span class="line">	    texture_colors = texture2D(imageTextureFoxNews, texCoord);</span>
<span class="line">    }</span>
<span class="line">    else if (instanceID % 4 == 1)</span>
<span class="line">    {</span>
<span class="line">        texture_colors = texture2D(imageTextureCnn, texCoord);</span>
<span class="line">    }</span>
<span class="line">    else if (instanceID % 4 == 2)</span>
<span class="line">    {</span>
<span class="line">        texture_colors = texture2D(imageTextureMsnbc, texCoord);</span>
<span class="line">    }</span>
<span class="line">    else if (instanceID % 4 == 3)</span>
<span class="line">    {</span>
<span class="line">        texture_colors = texture2D(imageTextureAbc, texCoord);</span>
<span class="line">    }</span>
<span class="line">&nbsp;</span>
<span class="line">   </span>
<span class="line">    </span>
<span class="line">&nbsp;</span>
<span class="line">    //shine light from position that was passed in</span>
<span class="line">    vec3 diffuse_color = vec3(1.0, 1.0, 1.0);</span>
<span class="line">    vec3 specular_color = vec3(1.0, 1.0, 1.0);</span>
<span class="line">    vec3 ambient_color = vec3(1.0, 1.0, 1.0);</span>
<span class="line">    float shininess = .60;</span>
<span class="line">    float light_intensity = 0.05;</span>
<span class="line">    float ambient_intensity = 0.0;</span>
<span class="line">    float diffuse_intensity = 2.0;</span>
<span class="line">    float specular_intensity = 10.0;</span>
<span class="line">    </span>
<span class="line">    vec3 normal = normalize(position.xyz);</span>
<span class="line">    </span>
<span class="line">    float locations[2] = {200.0,2.0};</span>
<span class="line">    float location = 0.0;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">    vec3 view_position, light_position, view_direction, light_direction, reflect_direction;</span>
<span class="line">    float diffuse_factor, specular_factor;</span>
<span class="line">    vec4 diffuse_color_final, specular_color_final;</span>
<span class="line">    int j = 0;</span>
<span class="line">&nbsp;</span>
<span class="line">    </span>
<span class="line">    //to iterate through the location array</span>
<span class="line">    for(j = 0; j &lt; 3; j++)</span>
<span class="line">    {</span>
<span class="line">        location = locations[j];</span>
<span class="line">        light_position = vec3(-5.0, location, 0.0);</span>
<span class="line">        view_position = vec3(location, location, 300.0);</span>
<span class="line">        light_direction = normalize(light_position - position.xyz);</span>
<span class="line">        view_direction = normalize(view_position - position.xyz);</span>
<span class="line">        diffuse_factor = max(dot(light_direction, normal), 0.0);</span>
<span class="line">        reflect_direction = reflect(light_direction, normal);</span>
<span class="line">        diffuse_color_final += vec4(diffuse_color * diffuse_factor, 1.0) * light_intensity;</span>
<span class="line">        specular_factor = pow(max(dot(view_direction, reflect_direction), 0.0), shininess);</span>
<span class="line">        specular_color_final += vec4(specular_color * light_intensity * specular_intensity * specular_factor, 256.0);</span>
<span class="line">    }</span>
<span class="line">    </span>
<span class="line">&nbsp;</span>
<span class="line">    </span>
<span class="line">    vec4 ambient_color_final = vec4(ambient_color * light_intensity * ambient_intensity, 1.0);</span>
<span class="line">    vec4 final_color = diffuse_color_final + specular_color_final + ambient_color_final;</span>
<span class="line">&nbsp;</span>
<span class="line">    // get x &amp; y from the texture</span>
<span class="line">    float texCoordX = texCoord.x;</span>
<span class="line">    float texCoordY = texCoord.y;</span>
<span class="line">    // get resolution variables from the texture</span>
<span class="line">    float resolutionX = texture_colors.x;</span>
<span class="line">    float resolutionY = texture_colors.y;</span>
<span class="line">    </span>
<span class="line">&nbsp;</span>
<span class="line">    FragColor = final_color * texture_colors;</span>
<span class="line">&nbsp;</span>
<span class="line">}</span>
<span class="line">"""</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">bind_vao_to_vbo</span></span><span class="token punctuation">(</span>vbo<span class="token punctuation">,</span> location_in_shader<span class="token punctuation">,</span> elements_in_attribute<span class="token punctuation">,</span> element_type<span class="token punctuation">,</span> values_as_is_bool<span class="token punctuation">,</span> stride<span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment">#</span></span>
<span class="line">    <span class="token comment"># location in shader - a number that represents the attribute that's listed ON the top of shader</span></span>
<span class="line">    <span class="token comment"># elements in attribute - how many elements are in the attribute</span></span>
<span class="line">    <span class="token comment"># element type - the type of each element</span></span>
<span class="line">    <span class="token comment"># values as-is bool - are the values as-is?</span></span>
<span class="line">    <span class="token comment"># stride - stride is the size of a single vertex!! So if you have 3 for position, 3 for color, and 2 for texture, the stride is 8</span></span>
<span class="line">    <span class="token comment"># offset - offset is the distance away from the zero element in the vertex/vertice array</span></span>
<span class="line">    <span class="token comment">#</span></span>
<span class="line">    <span class="token comment"># binds the vao to the vbo</span></span>
<span class="line">    glBindBuffer<span class="token punctuation">(</span>GL_ARRAY_BUFFER<span class="token punctuation">,</span> vbo<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># defines the attribute in the shader</span></span>
<span class="line">    glVertexAttribPointer<span class="token punctuation">(</span>location_in_shader<span class="token punctuation">,</span> elements_in_attribute<span class="token punctuation">,</span> element_type<span class="token punctuation">,</span> values_as_is_bool<span class="token punctuation">,</span> stride<span class="token punctuation">,</span> offset<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># enables the attribute in the shader</span></span>
<span class="line">    glEnableVertexAttribArray<span class="token punctuation">(</span>location_in_shader<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># unbinds the vao from the vbo</span></span>
<span class="line">    glBindBuffer<span class="token punctuation">(</span>GL_ARRAY_BUFFER<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">set_uniform_shader_variable</span></span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-global">global</span> program</span>
<span class="line">    location <span class="token operator">=</span> glGetUniformLocation<span class="token punctuation">(</span>program<span class="token punctuation">,</span> name<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">==</span> glm<span class="token punctuation">.</span>vec3<span class="token punctuation">:</span></span>
<span class="line">        glUniform3fv<span class="token punctuation">(</span>location<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> glm<span class="token punctuation">.</span>value_ptr<span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> <span class="token builtin">type</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">==</span> glm<span class="token punctuation">.</span>mat4<span class="token punctuation">:</span></span>
<span class="line">        glUniformMatrix4fv<span class="token punctuation">(</span>location<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> glm<span class="token punctuation">.</span>value_ptr<span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> <span class="token builtin">type</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">int</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># typically used for scale &amp; translation &amp; textures</span></span>
<span class="line">        glUniform1i<span class="token punctuation">(</span>location<span class="token punctuation">,</span> value<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> <span class="token builtin">type</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">float</span><span class="token punctuation">:</span></span>
<span class="line">        glUniform1f<span class="token punctuation">(</span>location<span class="token punctuation">,</span> value<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Unsupported type"</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">file_get_contents</span></span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-with">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> f<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">Texture</span><span class="token punctuation">:</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">__init__</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filepath<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>texture <span class="token operator">=</span> glGenTextures<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        glBindTexture<span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> self<span class="token punctuation">.</span>texture<span class="token punctuation">)</span></span>
<span class="line">        glTexParameteri<span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> GL_TEXTURE_WRAP_S<span class="token punctuation">,</span> GL_CLAMP_TO_EDGE<span class="token punctuation">)</span></span>
<span class="line">        glTexParameteri<span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> GL_TEXTURE_WRAP_T<span class="token punctuation">,</span> GL_CLAMP_TO_EDGE<span class="token punctuation">)</span></span>
<span class="line">        glTexParameteri<span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> GL_TEXTURE_MIN_FILTER<span class="token punctuation">,</span> GL_NEAREST<span class="token punctuation">)</span></span>
<span class="line">        glTexParameteri<span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> GL_TEXTURE_MAG_FILTER<span class="token punctuation">,</span> GL_LINEAR<span class="token punctuation">)</span></span>
<span class="line">        image <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>filepath<span class="token punctuation">)</span></span>
<span class="line">        image_width<span class="token punctuation">,</span> image_height <span class="token operator">=</span> image<span class="token punctuation">.</span>size</span>
<span class="line">        image_bytes <span class="token operator">=</span> image<span class="token punctuation">.</span>tobytes<span class="token punctuation">(</span><span class="token string">'raw'</span><span class="token punctuation">,</span> <span class="token string">'RGBA'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        glTexImage2D<span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> GL_RGBA<span class="token punctuation">,</span> image_width<span class="token punctuation">,</span> image_height<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> GL_RGBA<span class="token punctuation">,</span> GL_UNSIGNED_BYTE<span class="token punctuation">,</span> image_bytes<span class="token punctuation">)</span></span>
<span class="line">        glGenerateMipmap<span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">use</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> fragment_shader_location<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        glActiveTexture<span class="token punctuation">(</span>GL_TEXTURE0 <span class="token operator">+</span> fragment_shader_location<span class="token punctuation">)</span></span>
<span class="line">        glBindTexture<span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span>self<span class="token punctuation">.</span>texture<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">destroy</span></span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        glDeleteTextures<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>texture<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># make context</span></span>
<span class="line">glutInit<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">glutInitDisplayMode<span class="token punctuation">(</span>GLUT_DOUBLE <span class="token operator">|</span> GLUT_RGB <span class="token operator">|</span> GLUT_DEPTH<span class="token punctuation">)</span></span>
<span class="line">glutInitWindowSize<span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span></span>
<span class="line">glutCreateWindow<span class="token punctuation">(</span><span class="token string">"Pyramid"</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># WITHOUT THIS YOU WILL HAVE TRANSPARENT COLORS &amp; TRANSPARENT FACES OF THE SHAPE</span></span>
<span class="line">glEnable<span class="token punctuation">(</span>GL_DEPTH_TEST<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># compile shaders</span></span>
<span class="line">vertex_shader <span class="token operator">=</span> compileShader<span class="token punctuation">(</span>vertex_shader<span class="token punctuation">,</span> GL_VERTEX_SHADER<span class="token punctuation">)</span></span>
<span class="line">fragment_shader <span class="token operator">=</span> compileShader<span class="token punctuation">(</span>fragment_shader<span class="token punctuation">,</span> GL_FRAGMENT_SHADER<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># create program &amp; link shaders</span></span>
<span class="line">program <span class="token operator">=</span> glCreateProgram<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">glAttachShader<span class="token punctuation">(</span>program<span class="token punctuation">,</span> vertex_shader<span class="token punctuation">)</span></span>
<span class="line">glAttachShader<span class="token punctuation">(</span>program<span class="token punctuation">,</span> fragment_shader<span class="token punctuation">)</span></span>
<span class="line">glLinkProgram<span class="token punctuation">(</span>program<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># use program that consists of shaders</span></span>
<span class="line">glUseProgram<span class="token punctuation">(</span>program<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># create a vertex array object (VAO)</span></span>
<span class="line">vao <span class="token operator">=</span> glGenVertexArrays<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">glBindVertexArray<span class="token punctuation">(</span>vao<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># create a vertex buffer object (VBO)</span></span>
<span class="line"><span class="token builtin">id</span> <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">vbo <span class="token operator">=</span> glGenBuffers<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">glBindBuffer<span class="token punctuation">(</span>GL_ARRAY_BUFFER<span class="token punctuation">,</span> vbo<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># create a element buffer object (EBO)</span></span>
<span class="line">ebo <span class="token operator">=</span> glGenBuffers<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">glBindBuffer<span class="token punctuation">(</span>GL_ELEMENT_ARRAY_BUFFER<span class="token punctuation">,</span> ebo<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># copy index data to GPU (from the EBO)</span></span>
<span class="line">glBufferData<span class="token punctuation">(</span></span>
<span class="line">    GL_ELEMENT_ARRAY_BUFFER<span class="token punctuation">,</span> <span class="token comment"># target</span></span>
<span class="line">    <span class="token builtin">len</span><span class="token punctuation">(</span>indices<span class="token punctuation">)</span> <span class="token operator">*</span> sizeof<span class="token punctuation">(</span>c_int<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># size in bytes</span></span>
<span class="line">    <span class="token punctuation">(</span>c_int <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>indices<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>indices<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># data to be sent to the buffer</span></span>
<span class="line">    GL_STATIC_DRAW <span class="token comment"># usage </span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># copy vertices data to the GPU (from the VBO)</span></span>
<span class="line">glBufferData<span class="token punctuation">(</span>GL_ARRAY_BUFFER<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>vertices<span class="token punctuation">)</span> <span class="token operator">*</span> sizeof<span class="token punctuation">(</span>c_float<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c_float <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>vertices<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>vertices<span class="token punctuation">)</span><span class="token punctuation">,</span> GL_STATIC_DRAW<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># define each attribute of each Vertex Array Object (VAO) &amp; bind it to the Vertex Buffer Object (VBO)</span></span>
<span class="line"><span class="token comment"># these three functions pertain to ONE vertex each, which has attributes like position, color, and texture</span></span>
<span class="line">bind_vao_to_vbo<span class="token punctuation">(</span>vbo<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> GL_FLOAT<span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> sizeof<span class="token punctuation">(</span>c_float<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">,</span> c_void_p<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">bind_vao_to_vbo<span class="token punctuation">(</span>vbo<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> GL_FLOAT<span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> sizeof<span class="token punctuation">(</span>c_float<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">,</span> c_void_p<span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> sizeof<span class="token punctuation">(</span>c_float<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">bind_vao_to_vbo<span class="token punctuation">(</span>vbo<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> GL_FLOAT<span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> sizeof<span class="token punctuation">(</span>c_float<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">,</span> c_void_p<span class="token punctuation">(</span><span class="token number">6</span> <span class="token operator">*</span> sizeof<span class="token punctuation">(</span>c_float<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">#unbind VAO &amp; EBO (the VBO is already unbound)</span></span>
<span class="line">glBindVertexArray<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">glBindBuffer<span class="token punctuation">(</span>GL_ELEMENT_ARRAY_BUFFER<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment">#   TEXTURES</span></span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment">#</span></span>
<span class="line">fox_news_texture <span class="token operator">=</span> Texture<span class="token punctuation">(</span><span class="token string">"fox_news_square_rbga.png"</span><span class="token punctuation">)</span></span>
<span class="line">cnn_texture <span class="token operator">=</span> Texture<span class="token punctuation">(</span><span class="token string">"cnn_rbga.png"</span><span class="token punctuation">)</span></span>
<span class="line">msnbc_texture <span class="token operator">=</span> Texture<span class="token punctuation">(</span><span class="token string">"msnbc_rbga.png"</span><span class="token punctuation">)</span></span>
<span class="line">abc_texture <span class="token operator">=</span> Texture<span class="token punctuation">(</span><span class="token string">"abc_rbga.png"</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># define variables for render function</span></span>
<span class="line">rotation <span class="token operator">=</span> <span class="token number">0.0</span></span>
<span class="line">rotation_speed <span class="token operator">=</span> <span class="token number">0.2</span></span>
<span class="line">model_1 <span class="token operator">=</span> <span class="token number">0.0</span></span>
<span class="line">model_2 <span class="token operator">=</span> <span class="token number">1.0</span></span>
<span class="line">model_3 <span class="token operator">=</span> <span class="token number">0.0</span></span>
<span class="line">translate_1 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">10</span></span>
<span class="line">translate_2 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">10</span></span>
<span class="line">translate_3 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">20</span></span>
<span class="line">proj_radians <span class="token operator">=</span> <span class="token number">45.0</span></span>
<span class="line">proj_1 <span class="token operator">=</span> <span class="token number">0.1</span></span>
<span class="line">proj_2 <span class="token operator">=</span> <span class="token number">100.0</span></span>
<span class="line">count <span class="token operator">=</span> <span class="token number">0.0</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># def debug():</span></span>
<span class="line"><span class="token comment">#     model = glm.mat4(1.0);</span></span>
<span class="line"><span class="token comment">#     view = glm.mat4(1.0);</span></span>
<span class="line"><span class="token comment">#     proj = glm.mat4(1.0);</span></span>
<span class="line"><span class="token comment">#     global rotation</span></span>
<span class="line"><span class="token comment">#     rotation += 0.2</span></span>
<span class="line"><span class="token comment">#     model = glm.rotate(model, glm.radians(rotation), glm.vec3(model_1, model_2, model_3))</span></span>
<span class="line"><span class="token comment">#     view = glm.translate(view, glm.vec3(0.0, -0.5, -10.0))</span></span>
<span class="line"><span class="token comment">#     proj = glm.perspective(glm.radians(45.0), width / height, 0.1, 100.0)</span></span>
<span class="line"><span class="token comment">#     print("model: \n", model)</span></span>
<span class="line"><span class="token comment">#     print("view: \n", view)</span></span>
<span class="line"><span class="token comment">#     print("proj: \n", proj)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># debug()</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">render</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    model <span class="token operator">=</span> glm<span class="token punctuation">.</span>mat4<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    view <span class="token operator">=</span> glm<span class="token punctuation">.</span>mat4<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    proj <span class="token operator">=</span> glm<span class="token punctuation">.</span>mat4<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-global">global</span> rotation</span>
<span class="line">    <span class="token keyword keyword-global">global</span> rotation_speed</span>
<span class="line">    <span class="token keyword keyword-global">global</span> count</span>
<span class="line">    rotation <span class="token operator">+=</span> rotation_speed</span>
<span class="line">    model <span class="token operator">=</span> glm<span class="token punctuation">.</span>rotate<span class="token punctuation">(</span>model<span class="token punctuation">,</span> glm<span class="token punctuation">.</span>radians<span class="token punctuation">(</span>rotation<span class="token punctuation">)</span><span class="token punctuation">,</span> glm<span class="token punctuation">.</span>vec3<span class="token punctuation">(</span>model_1<span class="token punctuation">,</span> model_2<span class="token punctuation">,</span> model_3<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    view <span class="token operator">=</span> glm<span class="token punctuation">.</span>translate<span class="token punctuation">(</span>view<span class="token punctuation">,</span> glm<span class="token punctuation">.</span>vec3<span class="token punctuation">(</span>translate_1<span class="token punctuation">,</span> translate_2<span class="token punctuation">,</span> translate_3<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    proj <span class="token operator">=</span> glm<span class="token punctuation">.</span>perspective<span class="token punctuation">(</span>glm<span class="token punctuation">.</span>radians<span class="token punctuation">(</span>proj_radians<span class="token punctuation">)</span><span class="token punctuation">,</span> width <span class="token operator">/</span> height<span class="token punctuation">,</span> proj_1<span class="token punctuation">,</span> proj_2<span class="token punctuation">)</span></span>
<span class="line">    set_uniform_shader_variable<span class="token punctuation">(</span><span class="token string">"model"</span><span class="token punctuation">,</span> model<span class="token punctuation">)</span></span>
<span class="line">    set_uniform_shader_variable<span class="token punctuation">(</span><span class="token string">"view"</span><span class="token punctuation">,</span> view<span class="token punctuation">)</span></span>
<span class="line">    set_uniform_shader_variable<span class="token punctuation">(</span><span class="token string">"proj"</span><span class="token punctuation">,</span> proj<span class="token punctuation">)</span></span>
<span class="line">    set_uniform_shader_variable<span class="token punctuation">(</span><span class="token string">"imageTextureFoxNews"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">    set_uniform_shader_variable<span class="token punctuation">(</span><span class="token string">"imageTextureCnn"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    set_uniform_shader_variable<span class="token punctuation">(</span><span class="token string">"imageTextureMsnbc"</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">    set_uniform_shader_variable<span class="token punctuation">(</span><span class="token string">"imageTextureAbc"</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line">    set_uniform_shader_variable<span class="token punctuation">(</span><span class="token string">"count"</span><span class="token punctuation">,</span>count<span class="token punctuation">)</span></span>
<span class="line">    count <span class="token operator">+=</span> <span class="token number">.02</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token comment"># use texture</span></span>
<span class="line">    fox_news_texture<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">    cnn_texture<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    msnbc_texture<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">    abc_texture<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># bind vao</span></span>
<span class="line">    glBindVertexArray<span class="token punctuation">(</span>vao<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># start drawing</span></span>
<span class="line">    <span class="token comment"># glClearColor(0.5, 0.5, 0.5, 1.0)</span></span>
<span class="line">    glClear<span class="token punctuation">(</span>GL_COLOR_BUFFER_BIT <span class="token operator">|</span> GL_DEPTH_BUFFER_BIT<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># glDrawArrays(GL_TRIANGLES, 0, len(vertices))</span></span>
<span class="line">    <span class="token comment"># glDrawElements(GL_TRIANGLES, len(indices), GL_UNSIGNED_INT, c_void_p(0))</span></span>
<span class="line">    glDrawElementsInstanced<span class="token punctuation">(</span>GL_TRIANGLES<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>indices<span class="token punctuation">)</span><span class="token punctuation">,</span> GL_UNSIGNED_INT<span class="token punctuation">,</span> c_void_p<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2500</span><span class="token punctuation">)</span></span>
<span class="line">    glutSwapBuffers<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># poll events</span></span>
<span class="line">    glutPostRedisplay<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">key_pressed</span></span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-global">global</span> model_1</span>
<span class="line">    <span class="token keyword keyword-global">global</span> model_2</span>
<span class="line">    <span class="token keyword keyword-global">global</span> model_3</span>
<span class="line">    <span class="token keyword keyword-global">global</span> rotation_speed</span>
<span class="line">    <span class="token keyword keyword-global">global</span> translate_1</span>
<span class="line">    <span class="token keyword keyword-global">global</span> translate_2</span>
<span class="line">    <span class="token keyword keyword-global">global</span> translate_3</span>
<span class="line">    <span class="token keyword keyword-global">global</span> proj_radians</span>
<span class="line">    <span class="token keyword keyword-global">global</span> proj_1</span>
<span class="line">    <span class="token keyword keyword-global">global</span> proj_2</span>
<span class="line">    amount <span class="token operator">=</span> <span class="token number">0.1</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'q'</span><span class="token punctuation">:</span></span>
<span class="line">        model_1 <span class="token operator">+=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'a'</span><span class="token punctuation">:</span></span>
<span class="line">        model_1 <span class="token operator">-=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'w'</span><span class="token punctuation">:</span></span>
<span class="line">        model_2 <span class="token operator">+=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b's'</span><span class="token punctuation">:</span></span>
<span class="line">        model_2 <span class="token operator">-=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'e'</span><span class="token punctuation">:</span></span>
<span class="line">        model_3 <span class="token operator">+=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'd'</span><span class="token punctuation">:</span></span>
<span class="line">        model_3 <span class="token operator">-=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'r'</span><span class="token punctuation">:</span></span>
<span class="line">        rotation_speed <span class="token operator">+=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'f'</span><span class="token punctuation">:</span></span>
<span class="line">        rotation_speed <span class="token operator">-=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b't'</span><span class="token punctuation">:</span></span>
<span class="line">        translate_1 <span class="token operator">-=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'g'</span><span class="token punctuation">:</span></span>
<span class="line">        translate_1 <span class="token operator">+=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'y'</span><span class="token punctuation">:</span></span>
<span class="line">        translate_2 <span class="token operator">-=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'h'</span><span class="token punctuation">:</span></span>
<span class="line">        translate_2 <span class="token operator">+=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'u'</span><span class="token punctuation">:</span></span>
<span class="line">        translate_3 <span class="token operator">+=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'j'</span><span class="token punctuation">:</span></span>
<span class="line">        translate_3 <span class="token operator">-=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'i'</span><span class="token punctuation">:</span></span>
<span class="line">        proj_radians <span class="token operator">+=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'k'</span><span class="token punctuation">:</span></span>
<span class="line">        proj_radians <span class="token operator">-=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'o'</span><span class="token punctuation">:</span></span>
<span class="line">        proj_1 <span class="token operator">+=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'l'</span><span class="token punctuation">:</span></span>
<span class="line">        proj_1 <span class="token operator">-=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'p'</span><span class="token punctuation">:</span></span>
<span class="line">        proj_2 <span class="token operator">+=</span> amount</span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b';'</span><span class="token punctuation">:</span></span>
<span class="line">        proj_2 <span class="token operator">-=</span> amount</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># define callbacks</span></span>
<span class="line">glutDisplayFunc<span class="token punctuation">(</span>render<span class="token punctuation">)</span></span>
<span class="line">glutKeyboardFunc<span class="token punctuation">(</span>key_pressed<span class="token punctuation">)</span></span>
<span class="line">glutMainLoop<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># cleanup</span></span>
<span class="line">glDisableVertexAttribArray<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">fox_news_texture<span class="token punctuation">.</span>cleanup<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">glBindBuffer<span class="token punctuation">(</span>GL_ARRAY_BUFFER<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">glBindVertexArray<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">glUseProgram<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">glDeleteProgram<span class="token punctuation">(</span>program<span class="token punctuation">)</span></span>
<span class="line">glDeleteBuffers<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> vbo<span class="token punctuation">)</span></span>
<span class="line">glDeleteVertexArrays<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> vao<span class="token punctuation">)</span></span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">AWS Transit Gateway</div>
                <div class="description">Terraform configuration for AWS Transit Gateway.</div>
                <div class="languages">Terraform</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-hcl" tabindex="0">                <code class="language-hcl"><span class="line"># VPCS</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_vpc" "vpc_1" {</span>
<span class="line">  cidr_block = "10.1.0.0/16"</span>
<span class="line">  tags = {</span>
<span class="line">    name = "VPC 1"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_vpc" "vpc_2" {</span>
<span class="line">  cidr_block = "10.2.0.0/16"</span>
<span class="line">  tags = {</span>
<span class="line">    name = "VPC 2"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line"># SUBNETS</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_subnet" "subnet_1" {</span>
<span class="line">  cidr_block = "10.1.0.0/24"</span>
<span class="line">  vpc_id     = aws_vpc.vpc_1.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_subnet" "subnet_2" {</span>
<span class="line">  cidr_block = "10.2.0.0/24"</span>
<span class="line">  vpc_id     = aws_vpc.vpc_2.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line"># INTERNET GATEWAYS</span>
<span class="line">#</span>
<span class="line"># You must have an internet gateway inside of a VPC if you want to SSH into it's instance. Also make sure a network security group is in both the subnet &amp; instance in AWS.</span>
<span class="line">#</span>
<span class="line">resource "aws_internet_gateway" "igw_1" {</span>
<span class="line">  vpc_id = aws_vpc.vpc_1.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_internet_gateway" "igw_2" {</span>
<span class="line">  vpc_id = aws_vpc.vpc_2.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line"># ROUTE TABLES</span>
<span class="line">#</span>
<span class="line"># Appears that a Route Table in AWS goes into a VPC. Inside of it, it can be sent to certain subnets</span>
<span class="line"># in it's VPC via the aws route_table_association resource</span>
<span class="line">#</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_route_table" "route_table_1" {</span>
<span class="line">  vpc_id = aws_vpc.vpc_1.id</span>
<span class="line">  tags = {</span>
<span class="line">    name = "route_table_1"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_route" "route_to_igw_1" {</span>
<span class="line">  route_table_id         = aws_route_table.route_table_1.id</span>
<span class="line">  destination_cidr_block = "0.0.0.0/0"</span>
<span class="line">  gateway_id             = aws_internet_gateway.igw_1.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_route" "route_to_tgw_in_vpc_1" {</span>
<span class="line">  route_table_id         = aws_route_table.route_table_1.id</span>
<span class="line">  destination_cidr_block = "10.0.0.0/8"</span>
<span class="line">  gateway_id             = aws_ec2_transit_gateway.tgw_mark.id</span>
<span class="line">  depends_on             = [aws_ec2_transit_gateway.tgw_mark]</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_route_table_association" "subnet_association_1" {</span>
<span class="line">  subnet_id      = aws_subnet.subnet_1.id</span>
<span class="line">  route_table_id = aws_route_table.route_table_1.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_route_table" "route_table_2" {</span>
<span class="line">  vpc_id = aws_vpc.vpc_2.id</span>
<span class="line">  tags = {</span>
<span class="line">    name = "route_table_2"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_route" "route_to_igw_2" {</span>
<span class="line">  route_table_id         = aws_route_table.route_table_2.id</span>
<span class="line">  destination_cidr_block = "0.0.0.0/0"</span>
<span class="line">  gateway_id             = aws_internet_gateway.igw_2.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_route" "route_to_tgw_in_vpc_2" {</span>
<span class="line">  route_table_id         = aws_route_table.route_table_2.id</span>
<span class="line">  destination_cidr_block = "10.0.0.0/8"</span>
<span class="line">  gateway_id             = aws_ec2_transit_gateway.tgw_mark.id</span>
<span class="line">  depends_on             = [aws_ec2_transit_gateway.tgw_mark]</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_route_table_association" "subnet_association_2" {</span>
<span class="line">  subnet_id      = aws_subnet.subnet_2.id</span>
<span class="line">  route_table_id = aws_route_table.route_table_2.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"># NETWORK SECURITY GROUPS</span>
<span class="line"># </span>
<span class="line"># in AWS, a security group is connected to the VPC</span>
<span class="line"># </span>
<span class="line"># Define the first security group for VPC 1</span>
<span class="line">resource "aws_security_group" "allow_ssh_group_vpc_1" {</span>
<span class="line">  name        = "allow_ssh_group_vpc_1"</span>
<span class="line">  description = "Allow SSH Group VPC 1"</span>
<span class="line">  vpc_id      = aws_vpc.vpc_1.id</span>
<span class="line">&nbsp;</span>
<span class="line">  # Define ingress rules directly within the security group</span>
<span class="line">  ingress {</span>
<span class="line">    from_port   = 22</span>
<span class="line">    to_port     = 22</span>
<span class="line">    protocol    = "tcp"</span>
<span class="line">    cidr_blocks = ["0.0.0.0/0"]</span>
<span class="line">  }</span>
<span class="line">&nbsp;</span>
<span class="line">  ingress {</span>
<span class="line">    from_port   = 8</span>
<span class="line">    to_port     = 0</span>
<span class="line">    protocol    = "icmp"</span>
<span class="line">    cidr_blocks = ["0.0.0.0/0"]</span>
<span class="line">  }</span>
<span class="line">&nbsp;</span>
<span class="line">  egress {</span>
<span class="line">    from_port   = 0</span>
<span class="line">    to_port     = 0</span>
<span class="line">    protocol    = "-1"</span>
<span class="line">    cidr_blocks = ["0.0.0.0/0"]</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line"># Define the second security group for VPC 2</span>
<span class="line">resource "aws_security_group" "allow_ssh_group_vpc_2" {</span>
<span class="line">  name        = "allow_ssh_group_vpc_2"</span>
<span class="line">  description = "Allow SSH Group VPC 2"</span>
<span class="line">  vpc_id      = aws_vpc.vpc_2.id</span>
<span class="line">&nbsp;</span>
<span class="line">  # Define ingress rules directly within the security group</span>
<span class="line">  ingress {</span>
<span class="line">    from_port   = 22</span>
<span class="line">    to_port     = 22</span>
<span class="line">    protocol    = "tcp"</span>
<span class="line">    cidr_blocks = ["0.0.0.0/0"]</span>
<span class="line">  }</span>
<span class="line">&nbsp;</span>
<span class="line">  ingress {</span>
<span class="line">    from_port   = 8</span>
<span class="line">    to_port     = 0</span>
<span class="line">    protocol    = "icmp"</span>
<span class="line">    cidr_blocks = ["0.0.0.0/0"]</span>
<span class="line">  }</span>
<span class="line">&nbsp;</span>
<span class="line">  egress {</span>
<span class="line">    from_port   = 0</span>
<span class="line">    to_port     = 0</span>
<span class="line">    protocol    = "-1"</span>
<span class="line">    cidr_blocks = ["0.0.0.0/0"]</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">#########################</span>
<span class="line"># </span>
<span class="line">#    EC2 VIRTUAL MACHINES</span>
<span class="line">#</span>
<span class="line">#########################</span>
<span class="line">#</span>
<span class="line"># </span>
<span class="line"># ssh -i key_pair_2023.pem ec2-user@ec2-34-236-144-211.compute-1.amazonaws.com</span>
<span class="line">#</span>
<span class="line"># 1) Make sure there's internet gateway</span>
<span class="line"># 2) Make sure there's security groups in VPC &amp; EC2</span>
<span class="line"># 3) Make sure there's a default route to the internet gateway</span>
<span class="line">#</span>
<span class="line">#</span>
<span class="line">resource "aws_instance" "ec2_vpc_1_subnet_1" {</span>
<span class="line">  ami                         = "ami-051f7e7f6c2f40dc1"</span>
<span class="line">  subnet_id                   = aws_subnet.subnet_1.id</span>
<span class="line">  instance_type               = "t2.micro"</span>
<span class="line">  key_name                    = "key_pair_2023" </span>
<span class="line">  vpc_security_group_ids      = [aws_security_group.allow_ssh_group_vpc_1.id]</span>
<span class="line">  associate_public_ip_address = true</span>
<span class="line">}</span>
<span class="line">resource "aws_instance" "ec2_vpc_2_subnet_2" {</span>
<span class="line">  ami                         = "ami-051f7e7f6c2f40dc1"</span>
<span class="line">  subnet_id                   = aws_subnet.subnet_2.id</span>
<span class="line">  instance_type               = "t2.micro"</span>
<span class="line">  key_name                    = "key_pair_2023" </span>
<span class="line">  vpc_security_group_ids      = [aws_security_group.allow_ssh_group_vpc_2.id]</span>
<span class="line">  associate_public_ip_address = true</span>
<span class="line">}</span>
<span class="line">output "instance_public_ip" {</span>
<span class="line">  value = aws_instance.ec2_vpc_1_subnet_1.public_ip</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">output "instance_public_dns" {</span>
<span class="line">  value = aws_instance.ec2_vpc_1_subnet_1.public_dns</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">#</span>
<span class="line"># TRANSIT GATEWAY</span>
<span class="line">#</span>
<span class="line">#</span>
<span class="line">#</span>
<span class="line">resource "aws_ec2_transit_gateway" "tgw_mark" {</span>
<span class="line">  description = "Mark's Transit Gateway"</span>
<span class="line">  default_route_table_association = "enable"</span>
<span class="line">  default_route_table_propagation = "enable"</span>
<span class="line">  amazon_side_asn = 64512</span>
<span class="line">  tags = {</span>
<span class="line">    name = "tgw_mark"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">#</span>
<span class="line"># TRANSIT GATEWAY ATTACHMENTS</span>
<span class="line">#</span>
<span class="line"># Attachments to other VPCs</span>
<span class="line">#</span>
<span class="line">#</span>
<span class="line">resource "aws_ec2_transit_gateway_vpc_attachment" "vpc_1_attachment" {</span>
<span class="line">  transit_gateway_id = aws_ec2_transit_gateway.tgw_mark.id</span>
<span class="line">  vpc_id             = aws_vpc.vpc_1.id</span>
<span class="line">  subnet_ids         = [aws_subnet.subnet_1.id]</span>
<span class="line">  tags = {</span>
<span class="line">    name = "vpc_1_attachment"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_ec2_transit_gateway_vpc_attachment" "vpc_2_attachment" {</span>
<span class="line">  transit_gateway_id = aws_ec2_transit_gateway.tgw_mark.id</span>
<span class="line">  vpc_id             = aws_vpc.vpc_2.id</span>
<span class="line">  subnet_ids         = [aws_subnet.subnet_2.id]</span>
<span class="line">  tags = {</span>
<span class="line">    name = "vpc_2_attachment"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Azure Transit Gateway</div>
                <div class="description">Terraform configuration for Azure's version of Transit Gateway.</div>
                <div class="languages">Terraform</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-hcl" tabindex="0">                <code class="language-hcl"><span class="line">&nbsp;</span>
<span class="line"># RESOURCE GROUP</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_resource_group" "resource_group_mark_mulcahy" {</span>
<span class="line">  name     = var.resource_group_name</span>
<span class="line">  location = var.location</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"># NETWORK SECURITY GROUPS</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_network_security_group" "security_group_mark" {</span>
<span class="line">  name                = "security_group_mark"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_network_security_rule" "allow_ssh_rule" {</span>
<span class="line">  name                        = "allow_ssh_rule"</span>
<span class="line">  priority                    = 100</span>
<span class="line">  direction                   = "Inbound"</span>
<span class="line">  access                      = "Allow"</span>
<span class="line">  protocol                    = "Tcp"</span>
<span class="line">  source_port_range           = "*"</span>
<span class="line">  destination_port_range      = "22"</span>
<span class="line">  source_address_prefix       = "0.0.0.0/0" # You can change this to a more specific address or range</span>
<span class="line">  destination_address_prefix  = "*"</span>
<span class="line">  resource_group_name         = var.resource_group_name</span>
<span class="line">  network_security_group_name = azurerm_network_security_group.security_group_mark.name</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_network_security_rule" "allow_ping_rule" {</span>
<span class="line">  name                        = "allow_ping_rule"</span>
<span class="line">  priority                    = 101</span>
<span class="line">  direction                   = "Inbound"</span>
<span class="line">  access                      = "Allow"</span>
<span class="line">  protocol                    = "Icmp"</span>
<span class="line">  source_port_range           = "*"</span>
<span class="line">  destination_port_range      = "*"</span>
<span class="line">  source_address_prefix       = "0.0.0.0/0" # You can change this to a more specific address or range</span>
<span class="line">  destination_address_prefix  = "*"</span>
<span class="line">  resource_group_name         = var.resource_group_name</span>
<span class="line">  network_security_group_name = azurerm_network_security_group.security_group_mark.name</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"># VIRTUAL NETWORKS</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_virtual_network" "gateway_hub" {</span>
<span class="line">  name                = "gateway_hub"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  address_space       = ["10.0.0.0/16"]</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_virtual_network" "vpc_1" {</span>
<span class="line">  name                = "vpc_1"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  address_space       = ["10.1.0.0/16"]</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_virtual_network" "vpc_2" {</span>
<span class="line">  name                = "vpc_2"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  address_space       = ["10.2.0.0/16"]</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"># SUBNETS</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_subnet" "subnet_hub" {</span>
<span class="line">  name                 = "subnet_hub"</span>
<span class="line">  resource_group_name  = var.resource_group_name</span>
<span class="line">  virtual_network_name = azurerm_virtual_network.gateway_hub.name</span>
<span class="line">  address_prefixes     = ["10.0.0.0/24"]</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_subnet" "subnet_1" {</span>
<span class="line">  name                 = "subnet_1"</span>
<span class="line">  resource_group_name  = var.resource_group_name</span>
<span class="line">  virtual_network_name = azurerm_virtual_network.vpc_1.name</span>
<span class="line">  address_prefixes     = ["10.1.0.0/24"]</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_subnet" "subnet_2" {</span>
<span class="line">  name                 = "subnet_2"</span>
<span class="line">  resource_group_name  = var.resource_group_name</span>
<span class="line">  virtual_network_name = azurerm_virtual_network.vpc_2.name</span>
<span class="line">  address_prefixes     = ["10.2.0.0/24"]</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_subnet" "subnet_hub_virtual_gateway" {</span>
<span class="line">  name                 = "GatewaySubnet"</span>
<span class="line">  resource_group_name  = var.resource_group_name</span>
<span class="line">  virtual_network_name = azurerm_virtual_network.gateway_hub.name</span>
<span class="line">  address_prefixes     = ["10.0.1.0/24"]</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"># ROUTE TABLES</span>
<span class="line">&nbsp;</span>
<span class="line"># VPC 1 / SUBNET 1 Route Table</span>
<span class="line">resource "azurerm_route_table" "route_table_1" {</span>
<span class="line">  name                = "route_table_1"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_route" "route_1" {</span>
<span class="line">  name                = "route_1"</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  route_table_name    = azurerm_route_table.route_table_1.name</span>
<span class="line">  address_prefix      = "10.2.0.0/16"</span>
<span class="line">  next_hop_type       = "VirtualNetworkGateway"</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_subnet_route_table_association" "route_subnet_association_1" {</span>
<span class="line">  subnet_id      = azurerm_subnet.subnet_1.id</span>
<span class="line">  route_table_id = azurerm_route_table.route_table_1.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line"># VPC 2 / SUBNET 2 Route Table</span>
<span class="line">resource "azurerm_route_table" "route_table_2" {</span>
<span class="line">  name                = "route_table_2"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_route" "route_2" {</span>
<span class="line">  name                = "route_2"</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  route_table_name    = azurerm_route_table.route_table_2.name</span>
<span class="line">  address_prefix      = "10.1.0.0/16"</span>
<span class="line">  next_hop_type       = "VirtualNetworkGateway"</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_subnet_route_table_association" "route_subnet_association_2" {</span>
<span class="line">  subnet_id      = azurerm_subnet.subnet_2.id</span>
<span class="line">  route_table_id = azurerm_route_table.route_table_2.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">#########################</span>
<span class="line"># </span>
<span class="line">#    VIRTUAL MACHINES</span>
<span class="line">#</span>
<span class="line">#</span>
<span class="line">#</span>
<span class="line"># Virtual Machine has a Network Interface</span>
<span class="line"># Network Interface ID has a Public IP</span>
<span class="line"># Public IP chooses location of this virtual machine</span>
<span class="line">#</span>
<span class="line">#</span>
<span class="line">&nbsp;</span>
<span class="line">#########################</span>
<span class="line"># </span>
<span class="line">#    VIRTUAL MACHINE IN HUB</span>
<span class="line">#</span>
<span class="line">#########################</span>
<span class="line">&nbsp;</span>
<span class="line">##### PUBLIC IP #####</span>
<span class="line">resource "azurerm_public_ip" "public_ip_hub" {</span>
<span class="line">  name                = "public_ip_hub"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  allocation_method   = "Dynamic"</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">##### NETWORK INTERFACE #####</span>
<span class="line">resource "azurerm_network_interface" "network_interface_hub" {</span>
<span class="line">  name                = "network_interface_hub"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  ip_configuration {</span>
<span class="line">    name                          = "ip_configuration"</span>
<span class="line">    subnet_id                     = azurerm_subnet.subnet_hub.id</span>
<span class="line">    private_ip_address_allocation = "Dynamic"</span>
<span class="line">    public_ip_address_id          = azurerm_public_ip.public_ip_hub.id</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">##### NETWORK INTERFACE TO SECURITY GROUP ASSOCIATION #####</span>
<span class="line">resource "azurerm_network_interface_security_group_association" "nsg_association_hub" {</span>
<span class="line">  network_interface_id      = azurerm_network_interface.network_interface_hub.id</span>
<span class="line">  network_security_group_id = azurerm_network_security_group.security_group_mark.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">##### SUBNET INTERFACE TO SECURITY GROUP ASSOCIATION ##### </span>
<span class="line">resource "azurerm_subnet_network_security_group_association" "ssh_nsg_to_vpc_hub" {</span>
<span class="line">  subnet_id                 = azurerm_subnet.subnet_hub.id</span>
<span class="line">  network_security_group_id = azurerm_network_security_group.security_group_mark.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">##### VIRTUAL MACHINE #####</span>
<span class="line">#</span>
<span class="line"># Virtual Machine has a Network Interface</span>
<span class="line"># Network Interface ID has a Public IP</span>
<span class="line">#</span>
<span class="line">resource "azurerm_linux_virtual_machine" "virtual_machine_hub" {</span>
<span class="line">  name                = "VMHub"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  network_interface_ids = [</span>
<span class="line">    azurerm_network_interface.network_interface_hub.id,</span>
<span class="line">  ]</span>
<span class="line">  size                            = "Standard_B1ls"</span>
<span class="line">  admin_username                  = var.vm_username</span>
<span class="line">  admin_password                  = var.vm_password # Password</span>
<span class="line">  disable_password_authentication = false           # Disable SSH so Text Password can be used</span>
<span class="line">  source_image_reference {</span>
<span class="line">    publisher = "Canonical"</span>
<span class="line">    offer     = "UbuntuServer"</span>
<span class="line">    sku       = "18.04-LTS"</span>
<span class="line">    version   = "latest"</span>
<span class="line">  }</span>
<span class="line">  os_disk {</span>
<span class="line">    caching              = "ReadWrite"</span>
<span class="line">    storage_account_type = "Standard_LRS"</span>
<span class="line">    name                 = "myosdisk"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">#########################</span>
<span class="line"># </span>
<span class="line">#    VIRTUAL MACHINE IN SUBNET 1</span>
<span class="line">#</span>
<span class="line">#    </span>
<span class="line">#</span>
<span class="line">#########################</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">##### PUBLIC IP #####</span>
<span class="line">resource "azurerm_public_ip" "public_ip_1" {</span>
<span class="line">  name                = "public_ip_1"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  allocation_method   = "Dynamic"</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">##### NETWORK INTERFACE #####</span>
<span class="line">resource "azurerm_network_interface" "network_interface_1" {</span>
<span class="line">  name                = "network_interface_1"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  ip_configuration {</span>
<span class="line">    name                          = "ip_configuration"</span>
<span class="line">    subnet_id                     = azurerm_subnet.subnet_1.id</span>
<span class="line">    private_ip_address_allocation = "Dynamic"</span>
<span class="line">    public_ip_address_id          = azurerm_public_ip.public_ip_1.id</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">##### NETWORK INTERFACE TO SECURITY GROUP ASSOCIATION #####</span>
<span class="line">resource "azurerm_network_interface_security_group_association" "nsg_association_1" {</span>
<span class="line">  network_interface_id      = azurerm_network_interface.network_interface_1.id</span>
<span class="line">  network_security_group_id = azurerm_network_security_group.security_group_mark.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">##### SUBNET INTERFACE TO SECURITY GROUP ASSOCIATION ##### </span>
<span class="line">resource "azurerm_subnet_network_security_group_association" "ssh_nsg_to_vpc_1" {</span>
<span class="line">  subnet_id                 = azurerm_subnet.subnet_1.id</span>
<span class="line">  network_security_group_id = azurerm_network_security_group.security_group_mark.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">##### VIRTUAL MACHINE #####</span>
<span class="line">#</span>
<span class="line"># Virtual Machine has a Network Interface</span>
<span class="line"># Network Interface ID has a Public IP</span>
<span class="line">#</span>
<span class="line">resource "azurerm_linux_virtual_machine" "virtual_machine_1" {</span>
<span class="line">  name                = "VMSubnet1"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  network_interface_ids = [</span>
<span class="line">    azurerm_network_interface.network_interface_1.id,</span>
<span class="line">  ]</span>
<span class="line">  size                            = "Standard_B1ls"</span>
<span class="line">  admin_username                  = var.vm_username</span>
<span class="line">  admin_password                  = var.vm_password # Password</span>
<span class="line">  disable_password_authentication = false           # Disable SSH so Text Password can be used</span>
<span class="line">  source_image_reference {</span>
<span class="line">    publisher = "Canonical"</span>
<span class="line">    offer     = "UbuntuServer"</span>
<span class="line">    sku       = "18.04-LTS"</span>
<span class="line">    version   = "latest"</span>
<span class="line">  }</span>
<span class="line">  os_disk {</span>
<span class="line">    caching              = "ReadWrite"</span>
<span class="line">    storage_account_type = "Standard_LRS"</span>
<span class="line">    name                 = "myosdisk_subnet_1"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">#########################</span>
<span class="line"># </span>
<span class="line">#    VIRTUAL MACHINE IN SUBNET 2</span>
<span class="line">#</span>
<span class="line">#    </span>
<span class="line">#</span>
<span class="line">#########################</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">##### PUBLIC IP #####</span>
<span class="line">resource "azurerm_public_ip" "public_ip_2" {</span>
<span class="line">  name                = "public_ip_2"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  allocation_method   = "Dynamic"</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">##### NETWORK INTERFACE #####</span>
<span class="line">resource "azurerm_network_interface" "network_interface_2" {</span>
<span class="line">  name                = "network_interface_2"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  ip_configuration {</span>
<span class="line">    name                          = "ip_configuration"</span>
<span class="line">    subnet_id                     = azurerm_subnet.subnet_2.id</span>
<span class="line">    private_ip_address_allocation = "Dynamic"</span>
<span class="line">    public_ip_address_id          = azurerm_public_ip.public_ip_2.id</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">#</span>
<span class="line">#    Security group assignment to network Interface </span>
<span class="line">#</span>
<span class="line">resource "azurerm_network_interface_security_group_association" "nsg_association_2" {</span>
<span class="line">  network_interface_id      = azurerm_network_interface.network_interface_2.id</span>
<span class="line">  network_security_group_id = azurerm_network_security_group.security_group_mark.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">#</span>
<span class="line">#    Security group assignment to subnet</span>
<span class="line">#</span>
<span class="line">resource "azurerm_subnet_network_security_group_association" "ssh_nsg_to_vpc_2" {</span>
<span class="line">  subnet_id                 = azurerm_subnet.subnet_2.id</span>
<span class="line">  network_security_group_id = azurerm_network_security_group.security_group_mark.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">##### VIRTUAL MACHINE #####</span>
<span class="line">#</span>
<span class="line"># Virtual Machine has a Network Interface</span>
<span class="line"># Network Interface ID has a Public IP</span>
<span class="line">#</span>
<span class="line">resource "azurerm_linux_virtual_machine" "virtual_machine_2" {</span>
<span class="line">  name                = "VMSubnet2"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  network_interface_ids = [</span>
<span class="line">    azurerm_network_interface.network_interface_2.id,</span>
<span class="line">  ]</span>
<span class="line">  size                            = "Standard_B1ls"</span>
<span class="line">  admin_username                  = var.vm_username</span>
<span class="line">  admin_password                  = var.vm_password # Password</span>
<span class="line">  disable_password_authentication = false           # Disable SSH so Text Password can be used</span>
<span class="line">  source_image_reference {</span>
<span class="line">    publisher = "Canonical"</span>
<span class="line">    offer     = "UbuntuServer"</span>
<span class="line">    sku       = "18.04-LTS"</span>
<span class="line">    version   = "latest"</span>
<span class="line">  }</span>
<span class="line">  os_disk {</span>
<span class="line">    caching              = "ReadWrite"</span>
<span class="line">    storage_account_type = "Standard_LRS"</span>
<span class="line">    name                 = "myosdisk_subnet_2"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">#########################</span>
<span class="line"># </span>
<span class="line">#    VIRTUAL NETWORK GATEWAY</span>
<span class="line">#</span>
<span class="line">#########################</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_public_ip" "public_ip_hub_vnet_gateway" {</span>
<span class="line">  name                = "public_ip_hub_vnet_gateway"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  allocation_method   = "Dynamic"</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_virtual_network_gateway" "virtual_network_gateway" {</span>
<span class="line">  name                = "virtual_network_gateway"</span>
<span class="line">  location            = var.location</span>
<span class="line">  resource_group_name = var.resource_group_name</span>
<span class="line">  type     = "Vpn"</span>
<span class="line">  vpn_type = "RouteBased"</span>
<span class="line">  active_active = false</span>
<span class="line">  enable_bgp    = false</span>
<span class="line">  sku           = "VpnGw1"</span>
<span class="line">  generation    = "Generation1"</span>
<span class="line">  ip_configuration {</span>
<span class="line">    name                          = "vnetGatewayConfig"</span>
<span class="line">    public_ip_address_id          = azurerm_public_ip.public_ip_hub_vnet_gateway.id</span>
<span class="line">    private_ip_address_allocation = "Dynamic"</span>
<span class="line">    subnet_id                     = azurerm_subnet.subnet_hub_virtual_gateway.id</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">#########################</span>
<span class="line"># </span>
<span class="line">#    VIRTUAL NETWORK PEERINGS</span>
<span class="line">#</span>
<span class="line">#    Requires two way peering, and two way peering is a requirement for the Virtual Network Gateway to work</span>
<span class="line">#</span>
<span class="line">#########################</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_virtual_network_peering" "vpc_1_to_hub" {</span>
<span class="line">  name                      = "vpc1_to_hub"</span>
<span class="line">  resource_group_name       = var.resource_group_name</span>
<span class="line">  virtual_network_name      = azurerm_virtual_network.vpc_1.name</span>
<span class="line">  remote_virtual_network_id = azurerm_virtual_network.gateway_hub.id</span>
<span class="line">  allow_virtual_network_access = true</span>
<span class="line">  allow_forwarded_traffic = true</span>
<span class="line">  allow_gateway_transit   = true</span>
<span class="line">  use_remote_gateways     = true</span>
<span class="line">  depends_on = [azurerm_virtual_network.gateway_hub, azurerm_virtual_network.vpc_1, azurerm_virtual_network.vpc_2, azurerm_virtual_network_gateway.virtual_network_gateway]</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_virtual_network_peering" "vpc_2_to_hub" {</span>
<span class="line">  name                      = "vpc2_to_hub"</span>
<span class="line">  resource_group_name       = var.resource_group_name</span>
<span class="line">  virtual_network_name      = azurerm_virtual_network.vpc_2.name</span>
<span class="line">  remote_virtual_network_id = azurerm_virtual_network.gateway_hub.id</span>
<span class="line">  allow_virtual_network_access = true</span>
<span class="line">  allow_forwarded_traffic = true</span>
<span class="line">  allow_gateway_transit   = true</span>
<span class="line">  use_remote_gateways     = true</span>
<span class="line">  depends_on = [azurerm_virtual_network.gateway_hub, azurerm_virtual_network.vpc_1, azurerm_virtual_network.vpc_2, azurerm_virtual_network_gateway.virtual_network_gateway]</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_virtual_network_peering" "hub_to_vpc_1" {</span>
<span class="line">  name                      = "hub_to_vpc_1"</span>
<span class="line">  resource_group_name       = var.resource_group_name</span>
<span class="line">  virtual_network_name      = azurerm_virtual_network.gateway_hub.name</span>
<span class="line">  remote_virtual_network_id = azurerm_virtual_network.vpc_1.id</span>
<span class="line">  allow_virtual_network_access = true</span>
<span class="line">  allow_forwarded_traffic = true</span>
<span class="line">  allow_gateway_transit   = true</span>
<span class="line">  depends_on = [azurerm_virtual_network.gateway_hub, azurerm_virtual_network.vpc_1, azurerm_virtual_network.vpc_2,azurerm_virtual_network_gateway.virtual_network_gateway]</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "azurerm_virtual_network_peering" "hub_to_vpc_2" {</span>
<span class="line">  name                      = "hub_to_vpc_2"</span>
<span class="line">  resource_group_name       = var.resource_group_name</span>
<span class="line">  virtual_network_name      = azurerm_virtual_network.gateway_hub.name</span>
<span class="line">  remote_virtual_network_id = azurerm_virtual_network.vpc_2.id</span>
<span class="line">  allow_virtual_network_access = true</span>
<span class="line">  allow_forwarded_traffic = true</span>
<span class="line">  allow_gateway_transit   = true</span>
<span class="line">  depends_on = [azurerm_virtual_network.gateway_hub, azurerm_virtual_network.vpc_1, azurerm_virtual_network.vpc_2, azurerm_virtual_network_gateway.virtual_network_gateway]</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">AWS Lattice</div>
                <div class="description">Terraform configuration for AWS Lattice.</div>
                <div class="languages">Terraform</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-hcl" tabindex="0">                <code class="language-hcl"><span class="line">#######################</span>
<span class="line"># </span>
<span class="line">#       LAMBDA</span>
<span class="line">#</span>
<span class="line">#######################</span>
<span class="line">&nbsp;</span>
<span class="line"># Create an IAM role for Lambda</span>
<span class="line">resource "aws_iam_role" "lambda_role" {</span>
<span class="line">  name               = "lambda_role"</span>
<span class="line">  assume_role_policy = data.aws_iam_policy_document.lambda.json </span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line"># Create a data source for the IAM policy document for Lambda</span>
<span class="line">data "aws_iam_policy_document" "lambda" {</span>
<span class="line">  statement {</span>
<span class="line">    actions = ["sts:AssumeRole"]</span>
<span class="line">    principals {</span>
<span class="line">      type        = "Service"</span>
<span class="line">      identifiers = ["lambda.amazonaws.com"]</span>
<span class="line">    }</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">data "archive_file" "lambda_hello_world_file" {</span>
<span class="line">  type        = "zip"</span>
<span class="line">  output_path = "/tmp/lambda_hello_world.zip"</span>
<span class="line">  source {</span>
<span class="line">    content  = &lt;&lt;EOF</span>
<span class="line">def lambda_handler(event, context):</span>
<span class="line">    return {</span>
<span class="line">        'statusCode': 200,</span>
<span class="line">        'body': 'Hello, I\'m Lambda!!!'</span>
<span class="line">    }</span>
<span class="line">    EOF</span>
<span class="line">    filename = "main.py"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_lambda_function" "lambda_hello_world_function" {</span>
<span class="line">  function_name    = "lambda_hello_world_function"</span>
<span class="line">  handler          = "main.lambda_handler"</span>
<span class="line">  runtime          = "python3.8"</span>
<span class="line">  role             = aws_iam_role.lambda_role.arn</span>
<span class="line">  filename         = data.archive_file.lambda_hello_world_file.output_path</span>
<span class="line">  source_code_hash = data.archive_file.lambda_hello_world_file.output_base64sha256</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">#######################</span>
<span class="line"># </span>
<span class="line">#       EC2</span>
<span class="line">#</span>
<span class="line">#######################</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"># Create an EC2 instance with a user script that returns HTML using Alpine</span>
<span class="line">resource "aws_instance" "ec2_hello_world" {</span>
<span class="line">  ami           = "ami-051f7e7f6c2f40dc1" </span>
<span class="line">  instance_type = "t2.micro"</span>
<span class="line">  subnet_id     = aws_subnet.subnet_ec2.id</span>
<span class="line">  associate_public_ip_address = true</span>
<span class="line">  # Specify the user script in heredoc format</span>
<span class="line">  user_data = &lt;&lt;EOF</span>
<span class="line">#!/bin/bash</span>
<span class="line">sudo dnf update -y</span>
<span class="line">sudo dnf list | grep httpd</span>
<span class="line">sudo dnf install -y httpd.x86_64</span>
<span class="line">sudo systemctl start httpd.service</span>
<span class="line">sudo systemctl status httpd.service</span>
<span class="line">sudo systemctl enable httpd.service</span>
<span class="line">echo Hello World from $(hostname -f) &gt; /var/www/html/index.html</span>
<span class="line">EOF</span>
<span class="line">  # Associate the security group with the instance</span>
<span class="line">  vpc_security_group_ids = [aws_security_group.security_group_ec2_lambda.id]</span>
<span class="line">  tags = {</span>
<span class="line">    name = "ec2_hello_world"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">######################</span>
<span class="line">#</span>
<span class="line">#  VPCs</span>
<span class="line">#</span>
<span class="line">#  </span>
<span class="line">#   Default VPC in AWS is the client VPC that will be associated with the service network, via vpc_lattice_service_vpc_association_ec2 resource. </span>
<span class="line">#   Two services of Lambda &amp; EC2 will be associated with the service network.</span>
<span class="line">#   The service network is not a VPC itself!</span>
<span class="line">&nbsp;</span>
<span class="line">#</span>
<span class="line">#</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_default_vpc" "default_vpc" {</span>
<span class="line">  tags = {</span>
<span class="line">    Name = "Default VPC"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_vpc" "vpc_ec2" {</span>
<span class="line">  cidr_block = "10.2.0.0/16"</span>
<span class="line">  tags = {</span>
<span class="line">    name = "VPC EC2"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">######################</span>
<span class="line">#</span>
<span class="line">#  SUBNETS</span>
<span class="line">#</span>
<span class="line">#</span>
<span class="line">#   The Lambda Service does not require it's own subnet like EC2 and Load Balancers for the target gruops</span>
<span class="line">#</span>
<span class="line">#</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_subnet" "subnet_ec2" {</span>
<span class="line">  cidr_block = "10.2.0.0/24"</span>
<span class="line">  vpc_id     = aws_vpc.vpc_ec2.id</span>
<span class="line">}</span>
<span class="line">#########################</span>
<span class="line"># </span>
<span class="line">#    SECURITY GROUPS</span>
<span class="line">#</span>
<span class="line">#########################</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"># Create a security group that allows HTTP and HTTPS traffic from anywhere</span>
<span class="line">resource "aws_security_group" "security_group_ec2_lambda" {</span>
<span class="line">  name = "security_group_ec2_lambda"</span>
<span class="line">&nbsp;</span>
<span class="line">  ingress {</span>
<span class="line">    from_port   = 0</span>
<span class="line">    to_port     = 0</span>
<span class="line">    protocol    = "-1"</span>
<span class="line">    cidr_blocks = ["0.0.0.0/0"]</span>
<span class="line">  }</span>
<span class="line">&nbsp;</span>
<span class="line">  egress {</span>
<span class="line">    from_port   = 0</span>
<span class="line">    to_port     = 0</span>
<span class="line">    protocol    = "-1"</span>
<span class="line">    cidr_blocks = ["0.0.0.0/0"]</span>
<span class="line">  }</span>
<span class="line">&nbsp;</span>
<span class="line">  vpc_id = aws_vpc.vpc_ec2.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_security_group" "security_group_default_vpc" {</span>
<span class="line">  name = "security_group_service_network"</span>
<span class="line">&nbsp;</span>
<span class="line">  ingress {</span>
<span class="line">    from_port   = 0</span>
<span class="line">    to_port     = 0</span>
<span class="line">    protocol    = "-1"</span>
<span class="line">    cidr_blocks = ["0.0.0.0/0"]</span>
<span class="line">  }</span>
<span class="line">&nbsp;</span>
<span class="line">  egress {</span>
<span class="line">    from_port   = 0</span>
<span class="line">    to_port     = 0</span>
<span class="line">    protocol    = "-1"</span>
<span class="line">    cidr_blocks = ["0.0.0.0/0"]</span>
<span class="line">  }</span>
<span class="line">&nbsp;</span>
<span class="line">  vpc_id = aws_default_vpc.default_vpc.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">#########################</span>
<span class="line"># </span>
<span class="line">#    VPC LATTICE</span>
<span class="line">#</span>
<span class="line">#    Service Network -&gt; Service -&gt; Listener -&gt; Target Group</span>
<span class="line">#</span>
<span class="line">#    Target Group is a VPC with Containers, EC2, Kubernetes, Load Balancers</span>
<span class="line">#    Target Group has no VPC with Lambda</span>
<span class="line">#</span>
<span class="line">#    A Key Purpose of AWS Lattice is to have a consistent DNS name for services of different computing styles</span>
<span class="line">#    And to have control security &amp; monitoring consistently</span>
<span class="line">#    Listeners &amp; Rules can have weighted bias among different rules &amp; paths </span>
<span class="line">#</span>
<span class="line">#    Problems I came across was Terraform not setting up the Lambda Function in the Lambda Target Group</span>
<span class="line">#    and the initialization script in the USER DATA not working as expected, resulting in endless troubleshooting</span>
<span class="line">#    with the Health Check in the EC2 Target Group, until I directly accessed the instance in the private subnet</span>
<span class="line">#    with a temporary internet gateway/route table entry.</span>
<span class="line">#</span>
<span class="line">#    VPC Lattice adds in the route tables in a route table like 167.*.*.*</span>
<span class="line">#</span>
<span class="line">#########################</span>
<span class="line">&nbsp;</span>
<span class="line">##### VPC SERVICE NETWORK ##### </span>
<span class="line">#</span>
<span class="line">#</span>
<span class="line">resource "aws_vpclattice_service_network" "vpc_lattice_service_network_mark" {</span>
<span class="line">  name      = "vpc-lattice-service-network-mark"</span>
<span class="line">  auth_type = "NONE"</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">##### VPC LATTICE SERVICES #####</span>
<span class="line">#</span>
<span class="line"># </span>
<span class="line">resource "aws_vpclattice_service" "vpc_lattice_service_lambda" {</span>
<span class="line">  name               = "vpc-lattice-service-lambda"</span>
<span class="line">  auth_type          = "NONE"</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_vpclattice_service" "vpc_lattice_service_ec2" {</span>
<span class="line">  name               = "vpc-lattice-service-ec2"</span>
<span class="line">  auth_type          = "NONE"</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">##### VPC LATTICE SERVICE TO SERVICE NETWORK ASSOCIATION #####</span>
<span class="line">#</span>
<span class="line">#   Back End</span>
<span class="line">#</span>
<span class="line">#   Connects services to service network</span>
<span class="line">#</span>
<span class="line">#</span>
<span class="line">resource "aws_vpclattice_service_network_service_association" "vpc_lattice_service_network_association_lambda" {</span>
<span class="line">  service_network_identifier = aws_vpclattice_service_network.vpc_lattice_service_network_mark.id</span>
<span class="line">  service_identifier = aws_vpclattice_service.vpc_lattice_service_lambda.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_vpclattice_service_network_service_association" "vpc_lattice_service_network_association_ec2" {</span>
<span class="line">  service_network_identifier = aws_vpclattice_service_network.vpc_lattice_service_network_mark.id</span>
<span class="line">  service_identifier = aws_vpclattice_service.vpc_lattice_service_ec2.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">##### VPC LATTICE VPC TO SERVICE NETWORK ASSOCIATION (DEFAULT VPC) #####</span>
<span class="line">#</span>
<span class="line">#   Client Side</span>
<span class="line">#</span>
<span class="line">#   Default VPC was used for my simplicity &amp; sanity</span>
<span class="line">#</span>
<span class="line">#   Connects Client VPC to Service Network</span>
<span class="line">#   Service Network is not a VPC itself, it's an abstraction</span>
<span class="line">#</span>
<span class="line">resource "aws_vpclattice_service_network_vpc_association" "vpc_lattice_service_vpc_association_ec2" {</span>
<span class="line">  vpc_identifier             = aws_default_vpc.default_vpc.id</span>
<span class="line">  service_network_identifier = aws_vpclattice_service_network.vpc_lattice_service_network_mark.id</span>
<span class="line">  security_group_ids         = [aws_default_vpc.default_vpc.default_security_group_id]</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">##### VPC LATTICE LISTENER ##### </span>
<span class="line">#</span>
<span class="line">#   Attaches Listener To Service</span>
<span class="line">#</span>
<span class="line">#</span>
<span class="line">resource "aws_vpclattice_listener" "vpc_lattice_listener_lambda" {</span>
<span class="line">  name               = "vpc-lattice-listener-lambda"</span>
<span class="line">  protocol           = "HTTP"</span>
<span class="line">  service_identifier = aws_vpclattice_service.vpc_lattice_service_lambda.id</span>
<span class="line">  default_action {</span>
<span class="line">		forward {</span>
<span class="line">		    target_groups {</span>
<span class="line">		        target_group_identifier = aws_vpclattice_target_group.vpc_lattice_target_group_lambda.id</span>
<span class="line">		        weight                  = 100</span>
<span class="line">		     }</span>
<span class="line">	    }</span>
<span class="line">    }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_vpclattice_listener" "vpc_lattice_listener_ec2" {</span>
<span class="line">  name               = "vpc-lattice-listener-ec2"</span>
<span class="line">  protocol           = "HTTP"</span>
<span class="line">  service_identifier = aws_vpclattice_service.vpc_lattice_service_ec2.id</span>
<span class="line">  default_action {</span>
<span class="line">	 forward {</span>
<span class="line">	    target_groups {</span>
<span class="line">	        target_group_identifier = aws_vpclattice_target_group.vpc_lattice_target_group_ec2.id</span>
<span class="line">	        weight                  = 100</span>
<span class="line">	     }</span>
<span class="line">    }</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">##### VPC LATTICE TARGET GROUP &amp; ATTACHMENT (LAMBDA) #####</span>
<span class="line">#</span>
<span class="line">#   The attachment links the Lambda/EC2/EKS to the target group</span>
<span class="line"># </span>
<span class="line">resource "aws_vpclattice_target_group" "vpc_lattice_target_group_lambda" {</span>
<span class="line">  name = "vpc-lattice-target-group-lambda"</span>
<span class="line">  type = "LAMBDA"</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_vpclattice_target_group" "vpc_lattice_target_group_ec2" {</span>
<span class="line">  name = "vpc-lattice-target-group-ec2"</span>
<span class="line">  type = "INSTANCE"</span>
<span class="line">  config {</span>
<span class="line">    port           = 80</span>
<span class="line">    protocol       = "HTTP"</span>
<span class="line">    vpc_identifier = aws_vpc.vpc_ec2.id</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">##### VPC TARGET GROUPS</span>
<span class="line">#</span>
<span class="line">#     VPC LATTICE TARGET GROUP ATTACHMENT (Lambda) ##### </span>
<span class="line">#</span>
<span class="line">#     The attachment links the Lambda/EC2/EKS to the target group  </span>
<span class="line">#</span>
<span class="line">resource "aws_vpclattice_target_group_attachment" "vpc_lattice_target_group_attachment_lambda" {</span>
<span class="line">  target_group_identifier = aws_vpclattice_target_group.vpc_lattice_target_group_lambda.id</span>
<span class="line">  target {</span>
<span class="line">    id   = aws_lambda_function.lambda_hello_world_function.arn</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">##### VPC LATTICE TARGET GROUP ATTACHMENT (EC2) #####</span>
<span class="line">#</span>
<span class="line">#   The attachment links the Lambda/EC2/EKS to the target group  </span>
<span class="line"># </span>
<span class="line">resource "aws_vpclattice_target_group_attachment" "vpc_lattice_target_group_attachment_ec2" {</span>
<span class="line">  target_group_identifier = aws_vpclattice_target_group.vpc_lattice_target_group_ec2.id</span>
<span class="line">  target {</span>
<span class="line">    id   = aws_instance.ec2_hello_world.id</span>
<span class="line">    port = 80</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Terraform AWS CI/CD for ECS/ECR containers</div>
                <div class="description">Modifying &amp; committing an HTML file in GitHub will spearhead a process with CodePipeline &amp; CodeBuild to update an ECR container/ECS task with the new HTML</div>
                <div class="languages">Terraform</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-hcl" tabindex="0">                <code class="language-hcl"><span class="line">&nbsp;</span>
<span class="line">resource "aws_default_vpc" "default_vpc" {</span>
<span class="line">  tags = {</span>
<span class="line">    Name = "Default VPC"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">variable "subnet_default_1" {</span>
<span class="line">  description = "Subnet 1 in the default VPC"</span>
<span class="line">  default     = "subnet-0d803ec41d0ce19a5" </span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">variable "default_security_group" {</span>
<span class="line">  description = "Security Group Open Default"</span>
<span class="line">  default     = "sg-06cb6cc7195fb5076"</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">////////////////////</span>
<span class="line">//</span>
<span class="line">//  S3</span>
<span class="line">//</span>
<span class="line">////////////////////</span>
<span class="line">&nbsp;</span>
<span class="line"># Create an S3 bucket for the website</span>
<span class="line">resource "aws_s3_bucket" "mark_bucket" {</span>
<span class="line">  bucket = "mmulcahy222-aws-website-cicd" </span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">////////////////////</span>
<span class="line">//</span>
<span class="line">//  IAM</span>
<span class="line">//</span>
<span class="line">////////////////////</span>
<span class="line">resource "aws_iam_role" "mark_cicd_role" {</span>
<span class="line">  name = "mark-cicd-role"</span>
<span class="line">  assume_role_policy = jsonencode({</span>
<span class="line">    Version = "2012-10-17",</span>
<span class="line">    Statement = [{</span>
<span class="line">      Action = "sts:AssumeRole",</span>
<span class="line">      Effect = "Allow",</span>
<span class="line">      Principal = {</span>
<span class="line">        Service = [</span>
<span class="line">           "codebuild.amazonaws.com",</span>
<span class="line">           "codecommit.amazonaws.com",</span>
<span class="line">           "codepipeline.amazonaws.com",</span>
<span class="line">           "codedeploy.amazonaws.com",</span>
<span class="line">           "ecs.amazonaws.com",</span>
<span class="line">           "ecs-tasks.amazonaws.com",</span>
<span class="line">           "ecr.amazonaws.com",</span>
<span class="line">        ]</span>
<span class="line">      }</span>
<span class="line">    }]</span>
<span class="line">  })</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_iam_policy" "mark_cicd_policy" {</span>
<span class="line">  name        = "mark-cicd-policy"</span>
<span class="line">  description = "Temporary policy for CI/CD services"</span>
<span class="line">&nbsp;</span>
<span class="line">  policy = jsonencode({</span>
<span class="line">    Version = "2012-10-17",</span>
<span class="line">    Statement = [</span>
<span class="line">      {</span>
<span class="line">        Action   = [</span>
<span class="line">          "codebuild:*",</span>
<span class="line">          "codedeploy:*",</span>
<span class="line">          "codepipeline:*",</span>
<span class="line">          "codestar-connections:*",</span>
<span class="line">          "codecommit:*",</span>
<span class="line">          "ecs:*",</span>
<span class="line">          "ecr:*",</span>
<span class="line">          //EC2 permissions are needed so CodeBuild can work with EC2</span>
<span class="line">          "ec2:*",</span>
<span class="line">          "s3:*",</span>
<span class="line">          "iam:PassRole",</span>
<span class="line">          "cloudwatch:*",</span>
<span class="line">          "logs:*"</span>
<span class="line">        ],</span>
<span class="line">        Effect   = "Allow",</span>
<span class="line">        Resource = "*",</span>
<span class="line">      },</span>
<span class="line">    ],</span>
<span class="line">  })</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_iam_role_policy_attachment" "attach_cicd_policy" {</span>
<span class="line">  policy_arn = aws_iam_policy.mark_cicd_policy.id</span>
<span class="line">  role       = aws_iam_role.mark_cicd_role.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">////////////////////</span>
<span class="line">//</span>
<span class="line">//  ECS</span>
<span class="line">//</span>
<span class="line">////////////////////</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_ecs_cluster" "mark_ecs_cluster" {</span>
<span class="line">  name = "mark-ecs-cluster"</span>
<span class="line">  tags = {</span>
<span class="line">    Name = "mark-ecs-cluster"</span>
<span class="line">    Terraform = "true"</span>
<span class="line">    Environment = "dev"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_ecs_cluster_capacity_providers" "mark_ecs_cluster_capacity_providers" {</span>
<span class="line">  cluster_name = aws_ecs_cluster.mark_ecs_cluster.name</span>
<span class="line">  capacity_providers = ["FARGATE"]</span>
<span class="line">  default_capacity_provider_strategy {</span>
<span class="line">    capacity_provider = "FARGATE"</span>
<span class="line">    weight = 100</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_ecs_service" "mark_ecs_service" {</span>
<span class="line">  name            = "mark_ecs_service"</span>
<span class="line">  cluster         = aws_ecs_cluster.mark_ecs_cluster.name</span>
<span class="line">  task_definition = aws_ecs_task_definition.mark_ecs_task_definition.arn</span>
<span class="line">  launch_type     = "FARGATE"</span>
<span class="line">  desired_count   = 1</span>
<span class="line">&nbsp;</span>
<span class="line">  network_configuration {</span>
<span class="line">    subnets = [var.subnet_default_1]</span>
<span class="line">    security_groups = [var.default_security_group]</span>
<span class="line">    assign_public_ip = true</span>
<span class="line">  }</span>
<span class="line">&nbsp;</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_ecs_task_definition" "mark_ecs_task_definition" {</span>
<span class="line">  family                   = "mark_ecs_task_definition"</span>
<span class="line">  network_mode             = "awsvpc"</span>
<span class="line">  requires_compatibilities = ["FARGATE"]</span>
<span class="line">  execution_role_arn       = aws_iam_role.mark_cicd_role.arn</span>
<span class="line">  cpu                      = "256"</span>
<span class="line">  memory                   = "512"</span>
<span class="line">  container_definitions = jsonencode([</span>
<span class="line">    {</span>
<span class="line">      //</span>
<span class="line">      //</span>
<span class="line">      //   NOTE: The container name here must match what's inside of buildspec.yml in the image definition</span>
<span class="line">      //</span>
<span class="line">      //</span>
<span class="line">      name  = "mark_container_nginx"</span>
<span class="line">      image = "${aws_ecr_repository.mark_ecr.repository_url}:mark_nginx"</span>
<span class="line">      portMappings = [</span>
<span class="line">        {</span>
<span class="line">          containerPort = 80</span>
<span class="line">          hostPort      = 80</span>
<span class="line">        }</span>
<span class="line">      ]</span>
<span class="line">    }</span>
<span class="line">  ])</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">////////////////////</span>
<span class="line">//</span>
<span class="line">//  CODE BUILD (CODEBUILD -&gt; ECR -&gt; CODEDEPLOY -&gt; ECS)</span>
<span class="line">//</span>
<span class="line">//  You will need to put DOCKERFILE &amp; BUILDSPEC.YML in the github repository</span>
<span class="line">//</span>
<span class="line">//  Build has phrases, and build itself is a part of CodePipeline</span>
<span class="line">//</span>
<span class="line">////////////////////</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"># Create a CodeBuild source credential resource with the GitHub personal access token</span>
<span class="line">resource "aws_codebuild_source_credential" "github_token" {</span>
<span class="line">  auth_type   = "PERSONAL_ACCESS_TOKEN"</span>
<span class="line">  server_type = "GITHUB"</span>
<span class="line">  token = ""</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line"># Create a CodeBuild project that uses GitHub as the source and personal access token as the authentication method</span>
<span class="line">resource "aws_codebuild_project" "mark_codebuild" {</span>
<span class="line">  name        = "mark_codebuild"</span>
<span class="line">  description = "mark_codebuild"</span>
<span class="line">  service_role = aws_iam_role.mark_cicd_role.arn </span>
<span class="line">&nbsp;</span>
<span class="line">  artifacts {</span>
<span class="line">    type = "NO_ARTIFACTS"</span>
<span class="line">  }</span>
<span class="line">&nbsp;</span>
<span class="line">  environment {</span>
<span class="line">    compute_type                = "BUILD_GENERAL1_SMALL"</span>
<span class="line">    image                       = "aws/codebuild/amazonlinux2-x86_64-standard:5.0"</span>
<span class="line">    type                        = "LINUX_CONTAINER"</span>
<span class="line">    image_pull_credentials_type = "CODEBUILD"</span>
<span class="line">    privileged_mode             = true</span>
<span class="line">  }</span>
<span class="line">&nbsp;</span>
<span class="line">  source {</span>
<span class="line">    type            = "GITHUB"</span>
<span class="line">    location        = "https://github.com/mmulcahy222/mark_aws_cicd" </span>
<span class="line">    git_clone_depth = 1</span>
<span class="line">    buildspec       = "buildspec.yml"</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">////////////////////</span>
<span class="line">//</span>
<span class="line">//  ECR</span>
<span class="line">//</span>
<span class="line">////////////////////</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_ecr_repository" "mark_ecr" {</span>
<span class="line">  name = "mark_ecr_repository"</span>
<span class="line">  image_tag_mutability = "MUTABLE" </span>
<span class="line">  image_scanning_configuration {</span>
<span class="line">    scan_on_push = true</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">output "ecr_repository_name" {</span>
<span class="line">  description = "Name of the ECR repository"</span>
<span class="line">  value       = aws_ecr_repository.mark_ecr.name</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">output "ecr_repository_url" {</span>
<span class="line">  description = "URL of the ECR repository"</span>
<span class="line">  value       = aws_ecr_repository.mark_ecr.repository_url</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">/*</span>
<span class="line">data "aws_ecs_task" "mark_ecs_task" {</span>
<span class="line">  task_definition = aws_ecs_task_definition.mark_ecs_task_definition.arn</span>
<span class="line">  cluster         = aws_ecs_cluster.mark_ecs_cluster.id</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">output "public_ip" {</span>
<span class="line">  value = data.aws_ecs_task.mark_ecs_task.eni_network_interface_ids[0].public_ipv4_address</span>
<span class="line">}</span>
<span class="line">*/</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">////////////////////</span>
<span class="line">//</span>
<span class="line">//  CODEPIPELINE</span>
<span class="line">//</span>
<span class="line">////////////////////</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_codestarconnections_connection" "github_connection" {</span>
<span class="line">  name          = "github-connection"</span>
<span class="line">  provider_type = "GitHub"</span>
<span class="line">}</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">resource "aws_codepipeline" "mark_codepipeline" {</span>
<span class="line">  name     = "mark_codepipeline_terraform"</span>
<span class="line">  role_arn = aws_iam_role.mark_cicd_role.arn</span>
<span class="line">  artifact_store {</span>
<span class="line">    location = aws_s3_bucket.mark_bucket.id</span>
<span class="line">    type     = "S3"</span>
<span class="line">  }</span>
<span class="line">&nbsp;</span>
<span class="line">  stage {</span>
<span class="line">  name = "Source"</span>
<span class="line">  action {</span>
<span class="line">    name     = "SourceAction"</span>
<span class="line">    category = "Source"</span>
<span class="line">    owner    = "AWS"</span>
<span class="line">    provider = "CodeStarSourceConnection"</span>
<span class="line">    version  = "1"</span>
<span class="line">    output_artifacts = ["source_output"] </span>
<span class="line">    configuration = {</span>
<span class="line">      ConnectionArn   = aws_codestarconnections_connection.github_connection.arn</span>
<span class="line">      FullRepositoryId = "mmulcahy222/mark_aws_cicd"</span>
<span class="line">      BranchName       = "master"</span>
<span class="line">      OutputArtifactFormat = "CODE_ZIP"</span>
<span class="line">      }</span>
<span class="line">    }</span>
<span class="line">  }</span>
<span class="line">&nbsp;</span>
<span class="line">  stage {</span>
<span class="line">    name = "Build"</span>
<span class="line">    action {</span>
<span class="line">      name     = "BuildAction"</span>
<span class="line">      category = "Build"</span>
<span class="line">      owner    = "AWS"</span>
<span class="line">      provider = "CodeBuild"</span>
<span class="line">      version  = "1"</span>
<span class="line">      input_artifacts = ["source_output"] </span>
<span class="line">      output_artifacts = ["build_output"] </span>
<span class="line">&nbsp;</span>
<span class="line">      configuration = {</span>
<span class="line">        ProjectName = aws_codebuild_project.mark_codebuild.name</span>
<span class="line">      }</span>
<span class="line">    }</span>
<span class="line">  }</span>
<span class="line">&nbsp;</span>
<span class="line">  stage {</span>
<span class="line">    name = "Deploy"</span>
<span class="line">    action {</span>
<span class="line">      name     = "DeployAction"</span>
<span class="line">      category = "Deploy"</span>
<span class="line">      owner    = "AWS"</span>
<span class="line">      provider = "ECS"</span>
<span class="line">      version  = "1"</span>
<span class="line">      input_artifacts = ["build_output"]</span>
<span class="line">      configuration = {</span>
<span class="line">        ClusterName = aws_ecs_cluster.mark_ecs_cluster.name</span>
<span class="line">        ServiceName = aws_ecs_service.mark_ecs_service.name</span>
<span class="line">        FileName    = "imagedefinitions.json"</span>
<span class="line">      }</span>
<span class="line">    }</span>
<span class="line">  }</span>
<span class="line">}</span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Terraform AWS CI/CD for ECS/ECR containers</div>
                <div class="description">Build specification for Terraform AWS CI/CD pipeline.</div>
                <div class="languages">Terraform</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-hcl" tabindex="0">                <code class="language-hcl"><span class="line">version: 0.2</span>
<span class="line">phases:</span>
<span class="line">  pre_build:</span>
<span class="line">    commands:</span>
<span class="line">      - echo Logging in to Amazon ECR...</span>
<span class="line">      - export AWS_REGION="us-east-1"</span>
<span class="line">      - export AWS_ACCOUNT_ID=""</span>
<span class="line">      - export IMAGE_REPO_NAME="mark_ecr_repository"</span>
<span class="line">      - export REPOSITORY_URI="${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.amazonaws.com/${IMAGE_REPO_NAME}"</span>
<span class="line">      - export COMMIT_HASH="$(echo ${CODEBUILD_RESOLVED_SOURCE_VERSION} | cut -c 1-7)"</span>
<span class="line">      - export IMAGE_TAG="${COMMIT_HASH:-latest}"</span>
<span class="line">  build:</span>
<span class="line">    commands:</span>
<span class="line">      - echo Build started on `date`</span>
<span class="line">      - echo Building the Docker image...</span>
<span class="line">      - docker build -t ${REPOSITORY_URI}:${IMAGE_TAG} .</span>
<span class="line">      - echo Running NGINX in the Docker container...</span>
<span class="line">      - docker run -d -p 8080:80 ${REPOSITORY_URI}:${IMAGE_TAG}</span>
<span class="line">  post_build:</span>
<span class="line">    commands:</span>
<span class="line">      - echo Build completed on `date`</span>
<span class="line">      - echo Pushing the Docker image...</span>
<span class="line">      - aws ecr get-login-password | docker login --username AWS --password-stdin "${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.amazonaws.com"</span>
<span class="line">      - docker push ${REPOSITORY_URI}:${IMAGE_TAG}</span>
<span class="line">      - echo Writing image definitions file...</span>
<span class="line">      - printf '[{"name":"mark_container_nginx","imageUri":"%s"}]' ${REPOSITORY_URI}:${IMAGE_TAG} &gt; imagedefinitions.json</span>
<span class="line">artifacts:</span>
<span class="line">  files:</span>
<span class="line">    - imagedefinitions.json</span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Turn any Python Code to Alexa OR Google Home Skill</div>
                <div class="description">Decorator to turn Python code into Alexa or Google Home skills.</div>
                <div class="languages">Python</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-python" tabindex="0">                <code class="language-python"><span class="line"><span class="token keyword keyword-import">import</span> json</span>
<span class="line"><span class="token keyword keyword-import">import</span> os</span>
<span class="line"><span class="token keyword keyword-import">import</span> pprint</span>
<span class="line"><span class="token keyword keyword-import">import</span> sys</span>
<span class="line"><span class="token keyword keyword-import">import</span> operator</span>
<span class="line"><span class="token keyword keyword-import">import</span> functools</span>
<span class="line"><span class="token keyword keyword-import">import</span> time</span>
<span class="line"><span class="token keyword keyword-import">import</span> datetime</span>
<span class="line"><span class="token keyword keyword-import">import</span> urllib</span>
<span class="line"><span class="token keyword keyword-import">import</span> urllib<span class="token punctuation">.</span>parse </span>
<span class="line"><span class="token keyword keyword-import">import</span> urllib<span class="token punctuation">.</span>request</span>
<span class="line"><span class="token keyword keyword-from">from</span> collections <span class="token keyword keyword-import">import</span> defaultdict</span>
<span class="line"><span class="token keyword keyword-from">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword keyword-import">import</span> unquote</span>
<span class="line"><span class="token keyword keyword-from">from</span> urllib<span class="token punctuation">.</span>request <span class="token keyword keyword-import">import</span> Request<span class="token punctuation">,</span> urlopen </span>
<span class="line"><span class="token keyword keyword-import">import</span> re</span>
<span class="line"><span class="token keyword keyword-import">import</span> copy</span>
<span class="line"><span class="token keyword keyword-import">import</span> boto3</span>
<span class="line"><span class="token keyword keyword-import">import</span> random</span>
<span class="line"><span class="token keyword keyword-import">import</span> string</span>
<span class="line"><span class="token keyword keyword-from">from</span> botocore<span class="token punctuation">.</span>exceptions <span class="token keyword keyword-import">import</span> ClientError</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">origin_type <span class="token operator">=</span> <span class="token string">''</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">handle_exception</span></span><span class="token punctuation">(</span>default_value<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">wrap</span></span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">wrapped_f</span></span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword keyword-return">return</span> f<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword keyword-return">return</span> default_value</span>
<span class="line">        <span class="token keyword keyword-return">return</span> wrapped_f</span>
<span class="line">    <span class="token keyword keyword-return">return</span> wrap</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_current_location</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment">#only purpose is for portability between windows system &amp; google functions </span></span>
<span class="line">    <span class="token comment">#if in local windows system</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> os<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">'nt'</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token string">'windows'</span></span>
<span class="line">    <span class="token comment">#if in amazon</span></span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"AWS_EXECUTION_ENV"</span><span class="token punctuation">)</span> <span class="token keyword keyword-is">is</span> <span class="token keyword keyword-not">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token string">'amazon'</span> </span>
<span class="line">    <span class="token comment">#if google cloud or other cloud like azure</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token string">'google'</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">AmazonAWS</span><span class="token punctuation">:</span></span>
<span class="line">    @handle_exception<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_request_json</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> request</span>
<span class="line">    @handle_exception<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_intent</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>response_json<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> response_json<span class="token punctuation">[</span><span class="token string">'request'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'intent'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>	</span>
<span class="line">    @handle_exception<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_parameter</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request_json<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment">#called slot values here</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> request_json<span class="token punctuation">[</span><span class="token string">'request'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'intent'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'slots'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span></span>
<span class="line">    @handle_exception<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_parameters</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request_json<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment">#format it for the inner function in a decorator</span></span>
<span class="line">        <span class="token comment">#looks like {'any': 'thriller', 'time': '00:00'}</span></span>
<span class="line">        slots <span class="token operator">=</span> request_json<span class="token punctuation">[</span><span class="token string">'request'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'intent'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'slots'</span><span class="token punctuation">]</span>	</span>
<span class="line">        parameters <span class="token operator">=</span> <span class="token punctuation">{</span>k<span class="token punctuation">:</span>v<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"value"</span><span class="token punctuation">)</span> <span class="token keyword keyword-for">for</span> k<span class="token punctuation">,</span>v <span class="token keyword keyword-in">in</span> slots<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>		</span>
<span class="line">        <span class="token keyword keyword-return">return</span> parameters</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">device_text_response</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        speech_output <span class="token operator">=</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"speech_output"</span><span class="token punctuation">,</span><span class="token string">"OK"</span><span class="token punctuation">)</span></span>
<span class="line">        session_attributes <span class="token operator">=</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"session_attributes"</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">        should_end_session <span class="token operator">=</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"should_end_session"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        response <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token string">"sessionAttributes"</span><span class="token punctuation">:</span> session_attributes<span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">"response"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token string">"outputSpeech"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"SSML"</span><span class="token punctuation">,</span></span>
<span class="line">                    <span class="token string">"ssml"</span><span class="token punctuation">:</span><span class="token string">"&lt;speak&gt;"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>speech_output<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">7999</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"&lt;/speak&gt;"</span></span>
<span class="line">                <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            </span>
<span class="line">                <span class="token string">"reprompt"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token string">"outputSpeech"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"SSML"</span><span class="token punctuation">,</span></span>
<span class="line">                        <span class="token string">"ssml"</span><span class="token punctuation">:</span> <span class="token string">"&lt;speak&gt;"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>speech_output<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">7999</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"&lt;/speak&gt;"</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">"shouldEndSession"</span><span class="token punctuation">:</span> should_end_session</span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> response</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">device_audio_response</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        alphanumeric <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span>octdigits <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_letters<span class="token punctuation">)</span></span>
<span class="line">        random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>alphanumeric<span class="token punctuation">)</span></span>
<span class="line">        token <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>alphanumeric<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">        response <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token string">"response"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token string">"outputSpeech"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"SSML"</span><span class="token punctuation">,</span></span>
<span class="line">                    <span class="token string">"ssml"</span><span class="token punctuation">:</span><span class="token string">"&lt;speak&gt;"</span> <span class="token operator">+</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"text_speech"</span><span class="token punctuation">,</span><span class="token string">"Ok"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&lt;/speak&gt;"</span></span>
<span class="line">                <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token string">"directives"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span></span>
<span class="line">                    <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"AudioPlayer.Play"</span><span class="token punctuation">,</span></span>
<span class="line">                        <span class="token string">"playBehavior"</span><span class="token punctuation">:</span> <span class="token string">"REPLACE_ALL"</span><span class="token punctuation">,</span></span>
<span class="line">                        <span class="token string">"audioItem"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                            <span class="token string">"stream"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                                <span class="token string">"token"</span><span class="token punctuation">:</span> token<span class="token punctuation">,</span></span>
<span class="line">                                <span class="token string">"url"</span><span class="token punctuation">:</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"audio_url"</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                                <span class="token string">"offsetInMilliseconds"</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
<span class="line">                            <span class="token punctuation">}</span></span>
<span class="line">                        <span class="token punctuation">}</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token string">"shouldEndSession"</span><span class="token punctuation">:</span> <span class="token number">1</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> response</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">return_trip_json</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>contents<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># AMAZON AWS JUST REQUIRES PAYLOAD (you're calling Lambda directly)</span></span>
<span class="line">        <span class="token comment">#</span></span>
<span class="line">        <span class="token comment"># if isinstance(contents,dict):</span></span>
<span class="line">        <span class="token comment"># 	contents = json.dumps(contents)</span></span>
<span class="line">        <span class="token comment"># return_dict = {</span></span>
<span class="line">        <span class="token comment"># 	"statusCode": 200,</span></span>
<span class="line">        <span class="token comment"># 	"headers": {"Content-Type": "application/json"},</span></span>
<span class="line">        <span class="token comment"># 	"body": contents</span></span>
<span class="line">        <span class="token comment"># }</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> contents</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">response_text_facade</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>contents<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> self<span class="token punctuation">.</span>return_trip_json<span class="token punctuation">(</span>self<span class="token punctuation">.</span>device_text_response<span class="token punctuation">(</span>speech_output<span class="token operator">=</span>contents<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">GoogleCloud</span><span class="token punctuation">:</span></span>
<span class="line">    @handle_exception<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_request_json</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>request<span class="token punctuation">[</span><span class="token string">'body'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    @handle_exception<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_intent</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request_json<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> request_json<span class="token punctuation">[</span><span class="token string">'queryResult'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'intent'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'displayName'</span><span class="token punctuation">]</span></span>
<span class="line">    @handle_exception<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_parameter</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request_json<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> request_json<span class="token punctuation">[</span><span class="token string">'queryResult'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'parameters'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span></span>
<span class="line">    @handle_exception<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_parameters</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request_json<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment">#format it for the inner function in a decorator</span></span>
<span class="line">        <span class="token comment">#looks like {'any': 'thriller', 'time': '00:00'}</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> request_json<span class="token punctuation">[</span><span class="token string">'queryResult'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'parameters'</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">device_text_response</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        response_json <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token string">"fulfillmentText"</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'speech_output'</span><span class="token punctuation">,</span><span class="token string">'Ok'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>response_json<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">device_audio_response</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        response_json <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">#"fulfillmentText": str(speech_output),</span></span>
<span class="line">            <span class="token string">"payload"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token string">"google"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token string">"richResponse"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token string">"items"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span></span>
<span class="line">                            <span class="token punctuation">{</span></span>
<span class="line">                                <span class="token string">"simpleResponse"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                                    <span class="token string">"textToSpeech"</span><span class="token punctuation">:</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"text_speech"</span><span class="token punctuation">,</span><span class="token string">"Ok"</span><span class="token punctuation">)</span></span>
<span class="line">                                <span class="token punctuation">}</span></span>
<span class="line">                            <span class="token punctuation">}</span></span>
<span class="line">                            <span class="token punctuation">,</span></span>
<span class="line">                            <span class="token punctuation">{</span></span>
<span class="line">                                <span class="token string">"mediaResponse"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                                    <span class="token string">"mediaType"</span><span class="token punctuation">:</span> <span class="token string">"AUDIO"</span><span class="token punctuation">,</span></span>
<span class="line">                                    <span class="token string">"mediaObjects"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span></span>
<span class="line">                                        <span class="token punctuation">{</span></span>
<span class="line">                                            <span class="token string">"contentUrl"</span><span class="token punctuation">:</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"audio_url"</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                                            <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"Audio Book"</span><span class="token punctuation">,</span></span>
<span class="line">                                            <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Audio Book"</span></span>
<span class="line">                                        <span class="token punctuation">}</span></span>
<span class="line">                                    <span class="token punctuation">]</span></span>
<span class="line">                                <span class="token punctuation">}</span></span>
<span class="line">                            <span class="token punctuation">}</span></span>
<span class="line">                        <span class="token punctuation">]</span></span>
<span class="line">                        <span class="token punctuation">,</span></span>
<span class="line">                        <span class="token string">"suggestions"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span></span>
<span class="line">                            <span class="token punctuation">{</span></span>
<span class="line">                                <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"Suggestion"</span></span>
<span class="line">                            <span class="token punctuation">}</span></span>
<span class="line">                        <span class="token punctuation">]</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>response_json<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">return_trip_json</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>contents<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># Amazon API Gateway JSON is here (on way back to Dialogflow) because we're using Amazon API Gateway</span></span>
<span class="line">        <span class="token comment"># Change Accordingly</span></span>
<span class="line">        <span class="token comment">#if isinstance(contents,dict):</span></span>
<span class="line">        <span class="token comment">#	contents = json.dumps(contents)</span></span>
<span class="line">        return_dict <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token string">"statusCode"</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">"headers"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">"body"</span><span class="token punctuation">:</span> contents</span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> return_dict</span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">response_text_facade</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>contents<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> self<span class="token punctuation">.</span>return_trip_json<span class="token punctuation">(</span>self<span class="token punctuation">.</span>device_text_response<span class="token punctuation">(</span>speech_output<span class="token operator">=</span>contents<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">HTTPBrowser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    @handle_exception<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">__getattr__</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">wrapper</span></span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token boolean">None</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> wrapper</span>
<span class="line">    @handle_exception<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_http_header_host</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>event<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> event<span class="token punctuation">[</span><span class="token string">'headers'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Host'</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">return_trip_json</span></span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>contents<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>contents<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            contents <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>contents<span class="token punctuation">)</span></span>
<span class="line">        return_dict <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token string">"statusCode"</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">"headers"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">"body"</span><span class="token punctuation">:</span> contents</span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> return_dict</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">smart_speaker_decorator</span></span><span class="token punctuation">(</span>type_of_output<span class="token operator">=</span><span class="token string">"text"</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">'''</span>
<span class="line">    This is a Decorator to turn any regular code into an Alexa Skill or Google Home Skill using Amazon AWS for now</span>
<span class="line">    '''</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">first_function</span></span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">second_function</span></span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token comment">#get_item</span></span>
<span class="line">                <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_item</span></span><span class="token punctuation">(</span>iterable<span class="token punctuation">,</span> index<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">                    <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">                        <span class="token keyword keyword-return">return</span> operator<span class="token punctuation">.</span>getitem<span class="token punctuation">(</span>iterable<span class="token punctuation">,</span> index<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">                        <span class="token keyword keyword-return">return</span> default</span>
<span class="line">                <span class="token comment">#initial variables (lambda or google event,context)</span></span>
<span class="line">                amazon_aws <span class="token operator">=</span> AmazonAWS<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                google_cloud <span class="token operator">=</span> GoogleCloud<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                http_browser <span class="token operator">=</span> HTTPBrowser<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                event <span class="token operator">=</span> get_item<span class="token punctuation">(</span>args<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">                context <span class="token operator">=</span> get_item<span class="token punctuation">(</span>args<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-global">global</span> origin_type</span>
<span class="line">                <span class="token comment">#########################</span></span>
<span class="line">                <span class="token comment">#    DETERMINES THE ORIGIN</span></span>
<span class="line">                <span class="token comment">#########################</span></span>
<span class="line">                <span class="token comment">#	CHECKS TO SEE IF THERE'S A SESSION-&gt;APPLICATION-&gt;APPLICATIONID, characteristic of Amazon Event Objects.</span></span>
<span class="line">                <span class="token comment">#It looks at the decorated get_request_json objects and sees if it put in an exception</span></span>
<span class="line">                amazon_aws_alexa_request_json <span class="token operator">=</span> amazon_aws<span class="token punctuation">.</span>get_request_json<span class="token punctuation">(</span>event<span class="token punctuation">)</span></span>
<span class="line">                google_cloud_alexa_request_json <span class="token operator">=</span> google_cloud<span class="token punctuation">.</span>get_request_json<span class="token punctuation">(</span>event<span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> google_cloud_alexa_request_json <span class="token operator">!=</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">                    origin_type <span class="token operator">=</span> <span class="token string">'google_cloud'</span></span>
<span class="line">                    origin <span class="token operator">=</span> google_cloud</span>
<span class="line">                <span class="token keyword keyword-elif">elif</span> <span class="token string">'amazonaws'</span> <span class="token keyword keyword-in">in</span> <span class="token builtin">str</span><span class="token punctuation">(</span>http_browser<span class="token punctuation">.</span>get_http_header_host<span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">                    origin_type <span class="token operator">=</span> <span class="token string">'http_browser'</span></span>
<span class="line">                    origin <span class="token operator">=</span> http_browser</span>
<span class="line">                <span class="token keyword keyword-elif">elif</span> amazon_aws_alexa_request_json <span class="token operator">!=</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">                    origin_type <span class="token operator">=</span> <span class="token string">'amazon_aws'</span></span>
<span class="line">                    origin <span class="token operator">=</span> amazon_aws</span>
<span class="line">                <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">                    origin_type <span class="token operator">=</span> <span class="token string">'http_browser'</span></span>
<span class="line">                    origin <span class="token operator">=</span> http_browser</span>
<span class="line">                <span class="token comment">#	Key Error is wrong attribute, Type Error is for doing getattr [] on a string</span></span>
<span class="line">                <span class="token comment">#	Origin is for Google Cloud because most of the time we want Google Devices</span></span>
<span class="line">&nbsp;</span>
<span class="line">                <span class="token comment">#########################</span></span>
<span class="line">                <span class="token comment">#    END DETERMINE ORIGIN</span></span>
<span class="line">                <span class="token comment">#########################</span></span>
<span class="line">                <span class="token comment">#	Lambda Functions will read this. Not Google Cloud Functions yet. Google Cloud Functions deploy too slowly</span></span>
<span class="line">                destination <span class="token operator">=</span> amazon_aws</span>
<span class="line">                <span class="token comment">#	Handle the event object that passes by differently</span></span>
<span class="line">                request_json <span class="token operator">=</span> origin<span class="token punctuation">.</span>get_request_json<span class="token punctuation">(</span>event<span class="token punctuation">)</span></span>
<span class="line">                <span class="token comment">#	Get Intent</span></span>
<span class="line">                intent <span class="token operator">=</span> origin<span class="token punctuation">.</span>get_intent<span class="token punctuation">(</span>request_json<span class="token punctuation">)</span></span>
<span class="line">                <span class="token comment">#	Amazon Slot values &amp; parameters from Google Home</span></span>
<span class="line">                parameters <span class="token operator">=</span> origin<span class="token punctuation">.</span>get_parameters<span class="token punctuation">(</span>request_json<span class="token punctuation">)</span></span>
<span class="line">                <span class="token comment">#	send intent to the function that called the decorator</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>parameters<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">                    parameters<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"intent"</span><span class="token punctuation">:</span>intent<span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">                    parameters <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">                <span class="token comment">#	RUN ACTUAL CODE</span></span>
<span class="line">                result <span class="token operator">=</span> f<span class="token punctuation">(</span>event<span class="token punctuation">,</span>context<span class="token punctuation">,</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>parameters<span class="token punctuation">)</span></span>
<span class="line">                <span class="token comment">#	END DEBUG</span></span>
<span class="line">                <span class="token comment">#	END RUN ACTUAL CODE</span></span>
<span class="line">                <span class="token comment">#	</span></span>
<span class="line">                <span class="token comment">#	</span></span>
<span class="line">                <span class="token comment">#	IF THIS IS A WEB REQUEST IN THE AMAZON API GATEWAY!!! (LAMBDA URL)</span></span>
<span class="line">                <span class="token comment">#	</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> <span class="token string">'http_browser'</span> <span class="token operator">==</span> origin_type<span class="token punctuation">:</span></span>
<span class="line">                    <span class="token keyword keyword-return">return</span> <span class="token punctuation">{</span><span class="token string">"statusCode"</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"headers"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"body"</span><span class="token punctuation">:</span> pprint<span class="token punctuation">.</span>pformat<span class="token punctuation">(</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">                <span class="token comment">#</span></span>
<span class="line">                <span class="token comment">#	Make Destination account for Google Cloud Functions if for some reason the processign is done there</span></span>
<span class="line">                <span class="token comment">#</span></span>
<span class="line">                <span class="token comment">#	If it's audio, send it in either Google or Amazon format</span></span>
<span class="line">                <span class="token comment">#	IF DOING AUDIO, SEND IT A DICT WITH AUDIO_URL &amp; TEXT_SPEECH!!</span></span>
<span class="line">                <span class="token comment">#	Destination means in this case, format JSON in Amazon AWS format</span></span>
<span class="line">                <span class="token comment">#</span></span>
<span class="line">                </span>
<span class="line">                <span class="token keyword keyword-if">if</span> <span class="token string">'audio'</span> <span class="token operator">==</span> type_of_output<span class="token punctuation">:</span></span>
<span class="line">                    <span class="token comment">#usually for debugging, it will normally not be send that way</span></span>
<span class="line">                    <span class="token keyword keyword-if">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span></span>
<span class="line">                        result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">                    <span class="token keyword keyword-return">return</span> origin<span class="token punctuation">.</span>return_trip_json<span class="token punctuation">(</span>origin<span class="token punctuation">.</span>device_audio_response<span class="token punctuation">(</span><span class="token operator">**</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token comment">#</span></span>
<span class="line">                <span class="token comment">#	TEXT is the fallback for either Amazon or Google</span></span>
<span class="line">                <span class="token comment">#</span></span>
<span class="line">                <span class="token keyword keyword-elif">elif</span> <span class="token string">'text'</span> <span class="token operator">==</span> type_of_output<span class="token punctuation">:</span></span>
<span class="line">                    <span class="token keyword keyword-return">return</span> origin<span class="token punctuation">.</span>return_trip_json<span class="token punctuation">(</span>origin<span class="token punctuation">.</span>device_text_response<span class="token punctuation">(</span>speech_output<span class="token operator">=</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token comment">#</span></span>
<span class="line">                <span class="token comment">#	YOU should NEVER reach here. Fallback</span></span>
<span class="line">                <span class="token comment">#</span></span>
<span class="line">                <span class="token keyword keyword-return">return</span> <span class="token punctuation">{</span><span class="token string">"statusCode"</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"headers"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"body"</span><span class="token punctuation">:</span> pprint<span class="token punctuation">.</span>pformat<span class="token punctuation">(</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">            <span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">                exc_type<span class="token punctuation">,</span> exc_obj<span class="token punctuation">,</span> exc_tb <span class="token operator">=</span> sys<span class="token punctuation">.</span>exc_info<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                exception_text <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>exc_type<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>exc_obj<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>exc_tb<span class="token punctuation">.</span>tb_lineno<span class="token punctuation">)</span></span>
<span class="line">                <span class="token comment">#</span></span>
<span class="line">                <span class="token comment"># DEBUG</span></span>
<span class="line">                <span class="token comment"># </span></span>
<span class="line">                <span class="token keyword keyword-import">import</span> traceback</span>
<span class="line">                traceback<span class="token punctuation">.</span>print_exc<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token comment"># </span></span>
<span class="line">                <span class="token comment"># AMAZON AWS ONLY</span></span>
<span class="line">                <span class="token comment"># </span></span>
<span class="line">                <span class="token comment">#return {'statusCode': 200, 'headers': {'Content-Type': 'application/json'}, 'body': exception_text + repr(locals())}</span></span>
<span class="line">                <span class="token comment">#</span></span>
<span class="line">                <span class="token comment"># IF EXTENDING THIS FOR GOOGLE CLOUD FUNCTIONS TO SEE THIS, ACTIVATE THE FOLLOWING</span></span>
<span class="line">                <span class="token comment">#</span></span>
<span class="line">                <span class="token keyword keyword-return">return</span> origin<span class="token punctuation">.</span>return_trip_json<span class="token punctuation">(</span>origin<span class="token punctuation">.</span>device_text_response<span class="token punctuation">(</span>speech_output<span class="token operator">=</span><span class="token string">"Nothing was found. Say something else or be more specific. "</span> <span class="token operator">+</span> exception_text<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token comment">#return origin.return_trip_json(origin.device_text_response(speech_output=exception_text + pprint.pformat(locals())))</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> second_function</span>
<span class="line">    <span class="token keyword keyword-return">return</span> first_function</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_audio_url_from_web_url</span></span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-global">global</span> origin_type</span>
<span class="line">    response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>url<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> response<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-raise">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"Unable to open url: {0}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    html <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        json_start_pattern <span class="token operator">=</span> <span class="token string">"ytplayer.config = "</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">        json_start_pattern <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token string">"ytplayer.config = "</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span></span>
<span class="line">    pattern_idx <span class="token operator">=</span> html<span class="token punctuation">.</span>find<span class="token punctuation">(</span>json_start_pattern<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># In case video is unable to play</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>pattern_idx <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-raise">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"Unable to find start pattern."</span><span class="token punctuation">)</span></span>
<span class="line">    start <span class="token operator">=</span> pattern_idx <span class="token operator">+</span> <span class="token number">18</span></span>
<span class="line">    html <span class="token operator">=</span> html<span class="token punctuation">[</span>start<span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_json_offset</span></span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token triple-quoted-string string">'''called from get_audio_from_web_url. Gets YT Config inside of page, and returns the number offset to slice'''</span></span>
<span class="line">        unmatched_brackets_num <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">        index <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> i<span class="token punctuation">,</span> ch <span class="token keyword keyword-in">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>ch<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">                ch <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> ch <span class="token operator">==</span> <span class="token string">"{"</span><span class="token punctuation">:</span></span>
<span class="line">                unmatched_brackets_num <span class="token operator">+=</span> <span class="token number">1</span></span>
<span class="line">            <span class="token keyword keyword-elif">elif</span> ch <span class="token operator">==</span> <span class="token string">"}"</span><span class="token punctuation">:</span></span>
<span class="line">                unmatched_brackets_num <span class="token operator">-=</span> <span class="token number">1</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> unmatched_brackets_num <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">                    <span class="token keyword keyword-break">break</span></span>
<span class="line">        <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword keyword-raise">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"Unable to determine json offset."</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> index <span class="token operator">+</span> i</span>
<span class="line">    <span class="token comment">#get json offset is to get the starting and last curly braces of beginnign and closing end of config</span></span>
<span class="line">    <span class="token comment">#json offset is a number value for later slicing, where it will turn into JSON by json.loads</span></span>
<span class="line">    offset <span class="token operator">=</span> get_json_offset<span class="token punctuation">(</span>html<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> offset<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-raise">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"Unable to extract json."</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        json_content <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>html<span class="token punctuation">[</span><span class="token punctuation">:</span>offset<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">        json_content <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>html<span class="token punctuation">[</span><span class="token punctuation">:</span>offset<span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    player_response_string <span class="token operator">=</span> json_content<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"args"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"player_response"</span><span class="token punctuation">)</span></span>
<span class="line">    player_response_json <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>player_response_string<span class="token punctuation">)</span></span>
<span class="line">    video_audio_nodes <span class="token operator">=</span> player_response_json<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'streamingData'</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'adaptiveFormats'</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">#Run through the nodes containing bitrates &amp; video urls &amp; formats</span></span>
<span class="line">    audio_nodes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword keyword-for">for</span> video_audio_node <span class="token keyword keyword-in">in</span> video_audio_nodes<span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment">#only get those with audio</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token string">'audio'</span> <span class="token keyword keyword-in">in</span> video_audio_node<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"mimeType"</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            audio_url <span class="token operator">=</span> video_audio_node<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">            quality <span class="token operator">=</span> video_audio_node<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'quality'</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">            content_length <span class="token operator">=</span> video_audio_node<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'contentLength'</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">            mime_type <span class="token operator">=</span> video_audio_node<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"mimeType"</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token comment">#append tuple</span></span>
<span class="line">            audio_nodes<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>content_length<span class="token punctuation">,</span>audio_url<span class="token punctuation">,</span>mime_type<span class="token punctuation">,</span>quality<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">#in a list of tuples, the first value in the tuple would be sorted in the list</span></span>
<span class="line">    <span class="token comment">#size of file (lowest) will be first up to the largest files</span></span>
<span class="line">    audio_nodes<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">#the first [-1] means largest sized</span></span>
<span class="line">    <span class="token comment">#the second [1] is the audio_url as specified in the append function above by virtue of it's placement</span></span>
<span class="line">    audio_quality <span class="token operator">=</span> <span class="token number">2</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> origin_type <span class="token operator">==</span> <span class="token string">'google_cloud'</span><span class="token punctuation">:</span></span>
<span class="line">        audio_quality <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span></span>
<span class="line">    <span class="token comment">#else if amazon or anything else, make it 2</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> audio_nodes<span class="token punctuation">[</span>audio_quality<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># def get_audio_url_from_web_url_april_2019(url):</span></span>
<span class="line"><span class="token comment">#     global origin_type</span></span>
<span class="line"><span class="token comment">#     req = Request(url)</span></span>
<span class="line"><span class="token comment">#     req.add_header('Connection', 'keep-alive')</span></span>
<span class="line"><span class="token comment">#     req.add_header('User-Agent',  'Mozilla/5.0 (X11; Linux i686; G518Rco3Yp0uLV40Lcc9hAzC1BOROTJADjicLjOmlr4=) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.157 Safari/537.36')</span></span>
<span class="line"><span class="token comment">#     req.add_header('Accept', 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8')</span></span>
<span class="line"><span class="token comment">#     req.add_header('Accept-Charset', 'ISO-8859-1,utf-8;q=0.7,*;q=0.3')</span></span>
<span class="line"><span class="token comment">#     req.add_header('Accept-Language', 'en-US,en;q=0.8')</span></span>
<span class="line"><span class="token comment">#     html = urlopen(req).read()</span></span>
<span class="line"><span class="token comment">#     if not html:</span></span>
<span class="line"><span class="token comment">#         raise Exception("Unable to open url: {0}".format(self.url))</span></span>
<span class="line"><span class="token comment">#     if isinstance(html, str):</span></span>
<span class="line"><span class="token comment">#         json_start_pattern = "ytplayer.config = "</span></span>
<span class="line"><span class="token comment">#     else:</span></span>
<span class="line"><span class="token comment">#         json_start_pattern = bytes("ytplayer.config = ", "utf-8")</span></span>
<span class="line"><span class="token comment">#     pattern_idx = html.find(json_start_pattern)</span></span>
<span class="line"><span class="token comment">#     # In case video is unable to play</span></span>
<span class="line"><span class="token comment">#     if(pattern_idx == -1):</span></span>
<span class="line"><span class="token comment">#         raise Exception("Unable to find start pattern.")</span></span>
<span class="line"><span class="token comment">#     start = pattern_idx + 18</span></span>
<span class="line"><span class="token comment">#     html = html[start:]</span></span>
<span class="line"><span class="token comment">#     def get_json_offset(html):</span></span>
<span class="line"><span class="token comment">#         '''called from get_audio_from_web_url. Gets YT Config inside of page, and returns the number offset to slice'''</span></span>
<span class="line"><span class="token comment">#         unmatched_brackets_num = 0</span></span>
<span class="line"><span class="token comment">#         index = 1</span></span>
<span class="line"><span class="token comment">#         for i, ch in enumerate(html):</span></span>
<span class="line"><span class="token comment">#             if isinstance(ch, int):</span></span>
<span class="line"><span class="token comment">#                 ch = chr(ch)</span></span>
<span class="line"><span class="token comment">#             if ch == "{":</span></span>
<span class="line"><span class="token comment">#                 unmatched_brackets_num += 1</span></span>
<span class="line"><span class="token comment">#             elif ch == "}":</span></span>
<span class="line"><span class="token comment">#                 unmatched_brackets_num -= 1</span></span>
<span class="line"><span class="token comment">#                 if unmatched_brackets_num == 0:</span></span>
<span class="line"><span class="token comment">#                     break</span></span>
<span class="line"><span class="token comment">#         else:</span></span>
<span class="line"><span class="token comment">#             raise Exception("Unable to determine json offset.")</span></span>
<span class="line"><span class="token comment">#         return index + i</span></span>
<span class="line"><span class="token comment">#     #get json offset is to get the starting and last curly braces of beginnign and closing end of config</span></span>
<span class="line"><span class="token comment">#     #json offset is a number value for later slicing, where it will turn into JSON by json.loads</span></span>
<span class="line"><span class="token comment">#     offset = get_json_offset(html)</span></span>
<span class="line"><span class="token comment">#     if not offset:</span></span>
<span class="line"><span class="token comment">#         raise Exception("Unable to extract json.")</span></span>
<span class="line"><span class="token comment">#     if isinstance(html, str):</span></span>
<span class="line"><span class="token comment">#         json_content = json.loads(html[:offset])</span></span>
<span class="line"><span class="token comment">#     else:</span></span>
<span class="line"><span class="token comment">#         json_content = json.loads(html[:offset].decode("utf-8"))</span></span>
<span class="line"><span class="token comment">#     player_response_string = json_content.get("args", {}).get("player_response")</span></span>
<span class="line"><span class="token comment">#     player_response_json = json.loads(player_response_string)</span></span>
<span class="line"><span class="token comment">#     video_audio_nodes = player_response_json.get('streamingData',{}).get('adaptiveFormats',{})</span></span>
<span class="line"><span class="token comment">#     #Run through the nodes containing bitrates &amp; video urls &amp; formats</span></span>
<span class="line"><span class="token comment">#     def parse_stream_map(blob):</span></span>
<span class="line"><span class="token comment">#         dct = defaultdict(list)</span></span>
<span class="line"><span class="token comment">#         # Split the comma separated videos.</span></span>
<span class="line"><span class="token comment">#         videos = blob.split(",")</span></span>
<span class="line"><span class="token comment">#         # Unquote the characters and split to parameters.</span></span>
<span class="line"><span class="token comment">#         videos = [video.split("&amp;") for video in videos]</span></span>
<span class="line"><span class="token comment">#         # Split at the equals sign so we can break this key value pairs and</span></span>
<span class="line"><span class="token comment">#         # toss it into a dictionary.</span></span>
<span class="line"><span class="token comment">#         for video in videos:</span></span>
<span class="line"><span class="token comment">#             for kv in video:</span></span>
<span class="line"><span class="token comment">#                 key, value = kv.split("=")</span></span>
<span class="line"><span class="token comment">#                 dct[key].append(unquote(value))</span></span>
<span class="line"><span class="token comment">#         return dct</span></span>
<span class="line"><span class="token comment">#     encoded_stream_map = json_content.get("args", {}).get("adaptive_fmts")</span></span>
<span class="line"><span class="token comment">#     adaptive_urls = parse_stream_map(encoded_stream_map)['url']</span></span>
<span class="line"><span class="token comment">#     audio_url = adaptive_urls[-1]</span></span>
<span class="line"><span class="token comment">#     return audio_url</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_audio_url_from_web_url_may_2021</span></span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword keyword-global">global</span> origin_type</span>
<span class="line">    req <span class="token operator">=</span> Request<span class="token punctuation">(</span>url<span class="token punctuation">)</span></span>
<span class="line">    req<span class="token punctuation">.</span>add_header<span class="token punctuation">(</span><span class="token string">'Connection'</span><span class="token punctuation">,</span> <span class="token string">'keep-alive'</span><span class="token punctuation">)</span></span>
<span class="line">    req<span class="token punctuation">.</span>add_header<span class="token punctuation">(</span><span class="token string">'User-Agent'</span><span class="token punctuation">,</span>  <span class="token string">'Mozilla/5.0 (X11; Linux i686; G518Rco3Yp0uLV40Lcc9hAzC1BOROTJADjicLjOmlr4=) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.157 Safari/537.36'</span><span class="token punctuation">)</span></span>
<span class="line">    req<span class="token punctuation">.</span>add_header<span class="token punctuation">(</span><span class="token string">'Accept'</span><span class="token punctuation">,</span> <span class="token string">'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8'</span><span class="token punctuation">)</span></span>
<span class="line">    req<span class="token punctuation">.</span>add_header<span class="token punctuation">(</span><span class="token string">'Accept-Charset'</span><span class="token punctuation">,</span> <span class="token string">'ISO-8859-1,utf-8;q=0.7,*;q=0.3'</span><span class="token punctuation">)</span></span>
<span class="line">    req<span class="token punctuation">.</span>add_header<span class="token punctuation">(</span><span class="token string">'Accept-Language'</span><span class="token punctuation">,</span> <span class="token string">'en-US,en;q=0.8'</span><span class="token punctuation">)</span></span>
<span class="line">    html <span class="token operator">=</span> urlopen<span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> html<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-raise">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"Unable to open url: {0}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        json_start_pattern <span class="token operator">=</span> <span class="token string">"ytplayer.config = "</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">        json_start_pattern <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token string">"ytplayer.config = "</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span></span>
<span class="line">    pattern_idx <span class="token operator">=</span> html<span class="token punctuation">.</span>find<span class="token punctuation">(</span>json_start_pattern<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># In case video is unable to play</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>pattern_idx <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-raise">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"Unable to find start pattern."</span><span class="token punctuation">)</span></span>
<span class="line">    start <span class="token operator">=</span> pattern_idx <span class="token operator">+</span> <span class="token number">18</span></span>
<span class="line">    html <span class="token operator">=</span> html<span class="token punctuation">[</span>start<span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_json_offset</span></span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token triple-quoted-string string">'''called from get_audio_from_web_url. Gets YT Config inside of page, and returns the number offset to slice'''</span></span>
<span class="line">        unmatched_brackets_num <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">        index <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> i<span class="token punctuation">,</span> ch <span class="token keyword keyword-in">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>ch<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">                ch <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> ch <span class="token operator">==</span> <span class="token string">"{"</span><span class="token punctuation">:</span></span>
<span class="line">                unmatched_brackets_num <span class="token operator">+=</span> <span class="token number">1</span></span>
<span class="line">            <span class="token keyword keyword-elif">elif</span> ch <span class="token operator">==</span> <span class="token string">"}"</span><span class="token punctuation">:</span></span>
<span class="line">                unmatched_brackets_num <span class="token operator">-=</span> <span class="token number">1</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> unmatched_brackets_num <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">                    <span class="token keyword keyword-break">break</span></span>
<span class="line">        <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword keyword-raise">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"Unable to determine json offset."</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> index <span class="token operator">+</span> i</span>
<span class="line">    <span class="token comment">#get json offset is to get the starting and last curly braces of beginnign and closing end of config</span></span>
<span class="line">    <span class="token comment">#json offset is a number value for later slicing, where it will turn into JSON by json.loads</span></span>
<span class="line">    offset <span class="token operator">=</span> get_json_offset<span class="token punctuation">(</span>html<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> offset<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-raise">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"Unable to extract json."</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        json_content <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>html<span class="token punctuation">[</span><span class="token punctuation">:</span>offset<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">        json_content <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>html<span class="token punctuation">[</span><span class="token punctuation">:</span>offset<span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    player_response_string <span class="token operator">=</span> json_content<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"args"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"player_response"</span><span class="token punctuation">)</span></span>
<span class="line">    player_response_json <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>player_response_string<span class="token punctuation">)</span></span>
<span class="line">    video_audio_nodes <span class="token operator">=</span> player_response_json<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'streamingData'</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'adaptiveFormats'</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">#Run through the nodes containing bitrates &amp; video urls &amp; formats</span></span>
<span class="line">    <span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">parse_stream_map</span></span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        dct <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># Split the comma separated videos.</span></span>
<span class="line">        videos <span class="token operator">=</span> blob<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># Unquote the characters and split to parameters.</span></span>
<span class="line">        videos <span class="token operator">=</span> <span class="token punctuation">[</span>video<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"&amp;"</span><span class="token punctuation">)</span> <span class="token keyword keyword-for">for</span> video <span class="token keyword keyword-in">in</span> videos<span class="token punctuation">]</span></span>
<span class="line">        <span class="token comment"># Split at the equals sign so we can break this key value pairs and</span></span>
<span class="line">        <span class="token comment"># toss it into a dictionary.</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> video <span class="token keyword keyword-in">in</span> videos<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword keyword-for">for</span> kv <span class="token keyword keyword-in">in</span> video<span class="token punctuation">:</span></span>
<span class="line">                key<span class="token punctuation">,</span> value <span class="token operator">=</span> kv<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span></span>
<span class="line">                dct<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>unquote<span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> dct</span>
<span class="line">    encoded_stream_map <span class="token operator">=</span> json_content<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"args"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"adaptive_fmts"</span><span class="token punctuation">)</span></span>
<span class="line">    adaptive_urls <span class="token operator">=</span> parse_stream_map<span class="token punctuation">(</span>encoded_stream_map<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span></span>
<span class="line">    audio_url <span class="token operator">=</span> adaptive_urls<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> audio_url</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">@smart_speaker_decorator<span class="token punctuation">(</span><span class="token string">'audio'</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">lambda_handler</span></span><span class="token punctuation">(</span>event<span class="token punctuation">,</span>context<span class="token punctuation">,</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment">#return "GOON"</span></span>
<span class="line">    <span class="token comment"># return {"audio_url":"DEBUG","text_speech":"DEBUG"}</span></span>
<span class="line">    intent <span class="token operator">=</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"intent"</span><span class="token punctuation">,</span><span class="token string">"Unknown"</span><span class="token punctuation">)</span></span>
<span class="line">    choice <span class="token operator">=</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"choice"</span><span class="token punctuation">,</span><span class="token string">"Unknown"</span><span class="token punctuation">)</span></span>
<span class="line">    original_choice <span class="token operator">=</span> choice</span>
<span class="line">    developer_key <span class="token operator">=</span> <span class="token string">'AIzaSyBzh1miCVEe0jOOWrmLEjc-An8NWIb7IDc'</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">#choice (for YouTube music)</span></span>
<span class="line">    choice <span class="token operator">=</span> choice<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    choice <span class="token operator">=</span> choice<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'music'</span><span class="token punctuation">,</span><span class="token string">'topic'</span><span class="token punctuation">)</span></span>
<span class="line">    list_video_url <span class="token operator">=</span> <span class="token string">'https://www.googleapis.com/youtube/v3/search?q='</span><span class="token operator">+</span>urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>quote<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>choice<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'&amp;part=id,snippet&amp;maxResults=20&amp;type=video&amp;key='</span> <span class="token operator">+</span> developer_key</span>
<span class="line">        <span class="token comment">#parameters intent because I dont' want to write new intents beyond the simple fallback</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> intent <span class="token operator">==</span> <span class="token string">'youtube.parameters'</span><span class="token punctuation">:</span></span>
<span class="line">        time_choice <span class="token operator">=</span> get_parameter<span class="token punctuation">(</span>request_json<span class="token punctuation">,</span><span class="token string">'time_range'</span><span class="token punctuation">)</span></span>
<span class="line">        time_days <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"today"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"day"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"week"</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">"month"</span><span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token string">"year"</span><span class="token punctuation">:</span><span class="token number">365</span><span class="token punctuation">}</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span>time_choice<span class="token punctuation">,</span><span class="token number">365</span><span class="token punctuation">)</span></span>
<span class="line">        date_begin_string <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%dT%H:%M:%SZ'</span><span class="token punctuation">,</span>time<span class="token punctuation">.</span>gmtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token builtin">int</span><span class="token punctuation">(</span>time_days<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment">#duration is only in youtube.parameters for now</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> get_parameter<span class="token punctuation">(</span>request_json<span class="token punctuation">,</span><span class="token string">'duration'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'long'</span><span class="token punctuation">:</span></span>
<span class="line">            list_video_url <span class="token operator">=</span> list_video_url <span class="token operator">+</span> <span class="token string">'&amp;videoDuration=long'</span></span>
<span class="line">        list_video_url <span class="token operator">=</span> list_video_url <span class="token operator">+</span> <span class="token string">"&amp;publishedAfter="</span> <span class="token operator">+</span> date_begin_string</span>
<span class="line">    <span class="token comment">#read url</span></span>
<span class="line">    results <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>list_video_url<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    title_id_nodes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword keyword-for">for</span> list_node <span class="token keyword keyword-in">in</span> results<span class="token punctuation">[</span><span class="token string">'items'</span><span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="line">        video_id <span class="token operator">=</span> list_node<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'videoId'</span><span class="token punctuation">]</span></span>
<span class="line">        title <span class="token operator">=</span> list_node<span class="token punctuation">[</span><span class="token string">'snippet'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span></span>
<span class="line">        title_id_nodes<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>video_id<span class="token punctuation">,</span>title<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">#FIRST [0] IS THE FIRST RESULT THAT CAME UP (change if expanding for future results)</span></span>
<span class="line">    <span class="token comment">#SECOND [0] IS THE VIDEO ID IN ACCORDANCE TO THE TUPLE ABOVE</span></span>
<span class="line">    video_id <span class="token operator">=</span> title_id_nodes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token comment">#FINISHED DOING ALL THE WORK TO GET VIDEO ID</span></span>
<span class="line">    <span class="token comment">#</span></span>
<span class="line">    <span class="token comment">#ALL OF THE FOLLOWING JUST TO GET THE DURATION</span></span>
<span class="line">    get_first_duration_match <span class="token operator">=</span> <span class="token keyword keyword-lambda">lambda</span> <span class="token builtin">list</span><span class="token punctuation">,</span>index<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token keyword keyword-if">if</span> index <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token keyword keyword-else">else</span> <span class="token number">0</span></span>
<span class="line">    <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">        video_info_url <span class="token operator">=</span> <span class="token string">'https://www.googleapis.com/youtube/v3/videos?id='</span> <span class="token operator">+</span> video_id <span class="token operator">+</span> <span class="token string">'&amp;part=contentDetails&amp;type=video&amp;key='</span> <span class="token operator">+</span> developer_key </span>
<span class="line">        results <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>video_info_url<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        duration_result <span class="token operator">=</span> results<span class="token punctuation">[</span><span class="token string">'items'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'contentDetails'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'duration'</span><span class="token punctuation">]</span></span>
<span class="line">        hours <span class="token operator">=</span> get_first_duration_match<span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'(\d*)H'</span><span class="token punctuation">,</span>duration_result<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        minutes <span class="token operator">=</span> get_first_duration_match<span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'(\d*)M'</span><span class="token punctuation">,</span>duration_result<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        seconds <span class="token operator">=</span> get_first_duration_match<span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'(\d*)S'</span><span class="token punctuation">,</span>duration_result<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-except">except</span><span class="token punctuation">:</span></span>
<span class="line">        duration <span class="token operator">=</span> <span class="token string">"Unknown"</span></span>
<span class="line">    duration <span class="token operator">=</span> <span class="token string">''</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>hours<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></span>
<span class="line">        duration <span class="token operator">+=</span> <span class="token string">"{} hour "</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>hours<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> <span class="token builtin">int</span><span class="token punctuation">(</span>hours<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span></span>
<span class="line">        duration <span class="token operator">+=</span> <span class="token string">"{} hours "</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>hours<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>minutes<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></span>
<span class="line">        duration <span class="token operator">+=</span> <span class="token string">"{} minute "</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>minutes<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-elif">elif</span> <span class="token builtin">int</span><span class="token punctuation">(</span>minutes<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span></span>
<span class="line">        duration <span class="token operator">+=</span> <span class="token string">"{} minutes "</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>minutes<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> duration <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">:</span></span>
<span class="line">        duration <span class="token operator">=</span> <span class="token string">"Unknown Time"</span></span>
<span class="line">    duration <span class="token operator">=</span> duration<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">#END DURATION</span></span>
<span class="line">    video_url <span class="token operator">=</span> <span class="token string">'https://www.youtube.com/watch?v='</span> <span class="token operator">+</span> video_id</span>
<span class="line">    audio_url <span class="token operator">=</span> get_audio_url_from_web_url_may_2021<span class="token punctuation">(</span>video_url<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">#START DYNAMODB</span></span>
<span class="line">    current_location <span class="token operator">=</span> get_current_location<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> current_location <span class="token operator">==</span> <span class="token string">'windows'</span> <span class="token keyword keyword-and">and</span> <span class="token boolean">True</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span></span>
<span class="line">            dynamodb <span class="token operator">=</span> boto3<span class="token punctuation">.</span>resource<span class="token punctuation">(</span><span class="token string">'dynamodb'</span><span class="token punctuation">,</span><span class="token string">'us-east-1'</span><span class="token punctuation">)</span></span>
<span class="line">            table <span class="token operator">=</span> dynamodb<span class="token punctuation">.</span>Table<span class="token punctuation">(</span><span class="token string">'audio_api_queries'</span><span class="token punctuation">)</span></span>
<span class="line">            results <span class="token operator">=</span> table<span class="token punctuation">.</span>put_item<span class="token punctuation">(</span></span>
<span class="line">                Item<span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">                    <span class="token string">'time'</span><span class="token punctuation">:</span><span class="token builtin">int</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                    <span class="token string">'ip_address'</span><span class="token punctuation">:</span> <span class="token string">'44.55.66.77'</span><span class="token punctuation">,</span></span>
<span class="line">                    <span class="token string">'query'</span><span class="token punctuation">:</span> choice</span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-except">except</span> ClientError<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword keyword-pass">pass</span></span>
<span class="line">    <span class="token comment">#END DYNAMODB</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token punctuation">{</span><span class="token string">"audio_url"</span><span class="token punctuation">:</span>audio_url<span class="token punctuation">,</span><span class="token string">"text_speech"</span><span class="token punctuation">:</span>original_choice <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> duration<span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">    </span>
<span class="line"><span class="token keyword keyword-if">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span></span>
<span class="line">    google_request <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"body"</span><span class="token punctuation">:</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"responseId"</span><span class="token punctuation">:</span> <span class="token string">"984cfbb7-35b2-4e64-bfe1-981dd6c01fce"</span><span class="token punctuation">,</span> <span class="token string">"queryResult"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"queryText"</span><span class="token punctuation">:</span> <span class="token string">"hybrid 2 aew theme"</span><span class="token punctuation">,</span> <span class="token string">"parameters"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"number"</span><span class="token punctuation">:</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token string">"choice"</span><span class="token punctuation">:</span> <span class="token string">"awesome kong 8 million aew theme"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"allRequiredParamsPresent"</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">"fulfillmentMessages"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"text"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"text"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"intent"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"projects/read-agent/agent/intents/1f250750-1ebd-4f91-ad8d-c31461289c82"</span><span class="token punctuation">,</span> <span class="token string">"displayName"</span><span class="token punctuation">:</span> <span class="token string">"add_two"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"intentDetectionConfidence"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"languageCode"</span><span class="token punctuation">:</span> <span class="token string">"en"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"originalDetectIntentRequest"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">"payload"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"session"</span><span class="token punctuation">:</span> <span class="token string">"projects/read-agent/agent/sessions/a5e1dd4a-39aa-57fe-78c6-46dc1e7a8799"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
<span class="line">    amazon_request <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'version'</span><span class="token punctuation">:</span> <span class="token string">'1.0'</span><span class="token punctuation">,</span> <span class="token string">'session'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'new'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'sessionId'</span><span class="token punctuation">:</span> <span class="token string">'amzn1.echo-api.session.0b502c38-74cb-4d86-aed0-668297fa7851'</span><span class="token punctuation">,</span> <span class="token string">'application'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'applicationId'</span><span class="token punctuation">:</span> <span class="token string">'amzn1.ask.skill.6bcca7d1-6fc6-406d-af8a-042948edde49'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'user'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'userId'</span><span class="token punctuation">:</span> <span class="token string">'amzn1.ask.account.AGONDUNEBOGQACH2DYQOEAHKHAIYYQZKKMBQNLEGHN6ERTMYBOQLZZXVAV54GCGDTM6GU4AEVT6SH6JIBLBLQXHYWMKSZJCA4TZMHVZ2FV36NZBHOWB5EMO3R5UETE5PVDOCYPE7AF4KQ54IGKNJDOJ7ONPHXGK2facebookMTELZMUDYE4YOJQVIWMHJULABS6CIVVJTBCTUE2ZKPTLKJY'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'context'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'AudioPlayer'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'playerActivity'</span><span class="token punctuation">:</span> <span class="token string">'IDLE'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'System'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'application'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'applicationId'</span><span class="token punctuation">:</span> <span class="token string">'amzn1.ask.skill.6bcca7d1-6fc6-406d-af8a-042948edde49'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'user'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'userId'</span><span class="token punctuation">:</span> <span class="token string">'amzn1.ask.account.AGONDUNEBOGQACH2DYQOEAHKHAIYYQZKKMBQNLEGHN6ERTMYBOQLZZXVAV54GCGDTM6GU4AEVT6SH6JIBLBLQXHYWMKSZJCA4TZMHVZ2FV36NZBHOWB5EMO3R5UETE5PVDOCYPE7AF4KQ54IGKNJDOJ7ONPHXGK2MTELZMUDYE4YOJQVIWMHJULABS6CIVVJTBCTUE2ZKPTLKJY'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'device'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'deviceId'</span><span class="token punctuation">:</span> <span class="token string">'amzn1.ask.device.AH3UWTZBQPA4AUHMYSTKPZWUWUHU6GS7HPCK42P64W6ENUBBWJRRFY4E4WP2IN2DPJE4WPBQMNBFO2K2W6GTQPVI4QOOIWMG2I7P62YJVOIEJL5FX6KOSJ2R7L2P25XGBGMWZ2FPX54WUL3GDXE3IUUDYG72AK4LLVZH2O5LDCX2EGKFB3RAS'</span><span class="token punctuation">,</span> <span class="token string">'supportedInterfaces'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'AudioPlayer'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'apiEndpoint'</span><span class="token punctuation">:</span> <span class="token string">'https://api.amazonalexa.com'</span><span class="token punctuation">,</span> <span class="token string">'apiAccessToken'</span><span class="token punctuation">:</span> <span class="token string">'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJhdWQiOiJodHRwczovL2FwaS5hbWF6b25hbGV4YS5jb20iLCJpc3MiOiJBbGV4YVNraWxsS2l0Iiwic3ViIjoiYW16bjEuYXNrLnNraWxsLjZiY2NhN2QxLTZmYzYtNDA2ZC1hZjhhLTA0Mjk0OGVkZGU0OSIsImV4cCI6MTU0NTg5MzM4OCwiaWF0IjoxNTQ1ODg5Nzg4LCJuYmYiOjE1NDU4ODk3ODgsInByaXZhdGVDbGFpbXMiOnsiY29uc2VudFRva2VuIjpudWxsLCJkZXZpY2VJZCI6ImFtem4xLmFzay5kZXZpY2UuQUgzVVdUWkJRUEE0QVVITVlTVEtQWldVV1VIVTZHUzdIUENLNDJQNjRXNkVOVUJCV0pSUkZZNEU0V1AySU4yRFBKRTRXUEJRTU5CRk8ySzJXNkdUUVBWSTRRT09JV01HMkk3UDYyWUpWT0lFSkw1Rlg2S09TSjJSN0wyUDI1WEdCR01XWjJGUFg1NFdVTDNHRFhFM0lVVURZRzcyQUs0TExWWkgyTzVMRENYMkVHS0ZCM1JBUyIsInVzZXJJZCI6ImFtem4xLmFzay5hY2NvdW50LkFHT05EVU5FQk9HUUFDSDJEWVFPRUFIS0hBSVlZUVpLS01CUU5MRUdITjZFUlRNWUJPUUxaWlhWQVY1NEdDR0RUTTZHVTRBRVZUNlNINkpJQkxCTFFYSFlXTUtTWkpDQTRUWk1IVloyRlYzNk5aQkhPV0I1RU1PM1I1VUVURTVQVkRPQ1lQRTdBRjRLUTU0SUdLTkpET0o3T05QSFhHSzJNVEVMWk1VRFlFNFlPSlFWSVdNSEpVTEFCUzZDSVZWSlRCQ1RVRTJaS1BUTEtKWSJ9fQ.PY4fLtwlu7c21PaMgxo8yWlsgsNLtMEnEGpNbKMUKxxTCRAwxUvJi83dtXXek6tN85njP0IYA_MiUTpsxcKuatO_pzW1fUHCNt51Uomn5UIlVUDQ1swCZppEq5c2zL05faBDJcOVr2OZFd3-QHG-m-7q2N8gIByTjgaRomy7duFhyWF0EApDT010Hj1xipePPNwZyfErQFVvyHzw508NtNDHttfOGI0taH-FTFfRPeIytzoRD0ZV_JRiYI61yyX00LTLdMzUc9EAGjXEIxDumcdpkEoLBSQVtuY5kvXPcubuu9X5I58m7tNFmJvNhTUKaP7DZFAlh_9WVzwvFwp-lg'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'Viewport'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'experiences'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">'arcMinuteWidth'</span><span class="token punctuation">:</span> <span class="token number">246</span><span class="token punctuation">,</span> <span class="token string">'arcMinuteHeight'</span><span class="token punctuation">:</span> <span class="token number">144</span><span class="token punctuation">,</span> <span class="token string">'canRotate'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'canResize'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'shape'</span><span class="token punctuation">:</span> <span class="token string">'RECTANGLE'</span><span class="token punctuation">,</span> <span class="token string">'pixelWidth'</span><span class="token punctuation">:</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token string">'pixelHeight'</span><span class="token punctuation">:</span> <span class="token number">600</span><span class="token punctuation">,</span> <span class="token string">'dpi'</span><span class="token punctuation">:</span> <span class="token number">160</span><span class="token punctuation">,</span> <span class="token string">'currentPixelWidth'</span><span class="token punctuation">:</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token string">'currentPixelHeight'</span><span class="token punctuation">:</span> <span class="token number">600</span><span class="token punctuation">,</span> <span class="token string">'touch'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'SINGLE'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'request'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token string">'IntentRequest'</span><span class="token punctuation">,</span> <span class="token string">'requestId'</span><span class="token punctuation">:</span> <span class="token string">'amzn1.echo-api.request.3b6a1e41-adf0-437e-8416-5779dc4b7131'</span><span class="token punctuation">,</span> <span class="token string">'timestamp'</span><span class="token punctuation">:</span> <span class="token string">'2018-12-27T05:49:48Z'</span><span class="token punctuation">,</span> <span class="token string">'locale'</span><span class="token punctuation">:</span> <span class="token string">'en-US'</span><span class="token punctuation">,</span> <span class="token string">'intent'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'hear_audio'</span><span class="token punctuation">,</span> <span class="token string">'confirmationStatus'</span><span class="token punctuation">:</span> <span class="token string">'NONE'</span><span class="token punctuation">,</span> <span class="token string">'slots'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'choice'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'any'</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'michael jackson thriller topic'</span><span class="token punctuation">,</span> <span class="token string">'confirmationStatus'</span><span class="token punctuation">:</span> <span class="token string">'NONE'</span><span class="token punctuation">,</span> <span class="token string">'source'</span><span class="token punctuation">:</span> <span class="token string">'USER'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">    http_request <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'headers'</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token string">'Host'</span><span class="token punctuation">:</span><span class="token string">'jo2yo0xn52.execute-api.us-east-1.amazonaws.com'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>lambda_handler<span class="token punctuation">(</span>google_request<span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Extract audio URL from YouTube</div>
                <div class="description">Extracts audio URLs from YouTube for Alexa skills.</div>
                <div class="languages">Python</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-python" tabindex="0">                <code class="language-python"><span class="line"><span class="token keyword keyword-import">import</span> json</span>
<span class="line"><span class="token keyword keyword-import">import</span> urllib<span class="token punctuation">.</span>request</span>
<span class="line"><span class="token keyword keyword-import">import</span> re</span>
<span class="line"><span class="token keyword keyword-from">from</span> pprint <span class="token keyword keyword-import">import</span> pprint</span>
<span class="line"><span class="token keyword keyword-from">from</span> collections <span class="token keyword keyword-import">import</span> defaultdict</span>
<span class="line"><span class="token keyword keyword-from">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword keyword-import">import</span> unquote</span>
<span class="line"><span class="token keyword keyword-import">import</span> urllib</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">lambda_handler</span></span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># if (event["session"]["application"]["applicationId"] != "amzn1.ask.skill.17266258-eecf-42a5-a328-b235199a76ef"):</span></span>
<span class="line">    <span class="token comment">#     raise ValueError("Invalid Application ID")</span></span>
<span class="line">    yt_url <span class="token operator">=</span> <span class="token string">'https://www.youtube.com/watch?v=g4NhYg_oOk0'</span></span>
<span class="line">    url <span class="token operator">=</span> get_audio_url_from_web_url<span class="token punctuation">(</span>yt_url<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_json_offset</span></span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    unmatched_brackets_num <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">    index <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line">    <span class="token keyword keyword-for">for</span> i<span class="token punctuation">,</span> ch <span class="token keyword keyword-in">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>ch<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            ch <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> ch <span class="token operator">==</span> <span class="token string">"{"</span><span class="token punctuation">:</span></span>
<span class="line">            unmatched_brackets_num <span class="token operator">+=</span> <span class="token number">1</span></span>
<span class="line">        <span class="token keyword keyword-elif">elif</span> ch <span class="token operator">==</span> <span class="token string">"}"</span><span class="token punctuation">:</span></span>
<span class="line">            unmatched_brackets_num <span class="token operator">-=</span> <span class="token number">1</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> unmatched_brackets_num <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword keyword-break">break</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-raise">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"Unable to determine json offset."</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> index <span class="token operator">+</span> i</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_audio_url_from_web_url</span></span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    response <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>url<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> response<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-raise">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"Unable to open url: {0}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    html <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        restriction_pattern <span class="token operator">=</span> <span class="token string">"og:restrictions:age"</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">        restriction_pattern <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token string">"og:restrictions:age"</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> restriction_pattern <span class="token keyword keyword-in">in</span> html<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-raise">raise</span> AgeRestricted<span class="token punctuation">(</span><span class="token string">"Age restricted video. Unable to download "</span></span>
<span class="line">            <span class="token string">"without being signed in."</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        json_start_pattern <span class="token operator">=</span> <span class="token string">"ytplayer.config = "</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">        json_start_pattern <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token string">"ytplayer.config = "</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span></span>
<span class="line">    pattern_idx <span class="token operator">=</span> html<span class="token punctuation">.</span>find<span class="token punctuation">(</span>json_start_pattern<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># In case video is unable to play</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>pattern_idx <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-raise">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"Unable to find start pattern."</span><span class="token punctuation">)</span></span>
<span class="line">    start <span class="token operator">=</span> pattern_idx <span class="token operator">+</span> <span class="token number">18</span></span>
<span class="line">    html <span class="token operator">=</span> html<span class="token punctuation">[</span>start<span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token comment">#get json offset is to get the starting and last curly braces of beginnign and closing end of config</span></span>
<span class="line">    <span class="token comment">#json offset is a number value for later slicing, where it will turn into JSON by json.loads</span></span>
<span class="line">    offset <span class="token operator">=</span> get_json_offset<span class="token punctuation">(</span>html<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> offset<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword keyword-raise">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"Unable to extract json."</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        json_content <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>html<span class="token punctuation">[</span><span class="token punctuation">:</span>offset<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span></span>
<span class="line">        json_content <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>html<span class="token punctuation">[</span><span class="token punctuation">:</span>offset<span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    player_response_string <span class="token operator">=</span> json_content<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"args"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"player_response"</span><span class="token punctuation">)</span></span>
<span class="line">    player_response_json <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>player_response_string<span class="token punctuation">)</span></span>
<span class="line">    video_audio_nodes <span class="token operator">=</span> player_response_json<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'streamingData'</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'adaptiveFormats'</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">#Run through the nodes containing bitrates &amp; video urls &amp; formats</span></span>
<span class="line">    audio_nodes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword keyword-for">for</span> video_audio_node <span class="token keyword keyword-in">in</span> video_audio_nodes<span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment">#only get those with audio</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token string">'audio'</span> <span class="token keyword keyword-in">in</span> video_audio_node<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"mimeType"</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            audio_url <span class="token operator">=</span> video_audio_node<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">            quality <span class="token operator">=</span> video_audio_node<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'quality'</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">            content_length <span class="token operator">=</span> video_audio_node<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'contentLength'</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">            mime_type <span class="token operator">=</span> video_audio_node<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"mimeType"</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token comment">#append tuple</span></span>
<span class="line">            audio_nodes<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>content_length<span class="token punctuation">,</span>audio_url<span class="token punctuation">,</span>mime_type<span class="token punctuation">,</span>quality<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">#in a list of tuples, the first value in the tuple would be sorted in the list</span></span>
<span class="line">    <span class="token comment">#size of file (lowest) will be first up to the largest files</span></span>
<span class="line">    audio_nodes<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">#the first [1] means second most smallest</span></span>
<span class="line">    <span class="token comment">#the second [1] is the audio_url as specified in the append function above by virtue of it's placement</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> audio_nodes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">build_response</span></span><span class="token punctuation">(</span>audio_file<span class="token punctuation">,</span> should_end_session<span class="token punctuation">)</span><span class="token punctuation">:</span>  </span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">"response"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token string">"directives"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span></span>
<span class="line">                <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"AudioPlayer.Play"</span><span class="token punctuation">,</span></span>
<span class="line">                    <span class="token string">"playBehavior"</span><span class="token punctuation">:</span> <span class="token string">"REPLACE_ALL"</span><span class="token punctuation">,</span></span>
<span class="line">                    <span class="token string">"audioItem"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token string">"stream"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                            <span class="token string">"token"</span><span class="token punctuation">:</span> <span class="token string">"12345"</span><span class="token punctuation">,</span></span>
<span class="line">                            <span class="token string">"url"</span><span class="token punctuation">:</span> audio_file<span class="token punctuation">,</span></span>
<span class="line">                            <span class="token string">"offsetInMilliseconds"</span><span class="token punctuation">:</span> <span class="token number">0</span></span>
<span class="line">                        <span class="token punctuation">}</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">"shouldEndSession"</span><span class="token punctuation">:</span> <span class="token boolean">True</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">get_url_by_choice</span></span><span class="token punctuation">(</span>choice<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment">#search query list</span></span>
<span class="line">    url <span class="token operator">=</span> <span class="token string">'https://www.googleapis.com/youtube/v3/search?q='</span><span class="token operator">+</span>choice<span class="token operator">+</span><span class="token string">'&amp;part=id,snippet&amp;type=video&amp;key=AIzaSyAdRNXjk5yVbUzalf-vh0qrF5VJHvwyFP4'</span><span class="token punctuation">;</span></span>
<span class="line">    results <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword keyword-for">for</span> list_node <span class="token keyword keyword-in">in</span> results<span class="token punctuation">[</span><span class="token string">'items'</span><span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="line">        video_id <span class="token operator">=</span> list_node<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'videoId'</span><span class="token punctuation">]</span></span>
<span class="line">        title <span class="token operator">=</span> list_node<span class="token punctuation">[</span><span class="token string">'snippet'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span>video_id<span class="token punctuation">)</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-if">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span></span>
<span class="line">    choice <span class="token operator">=</span> <span class="token string">"history"</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token comment"># yt_url = 'https://www.youtube.com/watch?v=aRAQ-bNs32s'</span></span>
<span class="line">    <span class="token comment"># audio_url = get_audio_url_from_web_url(yt_url)</span></span>
<span class="line">    <span class="token comment"># </span></span>
<span class="line">    get_url_by_choice<span class="token punctuation">(</span>choice<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Nimli</div>
                <div class="description">Imports 40000 items to the Nimli Magento Store from the boss's CSV, including configurable products.</div>
                <div class="languages">PHP</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-php" tabindex="0">                <code class="language-php"><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token function">set_include_path</span><span class="token punctuation">(</span><span class="token function">get_include_path</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'C:/makeshift/files/saffron'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-require_once">require_once</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"/app/Mage.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//to do Magento Library functions</span></span>
<span class="line"><span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token variable">$prodauct</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/product'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//$helper_data = Mage::helper('custom/data');</span></span>
<span class="line"><span class="token variable">$collection</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/product'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span></span>
<span class="line">    <span class="token function">addAttributeToSelect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'*'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">addAttributeToFilter</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'brand'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Trimark'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$category_model</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/category'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//foreach($collection as $h){echo $h-&gt;getName();}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">////////////////////////////////////////</span></span>
<span class="line"><span class="token comment">///FUNCTION FOR SETTING OPTIONS FOR A PRODUCT (LIKE ECO ATTRIBUTE OR COLOR)</span></span>
<span class="line"><span class="token comment">////////////////////////////////////////</span></span>
<span class="line"><span class="token variable">$options_array</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">get_magento_option_ids</span><span class="token punctuation">(</span><span class="token variable">$attribute_name</span><span class="token punctuation">,</span> <span class="token variable">$option_names</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$options_array</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"options_array"</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//this array grows over time</span></span>
<span class="line">    <span class="token variable">$attribute_name</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$attribute_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword keyword-isset">isset</span><span class="token punctuation">(</span><span class="token variable">$options_array</span><span class="token punctuation">[</span><span class="token variable">$attribute_name</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment">//fill up array with new attribute &amp; options (done to not redeclare model class every single row, which is memory intensive)</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token variable">$attribute_name</span> <span class="token operator">==</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token variable">$attribute_name</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'attribute'</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span> <span class="token comment">//only done for that one category with no attribute name but had values</span></span>
<span class="line">        <span class="token variable">$attribute</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/resource_eav_attribute'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">loadByCode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog_product'</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$attribute_name</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token variable">$options</span> <span class="token operator">=</span> <span class="token variable">$attribute</span><span class="token operator">-&gt;</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getAllOptions</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$options</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$array</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token variable">$options_array</span><span class="token punctuation">[</span><span class="token variable">$attribute_name</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$array</span><span class="token punctuation">[</span>label<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$array</span><span class="token punctuation">[</span>value<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">///GET VALUES FROM ARRAY ABOVE</span></span>
<span class="line">    <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$option_names</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$option_name</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$values</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$options_array</span><span class="token punctuation">[</span><span class="token variable">$attribute_name</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token function">fix_name</span><span class="token punctuation">(</span><span class="token variable">$attribute_name</span><span class="token punctuation">,</span> <span class="token variable">$option_name</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token variable">$string</span> <span class="token operator">=</span> <span class="token function">implode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">','</span><span class="token punctuation">,</span> <span class="token function">array_values</span><span class="token punctuation">(</span><span class="token variable">$values</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token variable">$string</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">fix_name</span><span class="token punctuation">(</span><span class="token variable">$attribute_name</span><span class="token punctuation">,</span> <span class="token variable">$option_name</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token variable">$attribute_name</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'eco_attribute'</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">substr_count</span><span class="token punctuation">(</span><span class="token variable">$option_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'nottested'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token string single-quoted-string">'Not Tested On Animals'</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">substr_count</span><span class="token punctuation">(</span><span class="token variable">$option_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'usa'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token string single-quoted-string">'Made In Usa'</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">substr_count</span><span class="token punctuation">(</span><span class="token variable">$option_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'organic'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token string single-quoted-string">'Organic'</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">substr_count</span><span class="token punctuation">(</span><span class="token variable">$option_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'sustainable'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token string single-quoted-string">'Sustainable'</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">substr_count</span><span class="token punctuation">(</span><span class="token variable">$option_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'fairly'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token string single-quoted-string">'Fairly Traded'</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">substr_count</span><span class="token punctuation">(</span><span class="token variable">$option_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'natural'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token string single-quoted-string">'Natural'</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">substr_count</span><span class="token punctuation">(</span><span class="token variable">$option_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'handmade'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token string single-quoted-string">'Handmade'</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">substr_count</span><span class="token punctuation">(</span><span class="token variable">$option_name</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Caf'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-return">return</span> <span class="token string double-quoted-string">"Caf"</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token variable">$option_name</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"e"</span><span class="token punctuation">,</span> <span class="token variable">$option_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token variable">$option_name</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">//////////////////////////////////</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">/////////////////////</span></span>
<span class="line"><span class="token comment">///CONNECT TO DATABASE AND MAKE QUERY</span></span>
<span class="line"><span class="token comment">//////////////////////</span></span>
<span class="line"><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token function">mysql_connect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">mysql_select_db</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'puck'</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM item"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">//////////////////////////</span></span>
<span class="line"><span class="token comment">//GET PRICES</span></span>
<span class="line"><span class="token comment">//////////////////////////</span></span>
<span class="line"><span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"Making Array For Prices....\n"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$price_result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT itemcode, price FROM keycodeitemprice k"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$price_array</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token variable">$price_row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_row</span><span class="token punctuation">(</span><span class="token variable">$price_result</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$price_array</span><span class="token punctuation">[</span><span class="token variable">$price_row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$price_row</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">////////////////////////////</span></span>
<span class="line"><span class="token comment">//GET CATEGORIES</span></span>
<span class="line"><span class="token comment">////////////////////////////</span></span>
<span class="line"><span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"Making Array For Categories....\n"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$category_collection</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/category'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span></span>
<span class="line">    <span class="token function">addAttributeToSelect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'omx_category_id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$category_omx_id_array</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$category_collection</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$category</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$category_omx_id_array</span><span class="token punctuation">[</span><span class="token function">strval</span><span class="token punctuation">(</span><span class="token variable">$category</span><span class="token operator">-&gt;</span><span class="token function">getomx_category_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$category</span><span class="token operator">-&gt;</span></span>
<span class="line">        <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token variable">$category_result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT itemcode, catid FROM itemcategory"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$category_array</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token variable">$category_row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_row</span><span class="token punctuation">(</span><span class="token variable">$category_result</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$magento_category_id</span> <span class="token operator">=</span> <span class="token variable">$category_omx_id_array</span><span class="token punctuation">[</span><span class="token variable">$category_row</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token variable">$magento_category_id</span> <span class="token operator">!=</span> <span class="token constant">null</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$category_array</span><span class="token punctuation">[</span><span class="token variable">$category_row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">.=</span> <span class="token variable">$category_omx_id_array</span><span class="token punctuation">[</span><span class="token variable">$category_row</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">.</span></span>
<span class="line">            <span class="token string single-quoted-string">','</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">////////////////////////////////////</span></span>
<span class="line"><span class="token comment">//GET CONFIGURABLE ATTRIBUTES</span></span>
<span class="line"><span class="token comment">////////////////////////////////////</span></span>
<span class="line"><span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"Making Array For Attributes.....\n"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$product_entity_id</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'eav/config'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getEntityType</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog_product'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span></span>
<span class="line">    <span class="token function">getEntityTypeId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$attributes_with_options</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getResourceModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'eav/entity_attribute_collection'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span></span>
<span class="line">    <span class="token function">setEntityTypeFilter</span><span class="token punctuation">(</span><span class="token variable">$product_entity_id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$attribute_array</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$attributes_with_options</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$attribute_with_options</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$attribute_array</span><span class="token punctuation">[</span><span class="token variable">$attribute_with_options</span><span class="token operator">-&gt;</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$attribute_with_options</span><span class="token operator">-&gt;</span></span>
<span class="line">        <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">/////////////////////////////////////////////</span></span>
<span class="line"><span class="token comment">//ATTRIBUTE SET ID's</span></span>
<span class="line"><span class="token comment">////////////////////////////////////////</span></span>
<span class="line"><span class="token variable">$attribute_set_collection</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getResourceModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'eav/entity_attribute_set_collection'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$attribute_set_collection</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$attribute_set</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$attribute_set_array</span><span class="token punctuation">[</span><span class="token variable">$attribute_set</span><span class="token operator">-&gt;</span><span class="token function">getAttributeSetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$attribute_set</span><span class="token operator">-&gt;</span></span>
<span class="line">        <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token function">var_export</span><span class="token punctuation">(</span><span class="token variable">$attribute_set_array</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">////////////////////////////////////</span></span>
<span class="line"><span class="token comment">//GET ATTRIBUTES FROM ITEM ATTRIBUTES BACKUP TABLE (brand, search, materialandfabric, etc)</span></span>
<span class="line"><span class="token comment">////////////////////////////////////</span></span>
<span class="line"><span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"Making Array from Item Attribute backup table...\n"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$item_attribute_sql</span> <span class="token operator">=</span></span>
<span class="line">    <span class="token string double-quoted-string">"SELECT ItemCode, AttributeValue8 as Brand, AttributeValue7 as SearchTerm, AttributeValue16 as FulfillmentLatency,</span>
<span class="line">AttributeValue18 as SmallImageUrl, AttributeValue19 as MainImageUrl, AttributeValue20 as Alternate1ImageUrl,</span>
<span class="line">AttributeValue21 as Alternate2ImageUrl, AttributeValue22 as Alternate3ImageUrl, AttributeValue23 as Alternate4ImageUrl,</span>
<span class="line">AttributeValue24 as Alternate5ImageUrl, AttributeValue25 as Alternate6ImageUrl,</span>
<span class="line">AttributeValue42 as MaterialAndFabric, AttributeValue48 as SwatchImageUrl</span>
<span class="line">FROM itemattribute"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$item_attribute_result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$item_attribute_sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$item_attribute_array</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token variable">$item_attribute_row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_assoc</span><span class="token punctuation">(</span><span class="token variable">$item_attribute_result</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$item_attribute_array</span><span class="token punctuation">[</span><span class="token variable">$item_attribute_row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$item_attribute_row</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">////////////</span></span>
<span class="line"><span class="token comment">///SKIPPING OVER ITEMS THAT ARE ALREADY IN THE SCARVES STORE</span></span>
<span class="line"><span class="token comment">////////////</span></span>
<span class="line"><span class="token variable">$existing_item_codes</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/product'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span></span>
<span class="line">    <span class="token function">getColumnValues</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'sku'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token variable">$app</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_assoc</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	<span class="token comment">//if product already exists in magento store, skip and move on to next product</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$existing_item_codes</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token punctuation">{</span></span>
<span class="line">		<span class="token keyword keyword-continue">continue</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">	</span>
<span class="line">	<span class="token comment">//timer</span></span>
<span class="line">	<span class="token variable">$start</span> <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	</span>
<span class="line">	<span class="token comment">//variables</span></span>
<span class="line">	<span class="token variable">$item_code</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$type_id</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HasChildren'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string single-quoted-string">'simple'</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">'configurable'</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$surcharge</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SizeSurcharge'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ColorSurcharge'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'StyleSurcharge'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$status</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ProductStatus'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$visibility</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HasChildren'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$visibility</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HasChildren'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token keyword keyword-empty">empty</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ParentItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token punctuation">:</span> <span class="token variable">$visibility</span><span class="token punctuation">;</span> </span>
<span class="line">	</span>
<span class="line">	</span>
<span class="line">	<span class="token comment">//fill values of product</span></span>
<span class="line">    <span class="token variable">$product</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/product'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setWebsiteIds</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setSku</span><span class="token punctuation">(</span><span class="token variable">$item_code</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token variable">$price_array</span><span class="token punctuation">[</span><span class="token variable">$item_code</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token variable">$surcharge</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setAttributeSetId</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setTypeId</span><span class="token punctuation">(</span><span class="token variable">$type_id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ProductName'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setDescription</span><span class="token punctuation">(</span><span class="token function">strip_tags</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'InfoTextHTML'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setShortDescription</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Nimli'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token variable">$status</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setMetaKeyword</span><span class="token punctuation">(</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"|"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">","</span><span class="token punctuation">,</span> <span class="token variable">$item_attribute_array</span><span class="token punctuation">[</span><span class="token variable">$item_code</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SearchTerm'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token variable">$visibility</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setWeight</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'Weight'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setCreatedAt</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'LaunchDate'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setTaxClassId</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2 is taxable goods</span></span>
<span class="line">	<span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setOptionsContainer</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'container1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setfulfillmentlatency</span><span class="token punctuation">(</span><span class="token variable">$item_attribute_array</span><span class="token punctuation">[</span><span class="token variable">$item_code</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'FulfillmentLatency'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setmaterialandfabric</span><span class="token punctuation">(</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"|"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">","</span><span class="token punctuation">,</span> <span class="token variable">$item_attribute_array</span><span class="token punctuation">[</span><span class="token variable">$item_code</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'MaterialAndFabric'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setStockData</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'is_in_stock'</span> <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'qty'</span> <span class="token operator">=&gt;</span> <span class="token number">99999</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setbrand</span><span class="token punctuation">(</span><span class="token variable">$item_attribute_array</span><span class="token punctuation">[</span><span class="token variable">$item_code</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'Brand'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	</span>
<span class="line">	<span class="token comment">///eco attributes</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword keyword-empty">empty</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'InfoText'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$string</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'.gif'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'|More Colors'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'|More Colors,'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'|More Options'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'|More Scents'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'|More Sizes'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'InfoText'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$explode_string</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">','</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">seteco_attribute</span><span class="token punctuation">(</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token function">get_magento_option_ids</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'eco_attribute'</span><span class="token punctuation">,</span> <span class="token variable">$explode_string</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">','</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">	</span>
<span class="line">	<span class="token comment">//set categories</span></span>
<span class="line">	<span class="token variable">$category_ids</span> <span class="token operator">=</span> <span class="token variable">$category_array</span><span class="token punctuation">[</span><span class="token variable">$item_code</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token keyword keyword-empty">empty</span><span class="token punctuation">(</span><span class="token variable">$category_ids</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setCategoryIds</span><span class="token punctuation">(</span><span class="token variable">$category_ids</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">	</span>
<span class="line">	<span class="token comment">//set configurable attributes for configurable products</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token variable">$type_id</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'configurable'</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">    	<span class="token variable">$position_count</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token variable">$configurable_attribute_array</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SizeLabel'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ColorLabel'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'StyleLabel'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token variable">$configurable_attribute_array</span> <span class="token operator">=</span> <span class="token function">array_filter</span><span class="token punctuation">(</span><span class="token variable">$configurable_attribute_array</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'strlen'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-foreach">foreach</span><span class="token punctuation">(</span><span class="token variable">$configurable_attribute_array</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$key</span> <span class="token operator">=&gt;</span> <span class="token variable">$value</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">        	<span class="token variable">$configurable_attribute_array</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$value</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'Color'</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string single-quoted-string">'color_item'</span> <span class="token punctuation">:</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'|'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	</span>
<span class="line">       	<span class="token punctuation">}</span></span>
<span class="line">       	<span class="token variable">$configurable_attribute_data</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">       	<span class="token variable">$position</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-foreach">foreach</span><span class="token punctuation">(</span><span class="token variable">$configurable_attribute_array</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$value</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">        	<span class="token variable">$configurable_attribute_data</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'label'</span> <span class="token operator">=&gt;</span> <span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'use_default'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string single-quoted-string">'position'</span> <span class="token operator">=&gt;</span> <span class="token variable">$position</span><span class="token operator">++</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'attribute_id'</span> <span class="token operator">=&gt;</span> <span class="token variable">$attribute_array</span><span class="token punctuation">[</span><span class="token variable">$value</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'attribute_code'</span> <span class="token operator">=&gt;</span></span>
<span class="line">    <span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'frontend_label'</span> <span class="token operator">=&gt;</span> <span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'store_label'</span> <span class="token operator">=&gt;</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	</span>
<span class="line">       	<span class="token punctuation">}</span></span>
<span class="line">        <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setCanSaveConfigurableAttributes</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setConfigurableAttributesData</span><span class="token punctuation">(</span><span class="token variable">$configurable_attribute_data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">	</span>
<span class="line">	<span class="token comment">//give configurable attributes values, for item variations</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword keyword-empty">empty</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SizeLabel'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$attribute_one</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SizeLabel'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$attribute_one</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$attribute_one</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'color'</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string single-quoted-string">'color_item'</span> <span class="token punctuation">:</span> <span class="token variable">$attribute_one</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$attribute_one</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'|'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$attribute_one</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$value_one</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SizeDescription'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$magento_product_data</span><span class="token punctuation">[</span><span class="token variable">$attribute_one</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">get_magento_option_ids</span><span class="token punctuation">(</span><span class="token variable">$attribute_one</span><span class="token punctuation">,</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token variable">$value_one</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword keyword-empty">empty</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ColorLabel'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$attribute_two</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ColorLabel'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$attribute_two</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$attribute_two</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'color'</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string single-quoted-string">'color_item'</span> <span class="token punctuation">:</span> <span class="token variable">$attribute_two</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$attribute_two</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'|'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$attribute_two</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$value_two</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ColorDescription'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$magento_product_data</span><span class="token punctuation">[</span><span class="token variable">$attribute_two</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">get_magento_option_ids</span><span class="token punctuation">(</span><span class="token variable">$attribute_two</span><span class="token punctuation">,</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token variable">$value_two</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword keyword-empty">empty</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'StyleLabel'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$attribute_three</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'StyleLabel'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$attribute_three</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$attribute_three</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'color'</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string single-quoted-string">'color_item'</span> <span class="token punctuation">:</span> <span class="token variable">$attribute_three</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$attribute_three</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'|'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$attribute_three</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$value_three</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'StyleDescription'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$magento_product_data</span><span class="token punctuation">[</span><span class="token variable">$attribute_three</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">get_magento_option_ids</span><span class="token punctuation">(</span><span class="token variable">$attribute_three</span><span class="token punctuation">,</span>  <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token variable">$value_three</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">	<span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">addData</span><span class="token punctuation">(</span><span class="token variable">$magento_product_data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">	<span class="token comment">//import images</span></span>
<span class="line">    <span class="token comment">/*</span>
<span class="line">    $images_array = array();</span>
<span class="line">	$images_array[] = (($item_attribute_array[$item_code]['SwatchImageUrl']) != '') ? array('level' =&gt; 'thumbnail', 'url' =&gt; $item_attribute_array[$item_code]['SwatchImageUrl'], 'exclude' =&gt; true) : '';</span>
<span class="line">	$images_array[] = (($item_attribute_array[$item_code]['MainImageUrl']) != '') ? array('level' =&gt; 'image', 'url' =&gt; $item_attribute_array[$item_code]['MainImageUrl'], 'exclude' =&gt; true) : '';</span>
<span class="line">	$images_array = array_filter($images_array, 'is_array');</span>
<span class="line">&nbsp;</span>
<span class="line">	foreach($images_array as $image_data)</span>
<span class="line">	{</span>
<span class="line">		//$product-&gt;addImageToMediaGallery($image_data['url'], array($image_data['level']), false, $image_data['exclude']); //last parameter is exclude, which should be true </span>
<span class="line">	}</span>
<span class="line">    */</span></span>
<span class="line">&nbsp;</span>
<span class="line">	<span class="token comment">//save product</span></span>
<span class="line">	<span class="token variable">$count</span><span class="token operator">++</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-try">try</span></span>
<span class="line">	<span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$time</span> <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token variable">$start</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-echo">echo</span> <span class="token punctuation">(</span><span class="token variable">$count</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">': '</span> <span class="token operator">.</span> <span class="token variable">$item_code</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" ("</span> <span class="token operator">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ProductName'</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">") is imported. ("</span> <span class="token operator">.</span> <span class="token variable">$time</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" seconds)\n"</span><span class="token punctuation">;</span> </span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-catch">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">    	<span class="token keyword keyword-echo">echo</span> <span class="token variable">$e</span><span class="token operator">-&gt;</span><span class="token property">faultstring</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span></span>
<span class="line">    	<span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$log</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"Excel Row: <span class="token interpolation"><span class="token variable">$item_code</span></span>      This row was not inserted in Magento because of an error\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">   	<span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">//testing</span></span>
<span class="line">    <span class="token comment">//if ($count == 1)</span></span>
<span class="line">    <span class="token comment">//{</span></span>
<span class="line">    <span class="token comment">//    break;</span></span>
<span class="line">    <span class="token comment">//}</span></span>
<span class="line">    </span>
<span class="line">   	<span class="token comment">//reset for next iteration</span></span>
<span class="line">	<span class="token keyword keyword-unset">unset</span><span class="token punctuation">(</span><span class="token variable">$configurable_attributes</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-unset">unset</span><span class="token punctuation">(</span><span class="token variable">$magento_product_data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-unset">unset</span><span class="token punctuation">(</span><span class="token variable">$images_array</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	</span>
<span class="line">	<span class="token comment">//clear product cache, so importing can go faster</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">%</span> <span class="token number">20</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">gc_collect_cycles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Nimli</div>
                <div class="description">Imports attributes to the Nimli Magento Store</div>
                <div class="languages">PHP</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-php" tabindex="0">                <code class="language-php"><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token function">set_include_path</span><span class="token punctuation">(</span><span class="token function">get_include_path</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'C:/makeshift/files/saffron'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-require_once">require_once</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"/app/Mage.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//to do Magento Library functions</span></span>
<span class="line"><span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">//connect and choose database</span></span>
<span class="line"><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token function">mysql_connect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">mysql_select_db</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'puck'</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">get_all_attributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$attributes</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$sql_array</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT sizelabel FROM item GROUP BY sizelabel"</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$sql_array</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT colorlabel FROM item GROUP BY colorlabel"</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$sql_array</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT stylelabel FROM item GROUP BY stylelabel"</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$sql_array</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$sql</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_row</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ucwords</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$attributes</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$attributes</span><span class="token punctuation">,</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token function">sort</span><span class="token punctuation">(</span><span class="token variable">$attributes</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-unset">unset</span><span class="token punctuation">(</span><span class="token variable">$attributes</span><span class="token punctuation">[</span><span class="token function">array_search</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$options</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token variable">$attributes</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">get_all_options</span><span class="token punctuation">(</span><span class="token variable">$configurable_attribute</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$options</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$sql_array</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT sizedescription FROM item WHERE sizelabel = '<span class="token interpolation"><span class="token variable">$configurable_attribute</span></span>' GROUP BY sizedescription"</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$sql_array</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT colordescription FROM item WHERE colorlabel = '<span class="token interpolation"><span class="token variable">$configurable_attribute</span></span>' GROUP BY colordescription"</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$sql_array</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT styledescription FROM item WHERE stylelabel = '<span class="token interpolation"><span class="token variable">$configurable_attribute</span></span>' GROUP BY styledescription"</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$sql_array</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$sql</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_row</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ucwords</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'|2'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'|'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$options</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$options</span><span class="token punctuation">,</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token function">sort</span><span class="token punctuation">(</span><span class="token variable">$options</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-unset">unset</span><span class="token punctuation">(</span><span class="token variable">$options</span><span class="token punctuation">[</span><span class="token function">array_search</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$options</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token variable">$options</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">get_attributes_with_options</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$attributes_with_options</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$all_attributes</span> <span class="token operator">=</span> <span class="token function">get_all_attributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$all_attributes</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$attribute</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">    	<span class="token variable">$clean_attribute</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'|2'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'|'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$attribute</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token variable">$clean_attribute</span> <span class="token operator">==</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$clean_attribute</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'attribute'</span><span class="token punctuation">;</span><span class="token punctuation">}</span></span>
<span class="line">    	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token function">ucwords</span><span class="token punctuation">(</span><span class="token variable">$clean_attribute</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'Color'</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$clean_attribute</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'color_item'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></span>
<span class="line">        <span class="token variable">$attributes_with_options</span><span class="token punctuation">[</span><span class="token variable">$clean_attribute</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">substr_count</span><span class="token punctuation">(</span><span class="token variable">$attribute</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"|"</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">array_merge</span><span class="token punctuation">(</span><span class="token variable">$attributes_with_options</span><span class="token punctuation">[</span><span class="token variable">$clean_attribute</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">get_all_options</span><span class="token punctuation">(</span><span class="token variable">$attribute</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token class-name return-type">get_all_options</span><span class="token punctuation">(</span><span class="token variable">$attribute</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$attribute</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token variable">$attributes_with_options</span><span class="token punctuation">[</span><span class="token variable">$clean_attribute</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">array_unique</span><span class="token punctuation">(</span><span class="token variable">$attributes_with_options</span><span class="token punctuation">[</span><span class="token variable">$clean_attribute</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">sort</span><span class="token punctuation">(</span><span class="token variable">$attributes_with_options</span><span class="token punctuation">[</span><span class="token variable">$clean_attribute</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token variable">$attributes_with_options</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">add_configurable_attribute</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$attribute</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/resource_eav_attribute'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$attribute</span><span class="token operator">-&gt;</span><span class="token function">addData</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'entity_type_id'</span> <span class="token operator">=&gt;</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'eav/entity'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span></span>
<span class="line">        <span class="token function">setType</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog_product'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getTypeId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'attribute_code'</span> <span class="token operator">=&gt;</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string single-quoted-string">'attribute_model'</span> <span class="token operator">=&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'backend_model'</span> <span class="token operator">=&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'backend_type'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'int'</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string single-quoted-string">'backend_table'</span> <span class="token operator">=&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'frontend_model'</span> <span class="token operator">=&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'frontend_input'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'select'</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string single-quoted-string">'frontend_label'</span> <span class="token operator">=&gt;</span> <span class="token function">ucwords</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'frontend_class'</span> <span class="token operator">=&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'source_model'</span> <span class="token operator">=&gt;</span></span>
<span class="line">        <span class="token string single-quoted-string">'eav/entity_attribute_source_table'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_required'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_user_defined'</span> <span class="token operator">=&gt;</span></span>
<span class="line">        <span class="token string single-quoted-string">'1'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'default_value'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_unique'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'note'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string single-quoted-string">'frontend_input_renderer'</span> <span class="token operator">=&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_global'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_visible'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string single-quoted-string">'is_searchable'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_filterable'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_comparable'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string single-quoted-string">'is_visible_on_front'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_html_allowed_on_front'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string single-quoted-string">'is_used_for_price_rules'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_filterable_in_search'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string single-quoted-string">'used_in_product_listing'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'used_for_sort_by'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_configurable'</span> <span class="token operator">=&gt;</span></span>
<span class="line">        <span class="token string single-quoted-string">'1'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'apply_to'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_visible_in_advanced_search'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string single-quoted-string">'is_wysiwyg_enabled'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_used_for_promo_rules'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$attribute</span><span class="token operator">-&gt;</span><span class="token function">setIsUserDefined</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-try">try</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$attribute</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$name</span></span> is now a Magento Attribute"</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-echo">echo</span> <span class="token string single-quoted-string">'&lt;p&gt;Sorry, error occured while trying to save the attribute. Error: '</span> <span class="token operator">.</span> <span class="token variable">$e</span><span class="token operator">-&gt;</span></span>
<span class="line">            <span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;/p&gt;'</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">add_options_to_attribute</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$options</span><span class="token punctuation">)</span> <span class="token comment">//options is an array of values</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$count</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$attribute</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getResourceModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'eav/entity_attribute_collection'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span></span>
<span class="line">        <span class="token function">setCodeFilter</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getFirstItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$optionArr</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'value'</span> <span class="token operator">=&gt;</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'order'</span> <span class="token operator">=&gt;</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'delete'</span> <span class="token operator">=&gt;</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$options</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$key</span> <span class="token operator">=&gt;</span> <span class="token variable">$value</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$optionArr</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'option_'</span> <span class="token operator">.</span> <span class="token variable">$key</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token variable">$optionArr</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'order'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'option_'</span> <span class="token operator">.</span> <span class="token variable">$key</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$count</span><span class="token operator">++</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token function">var_export</span><span class="token punctuation">(</span><span class="token variable">$optionArr</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$attribute</span><span class="token operator">-&gt;</span><span class="token function">setOption</span><span class="token punctuation">(</span><span class="token variable">$optionArr</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$attribute</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">add_attributes_with_options_to_magento</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$attributes_with_options</span> <span class="token operator">=</span> <span class="token function">get_attributes_with_options</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-foreach">foreach</span><span class="token punctuation">(</span><span class="token variable">$attributes_with_options</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$key</span> <span class="token operator">=&gt;</span> <span class="token variable">$value</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token punctuation">{</span></span>
<span class="line">		<span class="token function">add_configurable_attribute</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token function">add_options_to_attribute</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token function">add_attributes_with_options_to_magento</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Nimli</div>
                <div class="description">Imports images to the Nimli Magento Store</div>
                <div class="languages">PHP</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-php" tabindex="0">                <code class="language-php"><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token function">set_include_path</span><span class="token punctuation">(</span><span class="token function">get_include_path</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'C:/MagentoProject'</span> <span class="token operator">.</span></span>
<span class="line">    <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'C:/xampp/htdocs/adminfiles'</span> <span class="token operator">.</span> <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span></span>
<span class="line">    <span class="token string single-quoted-string">'C:/xampp/htdocs/chunk/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-require_once">require_once</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"/app/Mage.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//to do Magento Library functions</span></span>
<span class="line"><span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token function">mysql_connect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">mysql_select_db</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'puck'</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">//////////////////////////////////</span></span>
<span class="line"><span class="token comment">//DELETE PRODUCT IMAGES</span></span>
<span class="line"><span class="token comment">//////////////////////////////////</span></span>
<span class="line"><span class="token variable">$media_api</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"catalog/product_attribute_media_api"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">delete_product_images</span><span class="token punctuation">(</span><span class="token variable">$product</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$attributes</span> <span class="token operator">=</span> <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">getTypeInstance</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getSetAttributes</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">				<span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token keyword keyword-isset">isset</span> <span class="token punctuation">(</span> <span class="token variable">$attributes</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'media_gallery'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">					<span class="token variable">$gallery</span> <span class="token operator">=</span> <span class="token variable">$attributes</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'media_gallery'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">					<span class="token comment">//Get the images</span></span>
<span class="line">					<span class="token variable">$galleryData</span> <span class="token operator">=</span> <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">getMediaGallery</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">					<span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span> <span class="token variable">$galleryData</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'images'</span><span class="token punctuation">]</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$image</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">						<span class="token comment">//if image exists</span></span>
<span class="line">						<span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span></span>
<span class="line">							<span class="token variable">$gallery</span><span class="token operator">-&gt;</span><span class="token function">getBackend</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getImage</span> <span class="token punctuation">(</span> <span class="token variable">$product</span><span class="token punctuation">,</span> <span class="token variable">$image</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> </span>
<span class="line">							<span class="token punctuation">{</span></span>
<span class="line">							<span class="token variable">$gallery</span><span class="token operator">-&gt;</span><span class="token function">getBackend</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">removeImage</span> <span class="token punctuation">(</span> <span class="token variable">$product</span><span class="token punctuation">,</span> <span class="token variable">$image</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">						<span class="token punctuation">}</span></span>
<span class="line">					<span class="token punctuation">}</span></span>
<span class="line">					<span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">save</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">				<span class="token punctuation">}</span></span>
<span class="line">				<span class="token keyword keyword-echo">echo</span> <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">getSku</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" has it's images deleted\n"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/product'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span></span>
<span class="line">    <span class="token function">addAttributeToSelect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'*'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">addAttributeToFilter</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'brand'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'azuri'</span><span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$product</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$sku</span> <span class="token operator">=</span> <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">getSku</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token function">delete_product_images</span><span class="token punctuation">(</span><span class="token variable">$product</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$suffix_array</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'main'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'swatch'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'alt2'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'alt3'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'alt4'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'alt5'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'alt6'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$suffix_array</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$suffix</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">dirname</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/azuri/'</span> <span class="token operator">.</span> <span class="token variable">$sku</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"_<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$suffix</span><span class="token punctuation">}</span></span>.jpg"</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">filesize</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">         	<span class="token keyword keyword-switch">switch</span> <span class="token punctuation">(</span><span class="token variable">$suffix</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">		    <span class="token keyword keyword-case">case</span> <span class="token string single-quoted-string">'main'</span><span class="token punctuation">:</span></span>
<span class="line">		        <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">addImageToMediaGallery</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'image'</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">		    <span class="token keyword keyword-case">case</span> <span class="token string single-quoted-string">'swatch'</span><span class="token punctuation">:</span></span>
<span class="line">		        <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">addImageToMediaGallery</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'thumbnail'</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">		    <span class="token keyword keyword-case">case</span> <span class="token string single-quoted-string">'alt2'</span><span class="token punctuation">:</span></span>
<span class="line">		        <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">addImageToMediaGallery</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'image'</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">		    <span class="token keyword keyword-case">case</span> <span class="token string single-quoted-string">'alt3'</span><span class="token punctuation">:</span></span>
<span class="line">		        <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">addImageToMediaGallery</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'image'</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">		    <span class="token keyword keyword-case">case</span> <span class="token string single-quoted-string">'alt4'</span><span class="token punctuation">:</span></span>
<span class="line">		        <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">addImageToMediaGallery</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'image'</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">		    <span class="token keyword keyword-case">case</span> <span class="token string single-quoted-string">'alt5'</span><span class="token punctuation">:</span></span>
<span class="line">		        <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">addImageToMediaGallery</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'image'</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">		    <span class="token keyword keyword-case">case</span> <span class="token string single-quoted-string">'alt6'</span><span class="token punctuation">:</span></span>
<span class="line">		        <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">addImageToMediaGallery</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'image'</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span></span>
<span class="line">			<span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span>
<span class="line">    <span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$sku</span></span> now has images\n"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Nimli</div>
                <div class="description">Imports brands to the Nimli Magento Store</div>
                <div class="languages">PHP</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-php" tabindex="0">                <code class="language-php"><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token function">set_include_path</span><span class="token punctuation">(</span><span class="token function">get_include_path</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'C:/MagentoProject'</span> <span class="token operator">.</span></span>
<span class="line">    <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'C:/xampp/htdocs/adminfiles'</span> <span class="token operator">.</span> <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span></span>
<span class="line">    <span class="token string single-quoted-string">'C:/xampp/htdocs/chunk/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-require_once">require_once</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"/app/Mage.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//to do Magento Library functions</span></span>
<span class="line"><span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token function">mysql_connect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">mysql_select_db</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'puck'</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">////////////////////////////////////</span></span>
<span class="line"><span class="token comment">//GET ALL IMAGE LINKS</span></span>
<span class="line"><span class="token comment">////////////////////////////////////</span></span>
<span class="line"><span class="token variable">$product_sheet_sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT id1, brand FROM brands_csv"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$product_sheet_result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$product_sheet_sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_assoc</span><span class="token punctuation">(</span><span class="token variable">$product_sheet_result</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$product_sheet_array</span><span class="token punctuation">[</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id1'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'brand'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">////////////////////////////////////</span></span>
<span class="line"><span class="token comment">//GET ALL ITEMS IN SKU</span></span>
<span class="line"><span class="token comment">////////////////////////////////////</span></span>
<span class="line"><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT ItemCode, ParentItemCode FROM item"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_assoc</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$sku_array</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$parent_array</span><span class="token punctuation">[</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$product_sheet_array</span><span class="token punctuation">[</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token keyword keyword-empty">empty</span><span class="token punctuation">(</span><span class="token variable">$parent_array</span><span class="token punctuation">[</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$parent_array</span><span class="token punctuation">[</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$product_sheet_array</span><span class="token punctuation">[</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token variable">$parent_array</span> <span class="token operator">=</span> <span class="token function">array_filter</span><span class="token punctuation">(</span><span class="token variable">$parent_array</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'strlen'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">//////////////////////////////////</span></span>
<span class="line"><span class="token comment">//DELETE PRODUCT IMAGES</span></span>
<span class="line"><span class="token comment">//////////////////////////////////</span></span>
<span class="line"><span class="token variable">$media_api</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"catalog/product_attribute_media_api"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">delete_product_images</span><span class="token punctuation">(</span><span class="token variable">$product</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$attributes</span> <span class="token operator">=</span> <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">getTypeInstance</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getSetAttributes</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">				<span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token keyword keyword-isset">isset</span> <span class="token punctuation">(</span> <span class="token variable">$attributes</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'media_gallery'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">					<span class="token variable">$gallery</span> <span class="token operator">=</span> <span class="token variable">$attributes</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'media_gallery'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">					<span class="token comment">//Get the images</span></span>
<span class="line">					<span class="token variable">$galleryData</span> <span class="token operator">=</span> <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">getMediaGallery</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">					<span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span> <span class="token variable">$galleryData</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'images'</span><span class="token punctuation">]</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$image</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">						<span class="token comment">//if image exists</span></span>
<span class="line">						<span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span></span>
<span class="line">							<span class="token variable">$gallery</span><span class="token operator">-&gt;</span><span class="token function">getBackend</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getImage</span> <span class="token punctuation">(</span> <span class="token variable">$product</span><span class="token punctuation">,</span> <span class="token variable">$image</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> </span>
<span class="line">							<span class="token punctuation">{</span></span>
<span class="line">							<span class="token variable">$gallery</span><span class="token operator">-&gt;</span><span class="token function">getBackend</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">removeImage</span> <span class="token punctuation">(</span> <span class="token variable">$product</span><span class="token punctuation">,</span> <span class="token variable">$image</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">						<span class="token punctuation">}</span></span>
<span class="line">					<span class="token punctuation">}</span></span>
<span class="line">					<span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">save</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">				<span class="token punctuation">}</span></span>
<span class="line">				<span class="token keyword keyword-echo">echo</span> <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">getSku</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" has it's images deleted\n"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">////////////////////////////////</span></span>
<span class="line"><span class="token comment">//LOOP THROUGH PRODUCTS (DELETE AND ADD ACCORDINGLY)</span></span>
<span class="line"><span class="token comment">/////////////////////////////////</span></span>
<span class="line"><span class="token comment">////////////////////////////////</span></span>
<span class="line"><span class="token comment">//LOOP THROUGH PRODUCTS (DELETE AND ADD ACCORDINGLY)</span></span>
<span class="line"><span class="token comment">/////////////////////////////////</span></span>
<span class="line"><span class="token operator">/</span><span class="token operator">*</span></span>
<span class="line"><span class="token keyword keyword-foreach">foreach</span><span class="token punctuation">(</span><span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/product'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$product</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$time</span> <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$sku</span> <span class="token operator">=</span> <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">getSku</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$brand</span> <span class="token operator">=</span> <span class="token variable">$parent_array</span><span class="token punctuation">[</span><span class="token variable">$sku</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">setBrand</span><span class="token punctuation">(</span><span class="token variable">$brand</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token comment">//$product-&gt;save();</span></span>
<span class="line">	<span class="token variable">$seconds</span> <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token variable">$time</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$sku</span></span> has been given a brand <span class="token interpolation"><span class="token variable">$brand</span></span> (<span class="token interpolation"><span class="token variable">$seconds</span></span> seconds)\n\n"</span><span class="token punctuation">;</span>	</span>
<span class="line">	<span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-unset">unset</span><span class="token punctuation">(</span><span class="token variable">$product</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token operator">*</span><span class="token operator">/</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token function">fpve</span><span class="token punctuation">(</span><span class="token variable">$parent_array</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Nimli</div>
                <div class="description">Imports categories to the Nimli Magento Store</div>
                <div class="languages">PHP</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-php" tabindex="0">                <code class="language-php"><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token function">set_include_path</span><span class="token punctuation">(</span><span class="token function">get_include_path</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'C:/MagentoProject'</span> <span class="token operator">.</span></span>
<span class="line">	<span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'C:/makeshift/files/saffron/adminfiles'</span> <span class="token operator">.</span> <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span></span>
<span class="line">	<span class="token string single-quoted-string">'C:/makeshift/files/saffron/'</span> <span class="token operator">.</span> <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/chroot/home/pashmina/pashminamall.com/html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-require_once">require_once</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"/app/Mage.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//to do Magento Library functions</span></span>
<span class="line"><span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">//instantiate category model</span></span>
<span class="line"><span class="token variable">$category_model</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/category'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">//connect and choose database</span></span>
<span class="line"><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token function">mysql_connect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">mysql_select_db</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'puck'</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">//get result</span></span>
<span class="line"><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT cac1.*, cac2.category as parentcategoryname</span>
<span class="line">FROM companyitemcategory as cac1</span>
<span class="line">LEFT JOIN companyitemcategory as cac2 ON cac1.parentcatid = cac2.catid</span>
<span class="line">WHERE cac1.parentcatid NOT IN (700, 739, 886, 889, 890, 892, 893, 891, 895, 894, 896, 897, 898, 899, 1254, 1712, 1781, 2258, 2268, 2259, 2280)</span>
<span class="line">AND cac1.category NOT LIKE '%&gt;&gt;'</span>
<span class="line">ORDER BY cac1.catid"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">//iterate through table</span></span>
<span class="line"><span class="token variable">$count</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$path</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-while">while</span><span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_assoc</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	</span>
<span class="line">	<span class="token variable">$count</span><span class="token operator">++</span><span class="token punctuation">;</span></span>
<span class="line">	</span>
<span class="line">	<span class="token comment">//SET VARIABLES FROM MYSQL ROW</span></span>
<span class="line">	<span class="token variable">$category_name</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'Category'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$parent_category_name</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'parentcategoryname'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$omx_category_id</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CatID'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$omx_parent_category_id</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ParentCatID'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	</span>
<span class="line">	<span class="token comment">//GET CATEGORY PATH</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token variable">$parent_category_name</span> <span class="token operator">!=</span> <span class="token constant">null</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token punctuation">{</span></span>
<span class="line">		<span class="token variable">$parent_category</span> <span class="token operator">=</span> <span class="token variable">$category_model</span><span class="token operator">-&gt;</span><span class="token function">loadByAttribute</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'omx_category_id'</span><span class="token punctuation">,</span> <span class="token variable">$omx_parent_category_id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token variable">$parent_category</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token punctuation">{</span></span>
<span class="line">			<span class="token keyword keyword-try">try</span></span>
<span class="line">			<span class="token punctuation">{</span></span>
<span class="line">				<span class="token variable">$path</span> <span class="token operator">=</span> <span class="token variable">$category_model</span><span class="token operator">-&gt;</span><span class="token function">loadByAttribute</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'omx_category_id'</span><span class="token punctuation">,</span> <span class="token variable">$omx_parent_category_id</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">			<span class="token punctuation">}</span></span>
<span class="line">			<span class="token keyword keyword-catch">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">		<span class="token punctuation">}</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">	<span class="token keyword keyword-else">else</span></span>
<span class="line">	<span class="token punctuation">{</span></span>
<span class="line">		<span class="token variable">$path</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"1/2"</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">	</span>
<span class="line">	<span class="token comment">///ADD CATEGORY</span></span>
<span class="line">	<span class="token variable">$category</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/category'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$category</span><span class="token operator">-&gt;</span><span class="token function">setStoreId</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span>
<span class="line">	<span class="token variable">$general</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$category_name</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$general</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'path'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$path</span><span class="token punctuation">;</span> </span>
<span class="line">	<span class="token variable">$general</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'description'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$category_name</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$general</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'meta_title'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$category_name</span><span class="token punctuation">;</span> <span class="token comment">//Page title</span></span>
<span class="line">	<span class="token variable">$general</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'meta_keywords'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$category_name</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$general</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'meta_description'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$category_name</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$general</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'landing_page'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span> <span class="token comment">//has to be created in advance, here comes id</span></span>
<span class="line">	<span class="token variable">$general</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'display_mode'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"PRODUCTS_AND_PAGE"</span><span class="token punctuation">;</span> <span class="token comment">//static block and the products are shown on the page</span></span>
<span class="line">	<span class="token variable">$general</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'is_active'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$general</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'is_anchor'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$general</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'omx_category_id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$omx_category_id</span><span class="token punctuation">;</span>  <span class="token comment">//new attribute that Mark created, to resolve issues with </span></span>
<span class="line">								<span class="token comment">//categories of the same name</span></span>
<span class="line">	<span class="token variable">$general</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url_key'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$category_name</span><span class="token punctuation">;</span><span class="token comment">//url to be used for this category's page by magento.</span></span>
<span class="line">	</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">	<span class="token variable">$category</span><span class="token operator">-&gt;</span><span class="token function">addData</span><span class="token punctuation">(</span><span class="token variable">$general</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-try">try</span> <span class="token punctuation">{</span></span>
<span class="line">		<span class="token variable">$category</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"Success! <span class="token interpolation"><span class="token variable">$category_name</span></span> is now a category. Id:  "</span><span class="token operator">.</span><span class="token variable">$category</span><span class="token operator">-&gt;</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">	<span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token variable">$e</span><span class="token operator">-&gt;</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">	<span class="token comment">//END ADD CATEGORY</span></span>
<span class="line">	</span>
<span class="line">	</span>
<span class="line">	<span class="token comment">//var_export($row);</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Nimli</div>
                <div class="description">Imports images to the Nimli Magento Store</div>
                <div class="languages">PHP</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-php" tabindex="0">                <code class="language-php"><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token function">set_include_path</span><span class="token punctuation">(</span><span class="token function">get_include_path</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'C:/MagentoProject'</span> <span class="token operator">.</span></span>
<span class="line">    <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'C:/xampp/htdocs/adminfiles'</span> <span class="token operator">.</span> <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span></span>
<span class="line">    <span class="token string single-quoted-string">'C:/xampp/htdocs/chunk/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-require_once">require_once</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"/app/Mage.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//to do Magento Library functions</span></span>
<span class="line"><span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token function">mysql_connect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">mysql_select_db</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'puck'</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">////////////////////////////////////</span></span>
<span class="line"><span class="token comment">//GET ALL IMAGE LINKS</span></span>
<span class="line"><span class="token comment">////////////////////////////////////</span></span>
<span class="line"><span class="token variable">$product_sheet_sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT id1, image_link FROM products LIMIT 100, 1700"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$product_sheet_result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$product_sheet_sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_assoc</span><span class="token punctuation">(</span><span class="token variable">$product_sheet_result</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$product_sheet_array</span><span class="token punctuation">[</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id1'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">////////////////////////////////////</span></span>
<span class="line"><span class="token comment">//GET ALL ITEMS IN SKU</span></span>
<span class="line"><span class="token comment">////////////////////////////////////</span></span>
<span class="line"><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT ItemCode, ParentItemCode FROM item"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_assoc</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$sku_array</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$parent_image_array</span><span class="token punctuation">[</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$product_sheet_array</span><span class="token punctuation">[</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token keyword keyword-empty">empty</span><span class="token punctuation">(</span><span class="token variable">$parent_image_array</span><span class="token punctuation">[</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$parent_image_array</span><span class="token punctuation">[</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$product_sheet_array</span><span class="token punctuation">[</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ParentItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token variable">$parent_image_array</span> <span class="token operator">=</span> <span class="token function">array_keys</span><span class="token punctuation">(</span><span class="token function">array_filter</span><span class="token punctuation">(</span><span class="token variable">$parent_image_array</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"strlen"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">//////////////////////////////////</span></span>
<span class="line"><span class="token comment">//DELETE PRODUCT IMAGES</span></span>
<span class="line"><span class="token comment">//////////////////////////////////</span></span>
<span class="line"><span class="token variable">$media_api</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"catalog/product_attribute_media_api"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">delete_product_images</span><span class="token punctuation">(</span><span class="token variable">$product</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$attributes</span> <span class="token operator">=</span> <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">getTypeInstance</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getSetAttributes</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">				<span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token keyword keyword-isset">isset</span> <span class="token punctuation">(</span> <span class="token variable">$attributes</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'media_gallery'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">					<span class="token variable">$gallery</span> <span class="token operator">=</span> <span class="token variable">$attributes</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'media_gallery'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">					<span class="token comment">//Get the images</span></span>
<span class="line">					<span class="token variable">$galleryData</span> <span class="token operator">=</span> <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">getMediaGallery</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">					<span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span> <span class="token variable">$galleryData</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'images'</span><span class="token punctuation">]</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$image</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">						<span class="token comment">//if image exists</span></span>
<span class="line">						<span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span></span>
<span class="line">							<span class="token variable">$gallery</span><span class="token operator">-&gt;</span><span class="token function">getBackend</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getImage</span> <span class="token punctuation">(</span> <span class="token variable">$product</span><span class="token punctuation">,</span> <span class="token variable">$image</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> </span>
<span class="line">							<span class="token punctuation">{</span></span>
<span class="line">							<span class="token variable">$gallery</span><span class="token operator">-&gt;</span><span class="token function">getBackend</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">removeImage</span> <span class="token punctuation">(</span> <span class="token variable">$product</span><span class="token punctuation">,</span> <span class="token variable">$image</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">						<span class="token punctuation">}</span></span>
<span class="line">					<span class="token punctuation">}</span></span>
<span class="line">					<span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">save</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">				<span class="token punctuation">}</span></span>
<span class="line">				<span class="token keyword keyword-echo">echo</span> <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">getSku</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" has it's images deleted\n"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">////////////////////////////////</span></span>
<span class="line"><span class="token comment">//LOOP THROUGH PRODUCTS (DELETE AND ADD ACCORDINGLY)</span></span>
<span class="line"><span class="token comment">/////////////////////////////////</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-foreach">foreach</span><span class="token punctuation">(</span><span class="token variable">$parent_image_array</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$sku</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$product</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/product'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/images/'</span> <span class="token operator">.</span>  <span class="token variable">$sku</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'.jpg'</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">filesize</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token keyword keyword-empty">empty</span><span class="token punctuation">(</span><span class="token variable">$sku</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token punctuation">{</span>	</span>
<span class="line">	<span class="token variable">$time</span> <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">getIdBySku</span><span class="token punctuation">(</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$sku</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token punctuation">{</span></span>
<span class="line">	<span class="token function">delete_product_images</span><span class="token punctuation">(</span><span class="token variable">$product</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">addImageToMediaGallery</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'image'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'small_image'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	</span>
<span class="line">	</span>
<span class="line">	<span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$seconds</span> <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token variable">$time</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$sku</span></span> has been given an image (<span class="token interpolation"><span class="token variable">$seconds</span></span> seconds)\n\n"</span><span class="token punctuation">;</span>	</span>
<span class="line">	 <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	</span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">	<span class="token keyword keyword-else">else</span></span>
<span class="line">	<span class="token punctuation">{</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$sku</span></span> did not get an image\n"</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">	<span class="token keyword keyword-unset">unset</span><span class="token punctuation">(</span><span class="token variable">$product</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	</span>
<span class="line">	<span class="token punctuation">}</span> </span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Nimli</div>
                <div class="description">Imports Material &amp; Fabric to the Nimli Magento Store</div>
                <div class="languages">PHP</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-php" tabindex="0">                <code class="language-php"><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token function">set_include_path</span><span class="token punctuation">(</span><span class="token function">get_include_path</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'C:/MagentoProject'</span> <span class="token operator">.</span></span>
<span class="line">    <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'C:/xampp/htdocs/adminfiles'</span> <span class="token operator">.</span> <span class="token constant">PATH_SEPARATOR</span> <span class="token operator">.</span></span>
<span class="line">    <span class="token string single-quoted-string">'C:/xampp/htdocs/chunk/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">cm</span><span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">var_export</span><span class="token punctuation">(</span><span class="token function">get_class_methods</span><span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">ve</span><span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">var_export</span><span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">e</span><span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-echo">echo</span> <span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">gc</span><span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-echo">echo</span> <span class="token function">get_class</span><span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">fpve</span><span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"C:/test/fp.txt"</span><span class="token punctuation">,</span> <span class="token function">var_export</span><span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">fpe</span><span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"C:/test/fp.txt"</span><span class="token punctuation">,</span> <span class="token variable">$obj</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-require_once">require_once</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"/app/Mage.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//to do Magento Library functions</span></span>
<span class="line"><span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">app</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token variable">$product</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/product'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$collection</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/product'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$category</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/category'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//foreach($collection as $h){echo $h-&gt;getName() . "\n";}</span></span>
<span class="line"><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token function">mysql_connect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">mysql_select_db</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'puck'</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">////////////////////////////////////////</span></span>
<span class="line"><span class="token comment">///FUNCTION FOR SETTING OPTIONS FOR A PRODUCT (LIKE ECO ATTRIBUTE OR COLOR)</span></span>
<span class="line"><span class="token comment">////////////////////////////////////////</span></span>
<span class="line"><span class="token variable">$options_array</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">get_magento_option_ids</span><span class="token punctuation">(</span><span class="token variable">$attribute_name</span><span class="token punctuation">,</span> <span class="token variable">$option_names</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$options_array</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"options_array"</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//this array grows over time</span></span>
<span class="line">    <span class="token variable">$attribute_name</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$attribute_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword keyword-isset">isset</span><span class="token punctuation">(</span><span class="token variable">$options_array</span><span class="token punctuation">[</span><span class="token variable">$attribute_name</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment">//fill up array with new attribute &amp; options (done to not redeclare model class every single row, which is memory intensive)</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token variable">$attribute_name</span> <span class="token operator">==</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token variable">$attribute_name</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'attribute'</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span> <span class="token comment">//only done for that one category with no attribute name but had values</span></span>
<span class="line">        <span class="token variable">$attribute</span> <span class="token operator">=</span> <span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/resource_eav_attribute'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">loadByCode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog_product'</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$attribute_name</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token variable">$options</span> <span class="token operator">=</span> <span class="token variable">$attribute</span><span class="token operator">-&gt;</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getAllOptions</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$options</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$array</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token variable">$options_array</span><span class="token punctuation">[</span><span class="token variable">$attribute_name</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$array</span><span class="token punctuation">[</span>label<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$array</span><span class="token punctuation">[</span>value<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">///GET VALUES FROM ARRAY ABOVE</span></span>
<span class="line">    <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$option_names</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$option_name</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$values</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$options_array</span><span class="token punctuation">[</span><span class="token variable">$attribute_name</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$option_name</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token variable">$string</span> <span class="token operator">=</span> <span class="token function">implode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">','</span><span class="token punctuation">,</span> <span class="token function">array_values</span><span class="token punctuation">(</span><span class="token variable">$values</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token variable">$string</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">////////////////////////////////////</span></span>
<span class="line"><span class="token comment">//GET ATTRIBUTES FROM ITEM ATTRIBUTES BACKUP TABLE (brand, search, materialandfabric, etc)</span></span>
<span class="line"><span class="token comment">////////////////////////////////////</span></span>
<span class="line"><span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"Making Array from Item Attribute backup table...\n"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$item_attribute_sql</span> <span class="token operator">=</span></span>
<span class="line">    <span class="token string double-quoted-string">"SELECT ItemCode, AttributeValue8 as Brand, AttributeValue7 as SearchTerm, AttributeValue16 as FulfillmentLatency,</span>
<span class="line">AttributeValue18 as SmallImageUrl, AttributeValue19 as MainImageUrl, AttributeValue20 as Alternate1ImageUrl,</span>
<span class="line">AttributeValue21 as Alternate2ImageUrl, AttributeValue22 as Alternate3ImageUrl, AttributeValue23 as Alternate4ImageUrl,</span>
<span class="line">AttributeValue24 as Alternate5ImageUrl, AttributeValue25 as Alternate6ImageUrl,</span>
<span class="line">AttributeValue42 as MaterialAndFabric, AttributeValue48 as SwatchImageUrl</span>
<span class="line">FROM itemattribute"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$item_attribute_result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$item_attribute_sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$item_attribute_array</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token variable">$item_attribute_row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_assoc</span><span class="token punctuation">(</span><span class="token variable">$item_attribute_result</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$item_attribute_array</span><span class="token punctuation">[</span><span class="token variable">$item_attribute_row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ItemCode'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$item_attribute_row</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">////////IMPORT</span></span>
<span class="line"><span class="token keyword keyword-foreach">foreach</span><span class="token punctuation">(</span><span class="token class-name static-context">Mage</span><span class="token operator">::</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'catalog/product'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$product</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$sku</span> <span class="token operator">=</span> <span class="token variable">$product</span><span class="token operator">-&gt;</span><span class="token function">getSku</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$material_option_names</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'|'</span><span class="token punctuation">,</span> <span class="token variable">$item_attribute_array</span><span class="token punctuation">[</span><span class="token variable">$sku</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'MaterialAndFabric'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$material_id_string</span> <span class="token operator">=</span> <span class="token function">get_magento_option_ids</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'materialandfabric'</span><span class="token punctuation">,</span> <span class="token variable">$material_option_names</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token comment">//$product-&gt;setmaterialandfabric($material_id_string)-&gt;save();</span></span>
<span class="line">	<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$sku</span></span> has materialandfabric updated with multiple select attributes (<span class="token interpolation"><span class="token variable">$material_id_string</span></span>)\n"</span><span class="token punctuation">;</span></span>
<span class="line">	</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">Wordpress WatuPro plugin</div>
                <div class="description">Automatically updates a student's test scores from a Wordpress Page &amp; plugin that has functionality for students taking exams.</div>
                <div class="languages">PHP</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-php" tabindex="0">                <code class="language-php"><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?</span></span>
<span class="line"><span class="token comment">////////////////////</span></span>
<span class="line"><span class="token comment">//</span></span>
<span class="line"><span class="token comment">//  MARKS CHANGES</span></span>
<span class="line"><span class="token comment">//</span></span>
<span class="line"><span class="token comment">////////////////////</span></span>
<span class="line"><span class="token comment">//This wordpress hook was called in C:\makeshift\files\wordpress\goon_city\wp-content\plugins\watupro\controllers\questions.php (function: watupro_questions, line 248)</span></span>
<span class="line"><span class="token comment">//This is at the point where a question has been changed in the Administration Panel</span></span>
<span class="line"><span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'watupro_saved_question'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'watupro_saved_question_custom'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function-definition function">watupro_saved_question_custom</span><span class="token punctuation">(</span><span class="token variable">$question_id</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	<span class="token keyword keyword-global">global</span> <span class="token variable">$wpdb</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$_watu</span> <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">WatuPRO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//From the question id, get tkhe exam it's affiliated with (exam is a parent entity of the question)</span></span>
<span class="line"><span class="token comment">//Left joining into the Exam table to get advanced settings</span></span>
<span class="line"><span class="token variable">$exam</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">get_row</span><span class="token punctuation">(</span><span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT questions.* , master.advanced_settings FROM "</span> <span class="token operator">.</span> <span class="token constant">WATUPRO_QUESTIONS</span><span class="token operator">.</span><span class="token string double-quoted-string">" as questions LEFT JOIN "</span><span class="token operator">.</span><span class="token constant">WATUPRO_EXAMS</span><span class="token operator">.</span><span class="token string double-quoted-string">" as master ON master.ID = questions.exam_id WHERE questions.ID=%d"</span><span class="token punctuation">,</span> <span class="token variable">$question_id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$exam_id</span> <span class="token operator">=</span> <span class="token variable">$exam</span><span class="token operator">-&gt;</span><span class="token property">exam_id</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//code from show_exam.php (before submit_exam.php)</span></span>
<span class="line"><span class="token variable">$advanced_settings</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">stripslashes</span><span class="token punctuation">(</span><span class="token variable">$exam</span><span class="token operator">-&gt;</span><span class="token property">advanced_settings</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//From the Student Taken Occurences Table (the answers that were chosen will be put here for comparison, to compare to the current answers located in the wp_watupro_answers table).</span></span>
<span class="line"><span class="token variable">$takings</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">get_results</span><span class="token punctuation">(</span><span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT * FROM "</span><span class="token operator">.</span><span class="token constant">WATUPRO_TAKEN_EXAMS</span><span class="token operator">.</span><span class="token string double-quoted-string">" WHERE exam_id=%d ORDER BY ID DESC"</span><span class="token punctuation">,</span> <span class="token variable">$exam_id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//Get all the questions from the Exam Id</span></span>
<span class="line"><span class="token variable">$questions</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">get_results</span><span class="token punctuation">(</span><span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT * FROM "</span><span class="token operator">.</span><span class="token constant">WATUPRO_QUESTIONS</span><span class="token operator">.</span><span class="token string double-quoted-string">" WHERE exam_id=%d"</span><span class="token punctuation">,</span> <span class="token variable">$exam_id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//Iterate through all student taking IDS, then iterate through the questions to calculate totals</span></span>
<span class="line"><span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$takings</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$taking</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$taking_id</span> <span class="token operator">=</span> <span class="token variable">$taking</span><span class="token operator">-&gt;</span><span class="token constant">ID</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$total</span> <span class="token operator">=</span> <span class="token variable">$score</span> <span class="token operator">=</span> <span class="token variable">$max_points</span> <span class="token operator">=</span> <span class="token variable">$achieved</span> <span class="token operator">=</span> <span class="token variable">$num_empty</span> <span class="token operator">=</span> <span class="token variable">$num_wrong</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token comment">//Iterate through the questions to calculate totals</span></span>
<span class="line">	<span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$questions</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$question</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>	</span>
<span class="line">		<span class="token variable">$question_id</span> <span class="token operator">=</span> <span class="token variable">$question</span><span class="token operator">-&gt;</span><span class="token constant">ID</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token comment">//According to the store_result function in the watopro.php lib file, a $question object is a database row.</span></span>
<span class="line">		<span class="token variable">$answers</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">get_results</span><span class="token punctuation">(</span><span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT * FROM "</span><span class="token operator">.</span><span class="token constant">WATUPRO_ANSWERS</span><span class="token operator">.</span><span class="token string double-quoted-string">" WHERE question_id=%d AND question_id&gt;0 ORDER BY sort_order"</span><span class="token punctuation">,</span> <span class="token variable">$question_id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token comment">//this part is necessary for the WTPQuestion::max_scores function. It's looking at this q_answers variable I just put below</span></span>
<span class="line">		<span class="token variable">$question</span><span class="token operator">-&gt;</span><span class="token property">q_answers</span> <span class="token operator">=</span> <span class="token variable">$answers</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token variable">$chosen_answers</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">get_results</span><span class="token punctuation">(</span><span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT * FROM "</span><span class="token operator">.</span><span class="token constant">WATUPRO_STUDENT_ANSWERS</span><span class="token operator">.</span><span class="token string double-quoted-string">" WHERE taking_id=%d AND question_id=%d"</span><span class="token punctuation">,</span> <span class="token variable">$taking_id</span><span class="token punctuation">,</span><span class="token variable">$question_id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token comment">//The entire purpose of getting $chosen_answer_ids is to put as a parameter to WTPQUESTION::calc_answer</span></span>
<span class="line">		<span class="token comment">//THE FOLLOWING IS TO PROTECT the VALUES WHEN THERE ARE COMMAS</span></span>
<span class="line">		<span class="token variable">$chosen_answer_ids</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token variable">$answers_values</span> <span class="token operator">=</span> <span class="token function">array_map</span><span class="token punctuation">(</span><span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token variable">$answer</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword keyword-return">return</span> <span class="token variable">$answer</span><span class="token operator">-&gt;</span><span class="token property">answer</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token variable">$answers</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token variable">$answers_quotes</span> <span class="token operator">=</span> <span class="token function">array_map</span><span class="token punctuation">(</span><span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token variable">$answer_value</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword keyword-return">return</span> <span class="token string single-quoted-string">'"'</span><span class="token operator">.</span> <span class="token variable">$answer_value</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token variable">$answers_values</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token comment">//unfortunately, you have to cross reference the answers the student chose with the correct answer known in the answers table (no join used here)</span></span>
<span class="line">		<span class="token keyword keyword-foreach">foreach</span><span class="token punctuation">(</span><span class="token variable">$chosen_answers</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$chosen_answer</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token punctuation">{</span></span>
<span class="line">			<span class="token comment">//THIS IS THE ANNOYING LONG STRING WITH COMMAS!!!</span></span>
<span class="line">			<span class="token variable">$chosen_answer_full_names</span> <span class="token operator">=</span> <span class="token variable">$chosen_answer</span><span class="token operator">-&gt;</span><span class="token property">answer</span><span class="token punctuation">;</span></span>
<span class="line">			<span class="token variable">$chosen_answer_full_names</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token variable">$answers_values</span><span class="token punctuation">,</span><span class="token variable">$answers_quotes</span><span class="token punctuation">,</span><span class="token variable">$chosen_answer_full_names</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">			<span class="token keyword keyword-foreach">foreach</span><span class="token punctuation">(</span><span class="token function">str_getcsv</span><span class="token punctuation">(</span><span class="token variable">$chosen_answer_full_names</span><span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$chosen_answer_full_name</span><span class="token punctuation">)</span></span>
<span class="line">			<span class="token punctuation">{</span></span>
<span class="line">				<span class="token variable">$chosen_answer_full_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$chosen_answer_full_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">				<span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$answers</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$answer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>		</span>
<span class="line">					<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$chosen_answer_full_name</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$answer</span><span class="token operator">-&gt;</span><span class="token property">answer</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">					<span class="token punctuation">{</span></span>
<span class="line">						<span class="token variable">$chosen_answer_ids</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$answer</span><span class="token operator">-&gt;</span><span class="token constant">ID</span><span class="token punctuation">;</span></span>
<span class="line">					<span class="token punctuation">}</span></span>
<span class="line">				<span class="token punctuation">}</span></span>
<span class="line">			<span class="token punctuation">}</span></span>
<span class="line">		<span class="token punctuation">}</span></span>
<span class="line">		<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token variable">$debug</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token punctuation">{</span></span>
<span class="line">			<span class="token comment">// echo "STUDENT ID: $taking_id\n";</span></span>
<span class="line">			<span class="token comment">// debug_help("QUESTION",$question);</span></span>
<span class="line">			<span class="token comment">// debug_help("ALL ANSWERS",$answers);</span></span>
<span class="line">			<span class="token comment">// debug_help("CHOSEN ANSWER",$chosen_answers);</span></span>
<span class="line">			<span class="token comment">// debug_help("CHOSEN ANSWER IDS",$chosen_answer_ids);</span></span>
<span class="line">		<span class="token punctuation">}</span></span>
<span class="line">		<span class="token comment">//THE POINT OF THOSE SQL CALLS WAS TO CALCULATE THE POINTS &amp; A BOOLEAN IF THE QUESTION WAS CORRECT</span></span>
<span class="line">		<span class="token keyword keyword-list">list</span><span class="token punctuation">(</span><span class="token variable">$points</span><span class="token punctuation">,</span> <span class="token variable">$correct</span><span class="token punctuation">,</span> <span class="token variable">$is_empty</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token class-name static-context">WTPQuestion</span><span class="token operator">::</span><span class="token function">calc_answer</span><span class="token punctuation">(</span><span class="token variable">$question</span><span class="token punctuation">,</span> <span class="token variable">$chosen_answer_ids</span><span class="token punctuation">,</span><span class="token variable">$answers</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token variable">$question_max_points</span> <span class="token operator">=</span> <span class="token class-name static-context">WTPQuestion</span><span class="token operator">::</span><span class="token function">max_points</span><span class="token punctuation">(</span><span class="token variable">$question</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token comment">//calculate total &amp; score</span></span>
<span class="line">		<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token keyword keyword-empty">empty</span><span class="token punctuation">(</span><span class="token variable">$question</span><span class="token operator">-&gt;</span><span class="token property">is_survey</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">$total</span><span class="token operator">++</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token variable">$correct</span><span class="token punctuation">)</span> <span class="token variable">$score</span><span class="token operator">++</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token comment">//calculate percent</span></span>
<span class="line">	  	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token variable">$total</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token variable">$percent</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-else">else</span> <span class="token variable">$percent</span> <span class="token operator">=</span> <span class="token function">number_format</span><span class="token punctuation">(</span><span class="token variable">$score</span> <span class="token operator">/</span> <span class="token variable">$total</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token variable">$percent</span> <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token variable">$percent</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token comment">//get total points that were acquired</span></span>
<span class="line">		<span class="token comment">//the following is a separate grading system based on the amount of points, and not grading based on # right or # wrong. It is weighted.</span></span>
<span class="line">		<span class="token variable">$achieved</span> <span class="token operator">+=</span> <span class="token variable">$points</span><span class="token punctuation">;</span>	</span>
<span class="line">		<span class="token variable">$max_points</span> <span class="token operator">+=</span> <span class="token class-name static-context">WTPQuestion</span><span class="token operator">::</span><span class="token function">max_points</span><span class="token punctuation">(</span><span class="token variable">$question</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token variable">$is_empty</span> <span class="token keyword keyword-and">and</span> <span class="token keyword keyword-empty">empty</span><span class="token punctuation">(</span><span class="token variable">$question</span><span class="token operator">-&gt;</span><span class="token property">is_survey</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token punctuation">{</span></span>
<span class="line">			<span class="token variable">$num_empty</span><span class="token operator">++</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token punctuation">}</span></span>
<span class="line">      	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$is_empty</span> <span class="token keyword keyword-and">and</span> <span class="token operator">!</span><span class="token variable">$correct</span> <span class="token keyword keyword-and">and</span> <span class="token keyword keyword-empty">empty</span><span class="token punctuation">(</span><span class="token variable">$question</span><span class="token operator">-&gt;</span><span class="token property">is_survey</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">      	<span class="token punctuation">{</span></span>
<span class="line">      		<span class="token variable">$num_wrong</span><span class="token operator">++</span><span class="token punctuation">;</span></span>
<span class="line">      	<span class="token punctuation">}</span></span>
<span class="line">		<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token variable">$achieved</span> <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token keyword keyword-or">or</span> <span class="token variable">$max_points</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">		<span class="token punctuation">{</span></span>
<span class="line">			<span class="token variable">$pointspercent</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token punctuation">}</span></span>
<span class="line">		<span class="token keyword keyword-else">else</span></span>
<span class="line">		<span class="token punctuation">{</span></span>
<span class="line">			<span class="token variable">$pointspercent</span> <span class="token operator">=</span> <span class="token function">number_format</span><span class="token punctuation">(</span><span class="token variable">$achieved</span> <span class="token operator">/</span> <span class="token variable">$max_points</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token punctuation">}</span></span>
<span class="line">		<span class="token comment">//generic rating, doesn't matter as much as above</span></span>
<span class="line">		<span class="token variable">$rating</span> <span class="token operator">=</span> <span class="token variable">$_watu</span><span class="token operator">-&gt;</span><span class="token function">calculate_rating</span><span class="token punctuation">(</span><span class="token variable">$total</span><span class="token punctuation">,</span> <span class="token variable">$score</span><span class="token punctuation">,</span> <span class="token variable">$percent</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	</span>
<span class="line">	<span class="token punctuation">}</span><span class="token comment">//end question iteration</span></span>
<span class="line">	<span class="token comment">//Grade tabulating should not be in the question for-loop above, just as it is in submit-exam.php</span></span>
<span class="line">	<span class="token keyword keyword-list">list</span><span class="token punctuation">(</span><span class="token variable">$grade</span><span class="token punctuation">,</span> <span class="token variable">$certificate_id</span><span class="token punctuation">,</span> <span class="token variable">$do_redirect</span><span class="token punctuation">,</span> <span class="token variable">$grade_obj</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token class-name static-context">WTPGrade</span><span class="token operator">::</span><span class="token function">calculate</span><span class="token punctuation">(</span><span class="token variable">$exam_id</span><span class="token punctuation">,</span> <span class="token variable">$achieved</span><span class="token punctuation">,</span> <span class="token variable">$percent</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$user_grade_ids</span><span class="token punctuation">,</span> <span class="token variable">$pointspercent</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$grade_value</span> <span class="token operator">=</span> <span class="token variable">$grade_obj</span><span class="token operator">-&gt;</span><span class="token property">gtitle</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token variable">$debug</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token punctuation">{</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"STUDENT TEST OCCURENCE: <span class="token interpolation"><span class="token variable">$taking_id</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"POINTS: <span class="token interpolation"><span class="token variable">$points</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"PERCENT: <span class="token interpolation"><span class="token variable">$percent</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"SCORE: <span class="token interpolation"><span class="token variable">$score</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"TOTAL: <span class="token interpolation"><span class="token variable">$total</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"MAX POINTS: <span class="token interpolation"><span class="token variable">$max_points</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"RATING: <span class="token interpolation"><span class="token variable">$rating</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"ACHIEVED: <span class="token interpolation"><span class="token variable">$achieved</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"POINTS PERCENT: <span class="token interpolation"><span class="token variable">$pointspercent</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"GRADE: <span class="token interpolation"><span class="token variable">$grade</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"GRADE: <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$grade_obj</span><span class="token operator">-&gt;</span><span class="token constant">ID</span><span class="token punctuation">}</span></span>\n"</span><span class="token punctuation">;</span>		</span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"NUM EMPTY: <span class="token interpolation"><span class="token variable">$num_empty</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"NUM WRONG: <span class="token interpolation"><span class="token variable">$num_wrong</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"\n\n\n\n\n\n"</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">	<span class="token comment">//points = all points combined ($achieved)</span></span>
<span class="line">	<span class="token comment">//result = String HTML of Grade</span></span>
<span class="line">	<span class="token comment">//grade_id = ID of Grade</span></span>
<span class="line">	<span class="token comment">//percent_correct = 75 (based on right vs wrong)</span></span>
<span class="line">	<span class="token comment">//percent_points = 82 (based on points) $pointpercent</span></span>
<span class="line">	<span class="token comment">//num_correct = Number of Raw correct in entire exam (known as $score)</span></span>
<span class="line">	<span class="token comment">//num_wrong = num_wrong</span></span>
<span class="line">	<span class="token comment">//num_empty = num_empty</span></span>
<span class="line">	<span class="token comment">//max_points = max_points</span></span>
<span class="line">	<span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token constant">WATUPRO_TAKEN_EXAMS</span><span class="token punctuation">,</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span></span>
<span class="line">	    	<span class="token string double-quoted-string">"points"</span> <span class="token operator">=&gt;</span> <span class="token variable">$achieved</span><span class="token punctuation">,</span></span>
<span class="line">			<span class="token string double-quoted-string">"result"</span> <span class="token operator">=&gt;</span> <span class="token variable">$grade</span><span class="token punctuation">,</span></span>
<span class="line">			<span class="token string double-quoted-string">"grade_id"</span> <span class="token operator">=&gt;</span> <span class="token variable">$grade_obj</span><span class="token operator">-&gt;</span><span class="token constant">ID</span><span class="token punctuation">,</span></span>
<span class="line">			<span class="token string double-quoted-string">"percent_correct"</span> <span class="token operator">=&gt;</span> <span class="token variable">$percent</span><span class="token punctuation">,</span></span>
<span class="line">			<span class="token string double-quoted-string">"percent_points"</span> <span class="token operator">=&gt;</span> <span class="token variable">$pointspercent</span><span class="token punctuation">,</span></span>
<span class="line">			<span class="token string double-quoted-string">"num_correct"</span> <span class="token operator">=&gt;</span> <span class="token variable">$score</span><span class="token punctuation">,</span></span>
<span class="line">			<span class="token string double-quoted-string">"num_wrong"</span> <span class="token operator">=&gt;</span> <span class="token variable">$num_wrong</span><span class="token punctuation">,</span></span>
<span class="line">			<span class="token string double-quoted-string">"num_empty"</span> <span class="token operator">=&gt;</span> <span class="token variable">$num_empty</span><span class="token punctuation">,</span></span>
<span class="line">			<span class="token string double-quoted-string">"max_points"</span> <span class="token operator">=&gt;</span> <span class="token variable">$max_points</span></span>
<span class="line">	    <span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">		<span class="token keyword keyword-array">array</span><span class="token punctuation">(</span></span>
<span class="line">			<span class="token string double-quoted-string">"id"</span><span class="token operator">=&gt;</span><span class="token variable">$taking_id</span></span>
<span class="line">		<span class="token punctuation">)</span>	</span>
<span class="line">	<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$result</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token comment">//end taking exam occurence iteration</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment">////////////////////</span></span>
<span class="line"><span class="token comment">//</span></span>
<span class="line"><span class="token comment">//  SECOND TWEAK (UPDATE THE OTHER TABLE AS WELL, WHICH IS THE WP_WATUPRO_STUDENT_PLUGIN APP. THE REASON FOR THIS IS TO UPDATE THE SINGLE PAGE VIEW OF THE EXAM TAKEN OCCURENCES, AS IT READS FROM THAT TABLE!!!</span></span>
<span class="line"><span class="token comment">//</span></span>
<span class="line"><span class="token comment">//////////////////// </span></span>
<span class="line"><span class="token variable">$student_answers</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">get_results</span><span class="token punctuation">(</span><span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT * FROM "</span><span class="token operator">.</span><span class="token constant">WATUPRO_STUDENT_ANSWERS</span><span class="token operator">.</span><span class="token string double-quoted-string">" WHERE exam_id=%d ORDER BY ID DESC "</span><span class="token punctuation">,</span><span class="token variable">$exam_id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$student_answers</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$key</span> <span class="token operator">=&gt;</span> <span class="token variable">$student_answer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">	<span class="token variable">$student_answer_question_id</span> <span class="token operator">=</span> <span class="token variable">$student_answer</span><span class="token operator">-&gt;</span><span class="token property">question_id</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$answers</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">get_results</span><span class="token punctuation">(</span><span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT * FROM "</span><span class="token operator">.</span><span class="token constant">WATUPRO_ANSWERS</span><span class="token operator">.</span> <span class="token string double-quoted-string">" WHERE question_id=%d  AND question_id&gt;0 ORDER BY sort_order"</span><span class="token punctuation">,</span><span class="token variable">$student_answer_question_id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$question</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">get_row</span><span class="token punctuation">(</span><span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT * FROM "</span><span class="token operator">.</span><span class="token constant">WATUPRO_QUESTIONS</span><span class="token operator">.</span> <span class="token string double-quoted-string">" WHERE ID=%d"</span><span class="token punctuation">,</span><span class="token variable">$student_answer_question_id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$question</span><span class="token operator">-&gt;</span><span class="token property">q_answers</span> <span class="token operator">=</span> <span class="token variable">$answers</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$answers_values</span> <span class="token operator">=</span> <span class="token function">array_map</span><span class="token punctuation">(</span><span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token variable">$answer</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword keyword-return">return</span> <span class="token variable">$answer</span><span class="token operator">-&gt;</span><span class="token property">answer</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token variable">$answers</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$answers_quotes</span> <span class="token operator">=</span> <span class="token function">array_map</span><span class="token punctuation">(</span><span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token variable">$answer_value</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword keyword-return">return</span> <span class="token string single-quoted-string">'"'</span><span class="token operator">.</span> <span class="token variable">$answer_value</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token variable">$answers_values</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	</span>
<span class="line">	<span class="token variable">$chosen_answer_ids</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$chosen_answer_full_names</span> <span class="token operator">=</span> <span class="token variable">$student_answer</span><span class="token operator">-&gt;</span><span class="token property">answer</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token variable">$chosen_answer_full_names</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token variable">$answers_values</span><span class="token punctuation">,</span><span class="token variable">$answers_quotes</span><span class="token punctuation">,</span><span class="token variable">$chosen_answer_full_names</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-foreach">foreach</span><span class="token punctuation">(</span><span class="token function">str_getcsv</span><span class="token punctuation">(</span><span class="token variable">$chosen_answer_full_names</span><span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$chosen_answer_full_name</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token punctuation">{</span></span>
<span class="line">		<span class="token variable">$chosen_answer_full_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$chosen_answer_full_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$answers</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$answer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>		</span>
<span class="line">			<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$chosen_answer_full_name</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$answer</span><span class="token operator">-&gt;</span><span class="token property">answer</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">			<span class="token punctuation">{</span></span>
<span class="line">				<span class="token variable">$chosen_answer_ids</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$answer</span><span class="token operator">-&gt;</span><span class="token constant">ID</span><span class="token punctuation">;</span></span>
<span class="line">			<span class="token punctuation">}</span></span>
<span class="line">		<span class="token punctuation">}</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">	<span class="token keyword keyword-list">list</span><span class="token punctuation">(</span><span class="token variable">$points</span><span class="token punctuation">,</span> <span class="token variable">$correct</span><span class="token punctuation">,</span> <span class="token variable">$is_empty</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token class-name static-context">WTPQuestion</span><span class="token operator">::</span><span class="token function">calc_answer</span><span class="token punctuation">(</span><span class="token variable">$question</span><span class="token punctuation">,</span> <span class="token variable">$chosen_answer_ids</span><span class="token punctuation">,</span><span class="token variable">$answers</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-if">if</span><span class="token punctuation">(</span><span class="token variable">$debug</span><span class="token punctuation">)</span></span>
<span class="line">	<span class="token punctuation">{</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"-------\n"</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"POINTS: <span class="token interpolation"><span class="token variable">$points</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"CORRECT: <span class="token interpolation"><span class="token variable">$correct</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword keyword-echo">echo</span> <span class="token string double-quoted-string">"IS EMPTY: <span class="token interpolation"><span class="token variable">$is_empty</span></span>\n"</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line">	<span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$wpdb</span><span class="token operator">-&gt;</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token constant">WATUPRO_STUDENT_ANSWERS</span><span class="token punctuation">,</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span></span>
<span class="line">	    	<span class="token string double-quoted-string">"points"</span> <span class="token operator">=&gt;</span> <span class="token variable">$points</span><span class="token punctuation">,</span></span>
<span class="line">			<span class="token string double-quoted-string">"is_correct"</span> <span class="token operator">=&gt;</span> <span class="token variable">$correct</span><span class="token punctuation">,</span></span>
<span class="line">	    <span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">		<span class="token keyword keyword-array">array</span><span class="token punctuation">(</span></span>
<span class="line">			<span class="token string double-quoted-string">"ID"</span><span class="token operator">=&gt;</span><span class="token variable">$student_answer</span><span class="token operator">-&gt;</span><span class="token constant">ID</span></span>
<span class="line">		<span class="token punctuation">)</span></span>
<span class="line">	<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token keyword keyword-echo">echo</span> <span class="token variable">$result</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">////////////////////</span></span>
<span class="line"><span class="token comment">//</span></span>
<span class="line"><span class="token comment">//  END CHANGING THE SINGLE VIEW SECTION IN THE WP_WATUPRO_STUDENT_PLUGIN</span></span>
<span class="line"><span class="token comment">//</span></span>
<span class="line"><span class="token comment">////////////////////</span></span>
<span class="line"><span class="token punctuation">}</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">React</div>
                <div class="description">(app.js)Test out when the hooks for a functional &amp; class component are called with a counter in React.js</div>
                <div class="languages">JS</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-js" tabindex="0">                <code class="language-js"><span class="line"><span class="token keyword keyword-import">import</span> <span class="token punctuation">{</span> Provider <span class="token punctuation">}</span> <span class="token keyword keyword-from">from</span> <span class="token string">'react-redux'</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> <span class="token string">'../styles/App.css'</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> CounterClass <span class="token keyword keyword-from">from</span> <span class="token string">"./CounterClass.js"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> CounterFunctional <span class="token keyword keyword-from">from</span> <span class="token string">"./CounterFunctional.js"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> ReduxResult <span class="token keyword keyword-from">from</span> <span class="token string">'./ReduxResult.js'</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> Log <span class="token keyword keyword-from">from</span> <span class="token string">'./Log.js'</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> store <span class="token keyword keyword-from">from</span> <span class="token string">"./ReduxStore.js"</span><span class="token punctuation">;</span></span>
<span class="line">  </span>
<span class="line">  </span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">&gt;</span></span>
<span class="line">        <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"App flex bg-red-500 min-h-screen"</span><span class="token operator">&gt;</span></span>
<span class="line">                <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"flex flex-1 justify-center items-center flex-col min-h-screen bg-slate-900"</span><span class="token operator">&gt;</span></span>
<span class="line">                    <span class="token operator">&lt;</span>CounterClass id<span class="token operator">=</span><span class="token string">"1"</span> <span class="token operator">/</span><span class="token operator">&gt;</span></span>
<span class="line">                    <span class="token operator">&lt;</span>CounterFunctional id<span class="token operator">=</span><span class="token string">"2"</span> <span class="token operator">/</span><span class="token operator">&gt;</span></span>
<span class="line">                    <span class="token operator">&lt;</span>ReduxResult <span class="token operator">/</span><span class="token operator">&gt;</span></span>
<span class="line">                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">                <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"flex flex-1 flex-col w-full justify-end p-8 min-h-screen bg-slate-950"</span><span class="token operator">&gt;</span></span>
<span class="line">                    <span class="token operator">&lt;</span>Log<span class="token operator">/</span><span class="token operator">&gt;</span></span>
<span class="line">                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">           </span>
<span class="line">        </span>
<span class="line">    <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-export">export</span> <span class="token keyword keyword-default">default</span> App<span class="token punctuation">;</span></span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">React</div>
                <div class="description">(counter.js) Test out when the hooks for a functional &amp; class component are called with a counter in React.js</div>
                <div class="languages">JS</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-js" tabindex="0">                <code class="language-js"><span class="line"><span class="token keyword keyword-import">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword keyword-from">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> styles <span class="token keyword keyword-from">from</span> <span class="token string">'../styles/styles.module.css'</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> <span class="token punctuation">{</span> Toaster<span class="token punctuation">,</span> toast <span class="token punctuation">}</span> <span class="token keyword keyword-from">from</span> <span class="token string">'sonner'</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword keyword-const">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword keyword-const">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> setText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token keyword keyword-const">const</span> <span class="token function-variable function">handlePlusClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token function">toast</span><span class="token punctuation">(</span><span class="token string">'Plus'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token keyword keyword-const">const</span> <span class="token function-variable function">handleMinusClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token function">toast</span><span class="token punctuation">(</span><span class="token string">'Minus'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token keyword keyword-const">const</span> <span class="token function-variable function">handleTextChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">setText</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"flex items-center justify-center"</span><span class="token operator">&gt;</span></span>
<span class="line">      </span>
<span class="line">      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"flex"</span><span class="token operator">&gt;</span></span>
<span class="line">        <span class="token operator">&lt;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleTextChange<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span>button className<span class="token operator">=</span><span class="token string">"flex"</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span>handlePlusClick<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span>button className<span class="token operator">=</span><span class="token string">"flex"</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleMinusClick<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-export">export</span> <span class="token keyword keyword-default">default</span> Counter<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">React</div>
                <div class="description">(counterclass.js) Test out when the hooks for a functional &amp; class component are called with a counter in React.js</div>
                <div class="languages">JS</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-js" tabindex="0">                <code class="language-js"><span class="line"><span class="token keyword keyword-import">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword keyword-from">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> styles <span class="token keyword keyword-from">from</span> <span class="token string">'../styles/styles.module.css'</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword keyword-from">from</span> <span class="token string">'react-redux'</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> <span class="token punctuation">{</span> increment<span class="token punctuation">,</span> decrement<span class="token punctuation">,</span> push_to_log <span class="token punctuation">}</span> <span class="token keyword keyword-from">from</span> <span class="token string">'./ReduxStore.js'</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-class">class</span> <span class="token class-name">ClassCounter</span> <span class="token keyword keyword-extends">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-super">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Order: 0 - Constructor: Initializes state, binds methods.</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Class Component) Component Did Mount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Order: 3 - After component insertion. Good for API calls.</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span><span class="token parameter">nextProps<span class="token punctuation">,</span> nextState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Class Component) Should Component Update'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Order: 4 (before each update) - Decides if re-rendering is needed.</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Class Component) Get Snapshot Before Update'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Order: 6 (before each DOM update) - Right before DOM updates.</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">,</span> snapshot</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Class Component) Component Did Update'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Order: 7 (after each update) - After updates are flushed to the DOM.</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Class Component) Component Will Unmount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Order: 8 (before unmounting) - Before removal from the DOM. Good for cleanup.</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token function-variable function">handlePlusClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Class Component) '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Class Component) Increment'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Order: 5 (during update) - Increment count.</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token function-variable function">handleMinusClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">decrement</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Class Component) '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Class Component) Decrement'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Order: 5 (during update) - Decrement count.</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Class Component) Render'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Order: 1 (initial), 2 (on each update) - Outputs JSX to the DOM.</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span></span>
<span class="line">        <span class="token operator">&lt;</span>div <span class="token keyword keyword-class">class</span><span class="token operator">=</span><span class="token string">"flex flex-col mb-2"</span><span class="token operator">&gt;</span></span>
<span class="line">            <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"flex justify-center mb-1"</span><span class="token operator">&gt;</span></span>
<span class="line">                Class Component</span>
<span class="line">            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">            <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"flex flex-row mb-1"</span><span class="token operator">&gt;</span></span>
<span class="line">                <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;</span></span>
<span class="line">                    <span class="token operator">&lt;</span>input className<span class="token operator">=</span><span class="token string">"h-8 p-1"</span> value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span></span>
<span class="line">                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">                <span class="token operator">&lt;</span>button className<span class="token operator">=</span><span class="token string">"h-8 w-8 ml-1 bg-slate-700"</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>handlePlusClick<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span></span>
<span class="line">                <span class="token operator">&lt;</span>button className<span class="token operator">=</span><span class="token string">"h-8 w-8 ml-1 bg-slate-700"</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword keyword-this">this</span><span class="token punctuation">.</span>handleMinusClick<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span></span>
<span class="line">            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-const">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> ownProps</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">count</span><span class="token operator">:</span> state<span class="token punctuation">.</span>counter<span class="token punctuation">.</span>counters<span class="token punctuation">[</span>ownProps<span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// Access count for specific id,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-const">const</span> mapDispatchToProps <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    increment<span class="token punctuation">,</span></span>
<span class="line">    decrement<span class="token punctuation">,</span></span>
<span class="line">    push_to_log</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-export">export</span> <span class="token keyword keyword-default">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>ClassCounter<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">React</div>
                <div class="description">(counterfunctional.js) Test out when the hooks for a functional &amp; class component are called with a counter in React.js</div>
                <div class="languages">JS</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-js" tabindex="0">                <code class="language-js"><span class="line"><span class="token keyword keyword-import">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useLayoutEffect <span class="token punctuation">}</span> <span class="token keyword keyword-from">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> <span class="token punctuation">{</span> increment<span class="token punctuation">,</span> decrement<span class="token punctuation">,</span> push_to_log <span class="token punctuation">}</span> <span class="token keyword keyword-from">from</span> <span class="token string">"./ReduxStore.js"</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> <span class="token punctuation">{</span> useDispatch <span class="token punctuation">}</span> <span class="token keyword keyword-from">from</span> <span class="token string">"react-redux"</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function">CounterFunctional</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> id <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword keyword-const">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-const">const</span> dispatch <span class="token operator">=</span> <span class="token function">useDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  </span>
<span class="line">  <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Functional Component) useState'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token comment">// Order: 0 (on each render) - useState: Adds state to functional components.</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Functional Component) useEffect - Mount'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Order: 2 (after first render) - Similar to componentDidMount and componentDidUpdate.</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Functional Component) useEffect - Cleanup'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token comment">// Order: 7 (before unmounting) - Cleanup: Similar to componentWillUnmount.</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Functional Component) useEffect - {count} Update'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Order: 3 (after each update) - Runs on state/props update with dependency array.</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token function">useLayoutEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Functional Component) useLayoutEffect'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Order: 1 (after each render before DOM updates) - Fires synchronously after all DOM mutations.</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token keyword keyword-const">const</span> <span class="token function-variable function">handlePlusClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Functional Component) '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Functional Component) Increment'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">increment</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span>
<span class="line">    <span class="token comment">// Order: 4 (during update) - Increment count.</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token keyword keyword-const">const</span> <span class="token function-variable function">handleMinusClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">decrement</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span>
<span class="line">    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Functional Component) '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token string">'(Functional Component) Decrement'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Order: 4 (during update) - Decrement count.</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token operator">&lt;</span>div <span class="token keyword keyword-class">class</span><span class="token operator">=</span><span class="token string">"flex flex-col mb-5"</span><span class="token operator">&gt;</span></span>
<span class="line">        <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"flex justify-center mb-1"</span><span class="token operator">&gt;</span></span>
<span class="line">            Functional Component</span>
<span class="line">        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">        <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"flex flex-row mb-1"</span><span class="token operator">&gt;</span></span>
<span class="line">            <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;</span></span>
<span class="line">                <span class="token operator">&lt;</span>input className<span class="token operator">=</span><span class="token string">"h-8 p-1"</span> value<span class="token operator">=</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span></span>
<span class="line">            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">            <span class="token operator">&lt;</span>button className<span class="token operator">=</span><span class="token string">"h-8 w-8 ml-1 bg-slate-700"</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span>handlePlusClick<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span></span>
<span class="line">            <span class="token operator">&lt;</span>button className<span class="token operator">=</span><span class="token string">"h-8 w-8 ml-1 bg-slate-700"</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleMinusClick<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span></span>
<span class="line">        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-export">export</span> <span class="token keyword keyword-default">default</span> CounterFunctional<span class="token punctuation">;</span></span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">React</div>
                <div class="description">(log.js) Test out when the hooks for a functional &amp; class component are called with a counter in React.js</div>
                <div class="languages">JS</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-js" tabindex="0">                <code class="language-js"><span class="line"><span class="token keyword keyword-import">import</span> React <span class="token keyword keyword-from">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> <span class="token punctuation">{</span> useSelector <span class="token punctuation">}</span> <span class="token keyword keyword-from">from</span> <span class="token string">"react-redux"</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-export">export</span> <span class="token keyword keyword-const">const</span> <span class="token function-variable function">Log</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token keyword keyword-const">const</span> log_list <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>log<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>   </span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token operator">&lt;</span>div <span class="token keyword keyword-class">class</span><span class="token operator">=</span><span class="token string">"flex"</span><span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span>ul className<span class="token operator">=</span><span class="token string">"w-3/4"</span><span class="token operator">&gt;</span></span>
<span class="line">        <span class="token punctuation">{</span>log_list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entry<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span></span>
<span class="line">          <span class="token operator">&lt;</span>li className<span class="token operator">=</span><span class="token string">"bg-gradient-to-r from-[#FF3300] to-purple-400 text-[#330033] font-verdana text-[13px] font-bold mb-2 rounded shadow px-2 py-[1px] border-white border-[0px]"</span> key<span class="token operator">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>entry<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span></span>
<span class="line">        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-export">export</span> <span class="token keyword keyword-default">default</span> Log<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">React</div>
                <div class="description">(reduxresult.js) Test out when the hooks for a functional &amp; class component are called with a counter in React.js</div>
                <div class="languages">JS</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-js" tabindex="0">                <code class="language-js"><span class="line"><span class="token keyword keyword-import">import</span> React <span class="token keyword keyword-from">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-import">import</span> <span class="token punctuation">{</span> useSelector <span class="token punctuation">}</span> <span class="token keyword keyword-from">from</span> <span class="token string">'react-redux'</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-function">function</span> <span class="token function">ReduxResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword keyword-const">const</span> counters <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>counter<span class="token punctuation">.</span>counters<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword keyword-const">const</span> total <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>counters<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">sum<span class="token punctuation">,</span> current</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> sum <span class="token operator">+</span> current<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">  <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span><span class="token punctuation">(</span>Redux<span class="token punctuation">)</span> Total Count<span class="token operator">:</span> <span class="token punctuation">{</span>total<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-export">export</span> <span class="token keyword keyword-default">default</span> ReduxResult<span class="token punctuation">;</span></span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">React</div>
                <div class="description">(reduxstore.js) Test out when the hooks for a functional &amp; class component are called with a counter in React.js</div>
                <div class="languages">JS</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-js" tabindex="0">                <code class="language-js"><span class="line"><span class="token keyword keyword-import">import</span> <span class="token punctuation">{</span> configureStore<span class="token punctuation">,</span> createSlice <span class="token punctuation">}</span> <span class="token keyword keyword-from">from</span> <span class="token string">'@reduxjs/toolkit'</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-const">const</span> counterSlice <span class="token operator">=</span> <span class="token function">createSlice</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'counter'</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">initialState</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">counters</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// Object to hold individual counters</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">reducers</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function-variable function">increment</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-const">const</span> id <span class="token operator">=</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">;</span> <span class="token comment">// id of the counter to increment</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>state<span class="token punctuation">.</span>counters<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token keyword keyword-undefined">undefined</span><span class="token punctuation">)</span> state<span class="token punctuation">.</span>counters<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">            state<span class="token punctuation">.</span>counters<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token function-variable function">decrement</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword keyword-const">const</span> id <span class="token operator">=</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">;</span> <span class="token comment">// id of the counter to decrement</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>state<span class="token punctuation">.</span>counters<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token keyword keyword-undefined">undefined</span><span class="token punctuation">)</span> state<span class="token punctuation">.</span>counters<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">            state<span class="token punctuation">.</span>counters<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-const">const</span> logSlice <span class="token operator">=</span> <span class="token function">createSlice</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'log'</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">initialState</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">log</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">reducers</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">push_to_log</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            state<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>log<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">18</span><span class="token punctuation">)</span> state<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-export">export</span> <span class="token keyword keyword-const">const</span> <span class="token punctuation">{</span> increment<span class="token punctuation">,</span> decrement <span class="token punctuation">}</span> <span class="token operator">=</span> counterSlice<span class="token punctuation">.</span>actions<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword keyword-export">export</span> <span class="token keyword keyword-const">const</span> <span class="token punctuation">{</span> push_to_log <span class="token punctuation">}</span> <span class="token operator">=</span> logSlice<span class="token punctuation">.</span>actions<span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-const">const</span> store <span class="token operator">=</span> <span class="token function">configureStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line"><span class="token literal-property property">reducer</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">counter</span><span class="token operator">:</span> counterSlice<span class="token punctuation">.</span>reducer<span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">log</span><span class="token operator">:</span> logSlice<span class="token punctuation">.</span>reducer</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-export">export</span> <span class="token keyword keyword-default">default</span> store<span class="token punctuation">;</span></span>
<span class="line"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>        <section>
            <div class="project_header">
                
                <div class="project_name">LeetCode</div>
                <div class="description">Growing list of grinding LeetCode algorithms on my own (Note- ChatGPT did the comments)</div>
                <div class="languages">Python</div>
                <div class="portfolio" onclick="window.location.href = &#39;https://mmulcahy222.github.io/portfolio.html&#39;">Click for Portfolio</div>
            </div>
            <div class="code-toolbar"><pre class="line-numbers language-python" tabindex="0">                <code class="language-python"><span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">permutation_in_string</span></span><span class="token punctuation">(</span>small_string<span class="token punctuation">,</span>long_string<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">'''</span>
<span class="line">    is a permutation of small string in long string (true or false)</span>
<span class="line">&nbsp;</span>
<span class="line">    NOTE: NEETCODE DID A FREQUENCY ARRAY OF A TO Z, OF 26 KEY ENTRIES</span>
<span class="line">    '''</span></span>
<span class="line">    length_small_string <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>small_string<span class="token punctuation">)</span></span>
<span class="line">    length_long_string <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>long_string<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># fill dict of small string</span></span>
<span class="line">    char_map_small_string <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-for">for</span> l <span class="token keyword keyword-in">in</span> small_string<span class="token punctuation">:</span></span>
<span class="line">        char_map_small_string<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">=</span> char_map_small_string<span class="token punctuation">.</span>get<span class="token punctuation">(</span>l<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token comment"># fill dict of sliding window that's fixed</span></span>
<span class="line">    char_map_sliding_window <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> </span>
<span class="line">    <span class="token keyword keyword-for">for</span> l <span class="token keyword keyword-in">in</span> long_string<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>length_small_string<span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="line">        char_map_sliding_window<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">=</span> char_map_sliding_window<span class="token punctuation">.</span>get<span class="token punctuation">(</span>l<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token comment"># sliding window from left to right, fixed size</span></span>
<span class="line">    <span class="token keyword keyword-for">for</span> right <span class="token keyword keyword-in">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>length_small_string<span class="token punctuation">,</span>length_long_string<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        left <span class="token operator">=</span> right <span class="token operator">-</span> length_small_string</span>
<span class="line">        letter_right <span class="token operator">=</span> long_string<span class="token punctuation">[</span>right<span class="token punctuation">]</span></span>
<span class="line">        letter_left <span class="token operator">=</span> long_string<span class="token punctuation">[</span>left<span class="token punctuation">]</span></span>
<span class="line">        <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>char_map_small_string<span class="token punctuation">,</span>char_map_sliding_window<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> char_map_sliding_window <span class="token operator">==</span> char_map_small_string<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword keyword-return">return</span> <span class="token boolean">True</span></span>
<span class="line">        <span class="token comment"># the character map will reflect when the sliding window moves right</span></span>
<span class="line">        char_map_sliding_window<span class="token punctuation">[</span>letter_left<span class="token punctuation">]</span> <span class="token operator">=</span> char_map_sliding_window<span class="token punctuation">[</span>letter_left<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span></span>
<span class="line">        <span class="token comment"># do this for equality. Remove from charmap if it's zero</span></span>
<span class="line">        <span class="token keyword keyword-if">if</span> char_map_sliding_window<span class="token punctuation">[</span>letter_left<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword keyword-del">del</span> char_map_sliding_window<span class="token punctuation">[</span>letter_left<span class="token punctuation">]</span></span>
<span class="line">        char_map_sliding_window<span class="token punctuation">[</span>letter_right<span class="token punctuation">]</span> <span class="token operator">=</span> char_map_sliding_window<span class="token punctuation">.</span>get<span class="token punctuation">(</span>letter_right<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span></span>
<span class="line">&nbsp;</span>
<span class="line">    <span class="token keyword keyword-return">return</span> <span class="token boolean">False</span></span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># permutation_in_string("abee","fibembaeewellon")</span></span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token keyword keyword-def">def</span> <span class="token function"><span class="token function-name variable">minimum_window_substring</span></span><span class="token punctuation">(</span>string_small<span class="token punctuation">,</span> string_long<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># Create a set of unique characters in the small string</span></span>
<span class="line">    set_string_small <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>string_small<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># Map each character in the small string to its count</span></span>
<span class="line">    char_map_string_small <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword keyword-for">for</span> c <span class="token keyword keyword-in">in</span> string_small<span class="token punctuation">:</span></span>
<span class="line">        char_map_string_small<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> char_map_string_small<span class="token punctuation">.</span>get<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span></span>
<span class="line">        <span class="token comment"># Initialize a deque </span></span>
<span class="line">        stack <span class="token operator">=</span> deque<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># Initialize a map to keep track of characters in the long string</span></span>
<span class="line">        char_map_string_long <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token comment"># Initialize variables for the final result</span></span>
<span class="line">        max_length <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">        result <span class="token operator">=</span> <span class="token string">''</span></span>
<span class="line">        <span class="token comment"># Iterate over each character in the long string</span></span>
<span class="line">        <span class="token keyword keyword-for">for</span> index<span class="token punctuation">,</span> character_long <span class="token keyword keyword-in">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>string_long<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token comment"># If the character is in the small string</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> character_long <span class="token keyword keyword-in">in</span> set_string_small<span class="token punctuation">:</span></span>
<span class="line">                <span class="token comment"># Add the character to the window stack</span></span>
<span class="line">                stack<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>character_long<span class="token punctuation">,</span> index<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token comment"># Update the character count in the long string map</span></span>
<span class="line">                char_map_string_long<span class="token punctuation">[</span>character_long<span class="token punctuation">]</span> <span class="token operator">=</span> char_map_string_long<span class="token punctuation">.</span>get<span class="token punctuation">(</span>character_long<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span></span>
<span class="line">                <span class="token comment"># Update the right pointer to the current index</span></span>
<span class="line">                right <span class="token operator">=</span> index</span>
<span class="line">                <span class="token comment"># If the window size exceeds the small string size, remove the leftmost character</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>stack<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>string_small<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">                    <span class="token comment"># Remove the leftmost character from the window</span></span>
<span class="line">                    pop_node <span class="token operator">=</span> stack<span class="token punctuation">.</span>popleft<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                    removed_character <span class="token operator">=</span> pop_node<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">                    removed_position <span class="token operator">=</span> pop_node<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">                    <span class="token comment"># Update the left pointer to the removed character's position</span></span>
<span class="line">                    left <span class="token operator">=</span> removed_position</span>
<span class="line">                    <span class="token comment"># Decrease the character count in the long string map</span></span>
<span class="line">                    char_map_string_long<span class="token punctuation">[</span>removed_character<span class="token punctuation">]</span> <span class="token operator">=</span> char_map_string_long<span class="token punctuation">.</span>get<span class="token punctuation">(</span>removed_character<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span></span>
<span class="line">            <span class="token comment"># If the character counts in the small and long string maps match</span></span>
<span class="line">            <span class="token keyword keyword-if">if</span> char_map_string_small <span class="token operator">==</span> char_map_string_long<span class="token punctuation">:</span></span>
<span class="line">                <span class="token comment"># Calculate the length of the current window</span></span>
<span class="line">                string_length <span class="token operator">=</span> stack<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> stack<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">                <span class="token comment"># Update the maximum length found so far</span></span>
<span class="line">                max_length <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>max_length<span class="token punctuation">,</span> string_length<span class="token punctuation">)</span></span>
<span class="line">                <span class="token comment"># If the current window is smaller than the maximum length, update the result</span></span>
<span class="line">                <span class="token keyword keyword-if">if</span> string_length <span class="token operator">&lt;=</span> max_length<span class="token punctuation">:</span></span>
<span class="line">                    result <span class="token operator">=</span> string_long<span class="token punctuation">[</span>stack<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> stack<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token comment"># Return the minimum window substring</span></span>
<span class="line">    <span class="token keyword keyword-return">return</span> result</span>
<span class="line">            </span>
<span class="line">&nbsp;</span>
<span class="line"><span class="token comment"># minimum_window_substring("abc","adobecodebanc")</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></span></code>
            </pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
        </section>    
    


    <script src="assets/js/prism.js"></script>
    <script src="assets/js/prism-python.min.js"></script>
    

    <script>
    // /*

    initial_description_font_size = 25;

    document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre code').forEach((block) => {
            block.innerHTML = block.innerHTML.split('\n').map((line) => {
                if(line.length == 0) line = '&nbsp;';
                return `<span class="line">${line}</span>`;
            }).join('\n');
        });
        // document.querySelectorAll('.description').forEach(el => {
        //     text_length = el.innerText.length;
        //     new_font_size = initial_description_font_size - (text_length / 20);
        //     el.style.fontSize = `${new_font_size}px`;
        // });
    });



    

// // Function to generate a random HSL color object
// function getColor() { 
//   return {
//     hue: 360 * Math.random(),
//     saturation: 25 + 70 * Math.random(),
//     lightness: 90
//   };
// }


// const observerCallback = (entries, observer) => {
//   entries.forEach(entry => {
//     if (entry.isIntersecting) {
//         // Generate a random hue for the first color stop
//         let hue1 = Math.floor(Math.random() * 360);
//         // Calculate the hue for the second color stop, ensuring it doesn't exceed 360
//         let hue2 = (hue1 + 30) % 360; // Assuming a difference of 30 degrees for example

//         // Construct the HSL color strings with the new random hues
//         let hslColor1 = `hsla(${hue1}, 100%, 89%, 1)`;
//         let hslColor2 = `hsla(${hue2}, 29%, 45%, 1)`;
//         let textColor = `hsl(${hue1}, 51%, 29%)`;

//         // Apply the new background and text color
//         entry.target.querySelector(".project_header").style.background = `linear-gradient(${hslColor1}, ${hslColor2})`;
//         entry.target.querySelector(".project_header").style.color = textColor;
//     } 
//   });
// };
// // Create a new Intersection Observer
// const observer = new IntersectionObserver(observerCallback, {root: null, threshold: 0.0 });
// // Select all 'section' elements and observe them
// const targets = document.querySelectorAll('section');
// targets.forEach(target => observer.observe(target));


    </script>

<script>(() => {
        window.addoncropExtensions = window.addoncropExtensions || [];
        window.addoncropExtensions.push({
            mode: 'emulator',
            emulator: 'Foxified',
            extension: {
                id: 44,
                name: 'YouTube Downloader by Addoncrop',
                version: '17.3.3',
                date: 'September 5, 2024',
            },
            flixmateConnected: false,
        });
    })();</script></body><div><template shadowrootmode="closed"><style>
.common li, .common span, .common a, .common input, .common img, .common h4,
.popup, .engine-editor{
    direction: ltr;
	margin: 0;
	padding: 0;
	border: 0;
	outline: 0;
	font-size: 10pt;
	font-weight: normal;
	text-decoration: none;
	font-family: sans-serif;
	vertical-align: baseline;
	background: transparent;
	color: #202020;
	text-align: left;
	line-height: normal;
	white-space: normal;
	-webkit-box-shadow: none;
	-webkit-border-radius:0;
	text-shadow: none;
	float: none;
	overflow: visible;
}
.common li, .common p, .common div, .common ul, .common h4{
	display: block;
}
.common h4{
	font-weight: bold;
}
.common ul{
	list-style-type: none;
}
.common span, .common img{
	display: inline;
}
.common input{
	display: inline-block;
	white-space: pre;
}
.common a:after, .common a[href^="http"]:after {
  content: '';
}
.engine-editor{

    z-index: 2147483647;
	padding: 0.5em;
	width: 35em;
	font-size: 9pt;
	background: #EDEDED;
	border: 3px solid #878787;
	-webkit-border-radius: 5px;
	-webkit-box-shadow: 0px 0px 8px #B0B0B0;
}
.engine-editor input[type='text']{
	width: 100%;
	margin-bottom: 0.5em;
	padding: 0.1em 0;
	display: block;
	border: 1px solid #A0A0A0;
	background: #fff;
	-webkit-border-radius: 2px;
}
.engine-editor input[type='button']{
	width: auto;
	display: inline-block;
	margin-top: 0.5em;
	margin-right: 0.5em;
	padding: 0.2em 0.4em;
	text-align: center;
	background: -webkit-gradient(linear, left top, left bottom, from(#F5F5F5), to(#E0E0E0));
	border: 1px solid #A0A0A0;
	-webkit-border-radius: 2px;
}
.engine-editor input[type='button']:hover{
	border: 1px solid #7C7C7C;
}
.engine-editor input[type='button']:active{
	background: -webkit-gradient(linear, left top, left bottom, from(#E0E0E0), to(#F5F5F5));
}
.engine-editor input[type='button']:disabled{
	color: #AAAAAA;
	background: -webkit-gradient(linear, left top, left bottom, from(#E7E7E7), to(#D3D3D3));
}
.engine-editor h4{
	margin: 0;
	height: 1.5em;
	font-size: 1.1em;
	padding-bottom: 0.3em;
	margin-bottom: 0.5em;
	border-bottom: 1px solid #CECECE;
}
.engine-editor input.close{
	float: right;
	margin: 0;
	height: 1.4em;
	width: 1.4em;
	padding-bottom: 0.3em;
	vertical-align: middle;
}
.engine-editor span.title{
	float: left;
	font-weight: bold;
	line-height: 1.5em;
}


.popup{
 width: 12em;
 position: absolute;
 background: #EDECEC;
 border: solid 1px #AEAAA7;
 padding: 0.3em 0.3em;
 font-size: 9pt;
 margin: 0;
 list-style-type: none;
 -webkit-box-shadow: 0px 1px 10px #ccc;
 display: block;
 font-family: sans-serif;
z-index: 2147483647;
}
.popup li{
 margin: 1px 0;
 padding: 0;
 text-align: left;
 color: #202020;
 display: block;
 font-family: sans-serif;
}
.popup input{
	width: 10.1em;
}
.popup img{
 width: 16px;
 height: 16px;
 vertical-align: middle;
 border:none;
 margin: 0;
 margin-right: 4px;
 display: inline;
}
.popup.mainmenu > li:first-child {
 overflow: hidden;
 text-overflow:ellipsis;
 white-space:nowrap;
 border-bottom: solid 1px #AEAAA7;
 margin-bottom: 0.5em;
 padding: 0.2em 0.3em;
}
.popup a{
 margin: 1px;
 text-decoration: none;
 color: #202020;
 display: block;
 padding: 0.2em 0.3em;
 -webkit-border-radius: 3px;
 font-family: sans-serif;
}
.popup a:hover, .popup a.active{
 background: #96B8E1;
}
.popup .engine-name{
 display: inline-block;
 width: 8.5em;
 overflow: hidden;
 text-overflow:ellipsis;
 white-space:nowrap;
 vertical-align: middle;
}
.button {
 position:absolute;
 background: #fafafa;
 background-repeat: no-repeat;
 background-position: center center;
 -webkit-border-radius: 3px;
 border: 1px solid #aaaaaa;
 width: 16px;
 height: 16px;
 font-family: sans-serif;
 z-index: 2147483647;
}
.popup .engine-separator{
 height: 1px;
 margin: 3px 0;
 background: #AEAAA7;
}
</style><style></style><style></style><div style="display: none; position: absolute;" class="engine-editor common"><h4 style="padding-left: 20px; background: url(&#39;chrome-extension://gipnlpdeieaidmmeaichnddnmjmcakoe/img/icon16.png&#39;) no-repeat left top;"><input style="background: url(&#39;chrome-extension://gipnlpdeieaidmmeaichnddnmjmcakoe/img/close.png&#39;) no-repeat center center;" class="close" type="button" value=""><span class="title">Add search engine</span></h4><div style="display: none;"><span>Name:</span><input type="text"><span>Url:</span><input type="text"><span>Icon url:</span><input type="text"></div><div style="background: url(&quot;chrome-extension://gipnlpdeieaidmmeaichnddnmjmcakoe/img/ajax-loader.gif&quot;) center center no-repeat; height: 50px; width: 100%;"></div><p style="display: none; color: #CB4345;"></p><input type="button" value="Save"><input type="button" value="Cancel"></div><ul class="popup common mainmenu" style="display: none;"><li><input type="text"></li><li><a class="engine-url"><img class="engine-img" referrerpolicy="no-referrer" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAqFBMVEVHcEz7+/v+/v709PX////7+/v09fX4+Pj////8/Pz7+/v////z+PP29vf09PX////+/v7///////////83qlfrQzPsTkFHiPUlpkszf/RAhfX6uwD8wBLW4vyQs/j96N3/+vPh8eR8wJiHrfjylpBhuXftX0rR6Nb608j0qKNwofBKsGWzy/rzn5n0o57uc2/94J78zFb3u7es1rC6z/rHuTCVsC08ooagt3gtAAAAE3RSTlMA08Eb4kVwOqb5kV7jkn8NfnFw9v5R3wAAAVtJREFUOI2dU9lywjAMTIAchgmljU3sJBRycRZoocf//1ltyZ4cpi/dl0jeHWllxY7TxVPgecGT8weCkMQAEgaP6EncwcSShPEAYZ+fDHlZ5BG/P9T1YW8rRnhyYRoXzEeGn0G6XrKlBmNrOJppAVZnmpNftt1gDeSfVbhhwNa3W83Y1hh9aR1eFX/G43N/kjEYyCR/sGcdG4vvWb692jzYnKrgI88znL96RVQrlU3NJWdSgM5FihBv5sKHggSR9gW5FKx1BSGUSHwawQI8ZHl2B8FK4ZgmAjwspMDDKb4obc2nsgIEnrnpzTeltDF8lSbpsb1r2OWdS8Vpp8KiVAWgA+4TesSNFFBOm+bE+U8iqraD47gqJidVQ4NjA1eve4ydS6PgvGw3AfAxL0oOKAvM/fafi4z/YrcrTBx1/9q5vcj54N2QPk3sx+V3JMS3aKgSuUTCjR49zf/jF+G2OgtU1MugAAAAAElFTkSuQmCC"><span class="engine-name">Google</span></a></li><li><a class="engine-url"><img class="engine-img" referrerpolicy="no-referrer" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAqFBMVEVHcEz7+/v+/v709PX////7+/v09fX4+Pj////8/Pz7+/v////z+PP29vf09PX////+/v7///////////83qlfrQzPsTkFHiPUlpkszf/RAhfX6uwD8wBLW4vyQs/j96N3/+vPh8eR8wJiHrfjylpBhuXftX0rR6Nb608j0qKNwofBKsGWzy/rzn5n0o57uc2/94J78zFb3u7es1rC6z/rHuTCVsC08ooagt3gtAAAAE3RSTlMA08Eb4kVwOqb5kV7jkn8NfnFw9v5R3wAAAVtJREFUOI2dU9lywjAMTIAchgmljU3sJBRycRZoocf//1ltyZ4cpi/dl0jeHWllxY7TxVPgecGT8weCkMQAEgaP6EncwcSShPEAYZ+fDHlZ5BG/P9T1YW8rRnhyYRoXzEeGn0G6XrKlBmNrOJppAVZnmpNftt1gDeSfVbhhwNa3W83Y1hh9aR1eFX/G43N/kjEYyCR/sGcdG4vvWb692jzYnKrgI88znL96RVQrlU3NJWdSgM5FihBv5sKHggSR9gW5FKx1BSGUSHwawQI8ZHl2B8FK4ZgmAjwspMDDKb4obc2nsgIEnrnpzTeltDF8lSbpsb1r2OWdS8Vpp8KiVAWgA+4TesSNFFBOm+bE+U8iqraD47gqJidVQ4NjA1eve4ydS6PgvGw3AfAxL0oOKAvM/fafi4z/YrcrTBx1/9q5vcj54N2QPk3sx+V3JMS3aKgSuUTCjR49zf/jF+G2OgtU1MugAAAAAElFTkSuQmCC"><span class="engine-name">Google Tech Recruiter</span></a></li><li><a class="engine-url"><img class="engine-img" referrerpolicy="no-referrer" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAqFBMVEVHcEz7+/v+/v709PX////7+/v09fX4+Pj////8/Pz7+/v////z+PP29vf09PX////+/v7///////////83qlfrQzPsTkFHiPUlpkszf/RAhfX6uwD8wBLW4vyQs/j96N3/+vPh8eR8wJiHrfjylpBhuXftX0rR6Nb608j0qKNwofBKsGWzy/rzn5n0o57uc2/94J78zFb3u7es1rC6z/rHuTCVsC08ooagt3gtAAAAE3RSTlMA08Eb4kVwOqb5kV7jkn8NfnFw9v5R3wAAAVtJREFUOI2dU9lywjAMTIAchgmljU3sJBRycRZoocf//1ltyZ4cpi/dl0jeHWllxY7TxVPgecGT8weCkMQAEgaP6EncwcSShPEAYZ+fDHlZ5BG/P9T1YW8rRnhyYRoXzEeGn0G6XrKlBmNrOJppAVZnmpNftt1gDeSfVbhhwNa3W83Y1hh9aR1eFX/G43N/kjEYyCR/sGcdG4vvWb692jzYnKrgI88znL96RVQrlU3NJWdSgM5FihBv5sKHggSR9gW5FKx1BSGUSHwawQI8ZHl2B8FK4ZgmAjwspMDDKb4obc2nsgIEnrnpzTeltDF8lSbpsb1r2OWdS8Vpp8KiVAWgA+4TesSNFFBOm+bE+U8iqraD47gqJidVQ4NjA1eve4ydS6PgvGw3AfAxL0oOKAvM/fafi4z/YrcrTBx1/9q5vcj54N2QPk3sx+V3JMS3aKgSuUTCjR49zf/jF+G2OgtU1MugAAAAAElFTkSuQmCC"><span class="engine-name">Google Recruiter</span></a></li><li><a class="engine-url"><img class="engine-img" referrerpolicy="no-referrer" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAqFBMVEVHcEz7+/v+/v709PX////7+/v09fX4+Pj////8/Pz7+/v////z+PP29vf09PX////+/v7///////////83qlfrQzPsTkFHiPUlpkszf/RAhfX6uwD8wBLW4vyQs/j96N3/+vPh8eR8wJiHrfjylpBhuXftX0rR6Nb608j0qKNwofBKsGWzy/rzn5n0o57uc2/94J78zFb3u7es1rC6z/rHuTCVsC08ooagt3gtAAAAE3RSTlMA08Eb4kVwOqb5kV7jkn8NfnFw9v5R3wAAAVtJREFUOI2dU9lywjAMTIAchgmljU3sJBRycRZoocf//1ltyZ4cpi/dl0jeHWllxY7TxVPgecGT8weCkMQAEgaP6EncwcSShPEAYZ+fDHlZ5BG/P9T1YW8rRnhyYRoXzEeGn0G6XrKlBmNrOJppAVZnmpNftt1gDeSfVbhhwNa3W83Y1hh9aR1eFX/G43N/kjEYyCR/sGcdG4vvWb692jzYnKrgI88znL96RVQrlU3NJWdSgM5FihBv5sKHggSR9gW5FKx1BSGUSHwawQI8ZHl2B8FK4ZgmAjwspMDDKb4obc2nsgIEnrnpzTeltDF8lSbpsb1r2OWdS8Vpp8KiVAWgA+4TesSNFFBOm+bE+U8iqraD47gqJidVQ4NjA1eve4ydS6PgvGw3AfAxL0oOKAvM/fafi4z/YrcrTBx1/9q5vcj54N2QPk3sx+V3JMS3aKgSuUTCjR49zf/jF+G2OgtU1MugAAAAAElFTkSuQmCC"><span class="engine-name">Google LinkedIn</span></a></li><li><a class="engine-url"><img class="engine-img" referrerpolicy="no-referrer" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAqFBMVEVHcEz7+/v+/v709PX////7+/v09fX4+Pj////8/Pz7+/v////z+PP29vf09PX////+/v7///////////83qlfrQzPsTkFHiPUlpkszf/RAhfX6uwD8wBLW4vyQs/j96N3/+vPh8eR8wJiHrfjylpBhuXftX0rR6Nb608j0qKNwofBKsGWzy/rzn5n0o57uc2/94J78zFb3u7es1rC6z/rHuTCVsC08ooagt3gtAAAAE3RSTlMA08Eb4kVwOqb5kV7jkn8NfnFw9v5R3wAAAVtJREFUOI2dU9lywjAMTIAchgmljU3sJBRycRZoocf//1ltyZ4cpi/dl0jeHWllxY7TxVPgecGT8weCkMQAEgaP6EncwcSShPEAYZ+fDHlZ5BG/P9T1YW8rRnhyYRoXzEeGn0G6XrKlBmNrOJppAVZnmpNftt1gDeSfVbhhwNa3W83Y1hh9aR1eFX/G43N/kjEYyCR/sGcdG4vvWb692jzYnKrgI88znL96RVQrlU3NJWdSgM5FihBv5sKHggSR9gW5FKx1BSGUSHwawQI8ZHl2B8FK4ZgmAjwspMDDKb4obc2nsgIEnrnpzTeltDF8lSbpsb1r2OWdS8Vpp8KiVAWgA+4TesSNFFBOm+bE+U8iqraD47gqJidVQ4NjA1eve4ydS6PgvGw3AfAxL0oOKAvM/fafi4z/YrcrTBx1/9q5vcj54N2QPk3sx+V3JMS3aKgSuUTCjR49zf/jF+G2OgtU1MugAAAAAElFTkSuQmCC"><span class="engine-name">Google Jobs</span></a></li><li><a class="engine-url"><img class="engine-img" referrerpolicy="no-referrer" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAjVBMVEVHcEz////9/f38/Pz////4+fn9/f38/P3v8PH19vb///////87q1n8wAnrSz5HifXqOijsUUMfpUYvfvQwqVhDhvRnm/bg7ur74eDykIrznpj609DI5c/uZUj/78rG2PyzzPKJyJj5zMn/++37xSf81XhqsFCa0KV1v4f0kCGvtTCCyJyXt/hyofZDj9Yia4J9AAAAC3RSTlMAojhxnKGw/RkrfoV/rhcAAAFQSURBVDiNlVPZYoMgENQYRCIgclRNNKlpm/T+/88rl3jmofPEMuPu7LpE0X+wO8RpGh9222wW5wFxtuYntJUsaATzBSCaFV/SBhMryF9dm46xrjn5cMzh8p9KRsuypJSVTgLn/o6stKAa7Gqv9r6/kadMQ/NHX8R1u7f5Dc+aGsK6CbxPYY+dLk9rd12PnYQWz6SjbEJMW03M4Y2Qj2ZjFslg4ZUQcrZXTwMug4nUHDRPXqxAFBpKKfFsovSBwGiCYFFCGKiiEKHEYPLza/T2owpRDSaRa/MmeTXwla4j7AmFQd0kxtIrYKEK9R0G5Uy0HGPM+wrC6i41L+A4avez7kYhuYbO9ess+p8VARv0RuEgue0xB/OFaaX5GEvJsTMTFsYX0ZJ3XQP3rQ8nu7+5tLO1ztZrv3w7YM6DaIUMhCwQbDw9+z4SkKYgQdvsA/wBrYgleUhdXncAAAAASUVORK5CYII="><span class="engine-name">Google Maps</span></a></li></ul><div class="button common" style="display: none; background-image: url(&quot;chrome-extension://gipnlpdeieaidmmeaichnddnmjmcakoe/img/icon16.png&quot;);"></div></template></div><style>
@media print {
  #simplify-jobs-container {
    display: none;
  }
}
</style><div id="simplify-jobs-container" style="position: absolute; top: 0px; left: 0px; width: 0px; height: 0px; overflow: visible; z-index: 2147483647;"></div><script id="simplify-jobs-page-script" src="chrome-extension://pbanhockgagggenencehbnadejlgchfc/js/pageScript.bundle.js"></script></html>